from fastapi import FastAPI, APIRouter, HTTPException, Depends, status
from fastapi.responses import StreamingResponse
from fastapi.security import HTTPBearer, HTTPAuthorizationCredentials
from dotenv import load_dotenv
from starlette.middleware.cors import CORSMiddleware
from motor.motor_asyncio import AsyncIOMotorClient
import os
import logging
from pathlib import Path
from pydantic import BaseModel, Field, ConfigDict, EmailStr
from typing import List, Optional, Dict, Any
import uuid
from datetime import datetime, timezone, timedelta
from enum import Enum
import io
from weasyprint import HTML, CSS
from jinja2 import Environment, BaseLoader
import markdown2
from passlib.context import CryptContext
from jose import JWTError, jwt


ROOT_DIR = Path(__file__).parent
load_dotenv(ROOT_DIR / '.env')

# MongoDB connection
mongo_url = os.environ['MONGO_URL']
client = AsyncIOMotorClient(mongo_url)
db = client[os.environ['DB_NAME']]

# Create the main app without a prefix
app = FastAPI(title="PentestPro API", version="1.0.0")

# Create a router with the /api prefix
api_router = APIRouter(prefix="/api")

# Authentication configuration
SECRET_KEY = os.environ.get("SECRET_KEY", "your-secret-key-change-in-production")
ALGORITHM = "HS256"
ACCESS_TOKEN_EXPIRE_MINUTES = 30 * 24  # 30 days

# Password hashing
pwd_context = CryptContext(schemes=["bcrypt"], deprecated="auto")

# Security scheme
security = HTTPBearer()


# Enums
class AssessmentStatus(str, Enum):
    DRAFT = "draft"
    IN_PROGRESS = "in_progress"
    COMPLETED = "completed"
    ARCHIVED = "archived"

class FieldType(str, Enum):
    TEXT = "text"
    TEXTAREA = "textarea"
    CHECKBOX = "checkbox"
    FILE = "file"
    SELECT = "select"
    NUMBER = "number"
    URL = "url"

class UserRole(str, Enum):
    ADMIN = "admin"
    SECURITY_ANALYST = "security_analyst"
    VIEWER = "viewer"
    AUDITOR = "auditor"
    CUSTOM = "custom"

class ThemeType(str, Enum):
    LIGHT = "light"
    DARK = "dark"
    HIGH_CONTRAST = "high_contrast"


# Models
class TemplateField(BaseModel):
    id: str = Field(default_factory=lambda: str(uuid.uuid4()))
    label: str
    type: FieldType
    required: bool = False
    placeholder: Optional[str] = None
    options: Optional[List[str]] = None  # For select fields


class TemplateStep(BaseModel):
    id: str = Field(default_factory=lambda: str(uuid.uuid4()))
    name: str
    description: Optional[str] = None
    instructions: str
    fields: List[TemplateField] = []
    order: int = 0


class ReportSection(BaseModel):
    id: str = Field(default_factory=lambda: str(uuid.uuid4()))
    title: str
    content_template: str
    order: int = 0


# User Management Models
class UserSettings(BaseModel):
    theme: ThemeType = ThemeType.LIGHT
    notifications_enabled: bool = True
    email_notifications: bool = True
    dashboard_layout: str = "default"
    report_auto_generate: bool = False
    reports_per_page: int = 10

class UserPermissions(BaseModel):
    can_create_assessments: bool = True
    can_edit_assessments: bool = True
    can_delete_assessments: bool = False
    can_view_all_assessments: bool = False
    can_create_templates: bool = False
    can_edit_templates: bool = False
    can_delete_templates: bool = False
    can_manage_users: bool = False
    can_view_reports: bool = True
    can_generate_reports: bool = True
    can_delete_reports: bool = False

class User(BaseModel):
    model_config = ConfigDict(extra="ignore")
    
    id: str = Field(default_factory=lambda: str(uuid.uuid4()))
    email: EmailStr
    username: str
    full_name: str = ""
    avatar_url: Optional[str] = None
    role: UserRole = UserRole.SECURITY_ANALYST
    custom_permissions: Optional[UserPermissions] = None
    settings: UserSettings = Field(default_factory=UserSettings)
    organization: Optional[str] = None
    team: Optional[str] = None
    is_active: bool = True
    is_verified: bool = False
    created_at: datetime = Field(default_factory=lambda: datetime.now(timezone.utc))
    last_login: Optional[datetime] = None
    
class UserCreate(BaseModel):
    email: EmailStr
    username: str
    password: str
    full_name: str = ""
    role: UserRole = UserRole.SECURITY_ANALYST
    organization: Optional[str] = None
    team: Optional[str] = None

class UserLogin(BaseModel):
    email: EmailStr
    password: str

class UserUpdate(BaseModel):
    username: Optional[str] = None
    full_name: Optional[str] = None
    avatar_url: Optional[str] = None
    organization: Optional[str] = None
    team: Optional[str] = None

class UserSettingsUpdate(BaseModel):
    theme: Optional[ThemeType] = None
    notifications_enabled: Optional[bool] = None
    email_notifications: Optional[bool] = None
    dashboard_layout: Optional[str] = None
    report_auto_generate: Optional[bool] = None
    reports_per_page: Optional[int] = None

class Token(BaseModel):
    access_token: str
    token_type: str
    expires_in: int
    user: User

class TokenData(BaseModel):
    user_id: Optional[str] = None


class Template(BaseModel):
    model_config = ConfigDict(extra="ignore")
    
    id: str = Field(default_factory=lambda: str(uuid.uuid4()))
    name: str
    description: str
    category: str = "General"
    steps: List[TemplateStep] = []
    report_structure: List[ReportSection] = []
    created_at: datetime = Field(default_factory=lambda: datetime.now(timezone.utc))
    updated_at: datetime = Field(default_factory=lambda: datetime.now(timezone.utc))


class TemplateCreate(BaseModel):
    name: str
    description: str
    category: str = "General"
    steps: List[TemplateStep] = []
    report_structure: List[ReportSection] = []


class TemplateUpdate(BaseModel):
    name: Optional[str] = None
    description: Optional[str] = None
    category: Optional[str] = None
    steps: Optional[List[TemplateStep]] = None
    report_structure: Optional[List[ReportSection]] = None


class Assessment(BaseModel):
    model_config = ConfigDict(extra="ignore")
    
    id: str = Field(default_factory=lambda: str(uuid.uuid4()))
    template_id: str
    template_name: str  # Cached for display
    name: str
    status: AssessmentStatus = AssessmentStatus.DRAFT
    data: Dict[str, Any] = {}  # Step data
    current_step: int = 0
    created_at: datetime = Field(default_factory=lambda: datetime.now(timezone.utc))
    updated_at: datetime = Field(default_factory=lambda: datetime.now(timezone.utc))
    completed_at: Optional[datetime] = None


class AssessmentCreate(BaseModel):
    template_id: str
    name: str


class AssessmentUpdate(BaseModel):
    name: Optional[str] = None
    status: Optional[AssessmentStatus] = None
    data: Optional[Dict[str, Any]] = None
    current_step: Optional[int] = None


class Report(BaseModel):
    model_config = ConfigDict(extra="ignore")
    
    id: str = Field(default_factory=lambda: str(uuid.uuid4()))
    assessment_id: str
    assessment_name: str
    content: str  # Markdown content
    generated_at: datetime = Field(default_factory=lambda: datetime.now(timezone.utc))


# Helper functions
def prepare_for_mongo(data):
    """Helper function to prepare data for MongoDB insertion"""
    if isinstance(data, dict):
        for key, value in data.items():
            if isinstance(value, datetime):
                data[key] = value.isoformat()
            elif isinstance(value, dict):
                data[key] = prepare_for_mongo(value)
            elif isinstance(value, list):
                data[key] = [prepare_for_mongo(item) if isinstance(item, dict) else item for item in value]
    return data


# Authentication utility functions
def verify_password(plain_password, hashed_password):
    """Verify a plain password against its hash"""
    return pwd_context.verify(plain_password, hashed_password)

def get_password_hash(password):
    """Hash a password"""
    return pwd_context.hash(password)

def create_access_token(data: dict, expires_delta: Optional[timedelta] = None):
    """Create JWT access token"""
    to_encode = data.copy()
    if expires_delta:
        expire = datetime.now(timezone.utc) + expires_delta
    else:
        expire = datetime.now(timezone.utc) + timedelta(minutes=15)
    to_encode.update({"exp": expire})
    encoded_jwt = jwt.encode(to_encode, SECRET_KEY, algorithm=ALGORITHM)
    return encoded_jwt

async def get_user_by_email(email: str):
    """Get user by email from database"""
    user_data = await db.users.find_one({"email": email})
    if user_data:
        return User(**user_data)
    return None

async def get_user_by_id(user_id: str):
    """Get user by ID from database"""
    user_data = await db.users.find_one({"id": user_id})
    if user_data:
        return User(**user_data)
    return None

async def authenticate_user(email: str, password: str):
    """Authenticate user with email and password"""
    user_data = await db.users.find_one({"email": email})
    if not user_data:
        return False
    if not verify_password(password, user_data["password_hash"]):
        return False
    return User(**user_data)

async def get_current_user(credentials: HTTPAuthorizationCredentials = Depends(security)):
    """Get current authenticated user from JWT token"""
    credentials_exception = HTTPException(
        status_code=status.HTTP_401_UNAUTHORIZED,
        detail="Could not validate credentials",
        headers={"WWW-Authenticate": "Bearer"},
    )
    try:
        payload = jwt.decode(credentials.credentials, SECRET_KEY, algorithms=[ALGORITHM])
        user_id: str = payload.get("sub")
        if user_id is None:
            raise credentials_exception
        token_data = TokenData(user_id=user_id)
    except JWTError:
        raise credentials_exception
    user = await get_user_by_id(token_data.user_id)
    if user is None:
        raise credentials_exception
    return user

def get_user_permissions(user: User) -> UserPermissions:
    """Get user permissions based on role and custom permissions"""
    if user.custom_permissions:
        return user.custom_permissions
    
    # Default permissions by role
    if user.role == UserRole.ADMIN:
        return UserPermissions(
            can_create_assessments=True,
            can_edit_assessments=True,
            can_delete_assessments=True,
            can_view_all_assessments=True,
            can_create_templates=True,
            can_edit_templates=True,
            can_delete_templates=True,
            can_manage_users=True,
            can_view_reports=True,
            can_generate_reports=True,
            can_delete_reports=True,
        )
    elif user.role == UserRole.SECURITY_ANALYST:
        return UserPermissions(
            can_create_assessments=True,
            can_edit_assessments=True,
            can_delete_assessments=False,
            can_view_all_assessments=False,
            can_create_templates=False,
            can_edit_templates=False,
            can_delete_templates=False,
            can_manage_users=False,
            can_view_reports=True,
            can_generate_reports=True,
            can_delete_reports=False,
        )
    elif user.role == UserRole.AUDITOR:
        return UserPermissions(
            can_create_assessments=True,
            can_edit_assessments=True,
            can_delete_assessments=False,
            can_view_all_assessments=True,
            can_create_templates=False,
            can_edit_templates=False,
            can_delete_templates=False,
            can_manage_users=False,
            can_view_reports=True,
            can_generate_reports=True,
            can_delete_reports=False,
        )
    elif user.role == UserRole.VIEWER:
        return UserPermissions(
            can_create_assessments=False,
            can_edit_assessments=False,
            can_delete_assessments=False,
            can_view_all_assessments=False,
            can_create_templates=False,
            can_edit_templates=False,
            can_delete_templates=False,
            can_manage_users=False,
            can_view_reports=True,
            can_generate_reports=False,
            can_delete_reports=False,
        )
    else:  # CUSTOM
        return UserPermissions()


# PDF Generation Functions
def generate_html_report(report_data: dict, template_data: dict = None) -> str:
    """Generate HTML report from report data and template"""
    
    # HTML template for the report
    html_template = """
    <!DOCTYPE html>
    <html>
    <head>
        <meta charset="UTF-8">
        <title>{{ report_name }} - Assessment Report</title>
        <style>
            body {
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                line-height: 1.6;
                color: #333;
                max-width: 800px;
                margin: 0 auto;
                padding: 20px;
                background-color: #fff;
            }
            .header {
                text-align: center;
                border-bottom: 3px solid #2563eb;
                padding-bottom: 20px;
                margin-bottom: 30px;
            }
            .header h1 {
                color: #1e40af;
                font-size: 2.5em;
                margin-bottom: 10px;
            }
            .header .subtitle {
                color: #6b7280;
                font-size: 1.2em;
            }
            .metadata {
                background-color: #f8fafc;
                padding: 20px;
                border-radius: 8px;
                margin-bottom: 30px;
                border-left: 4px solid #2563eb;
            }
            .metadata h2 {
                color: #1e40af;
                margin-top: 0;
            }
            .metadata-grid {
                display: grid;
                grid-template-columns: repeat(2, 1fr);
                gap: 15px;
            }
            .metadata-item {
                display: flex;
                flex-direction: column;
            }
            .metadata-label {
                font-weight: bold;
                color: #374151;
                margin-bottom: 2px;
            }
            .metadata-value {
                color: #6b7280;
            }
            .section {
                margin-bottom: 40px;
                page-break-inside: avoid;
            }
            .section h2 {
                color: #1e40af;
                border-bottom: 2px solid #e5e7eb;
                padding-bottom: 8px;
                margin-bottom: 20px;
            }
            .section h3 {
                color: #374151;
                margin-top: 25px;
                margin-bottom: 15px;
            }
            .findings {
                background-color: #fef2f2;
                border-left: 4px solid #ef4444;
                padding: 20px;
                margin: 20px 0;
                border-radius: 4px;
            }
            .findings.high {
                background-color: #fef2f2;
                border-left-color: #dc2626;
            }
            .findings.medium {
                background-color: #fefbf2;
                border-left-color: #f59e0b;
            }
            .findings.low {
                background-color: #f0fdf4;
                border-left-color: #22c55e;
            }
            .finding-title {
                font-weight: bold;
                color: #1f2937;
                margin-bottom: 8px;
            }
            .finding-description {
                color: #4b5563;
                margin-bottom: 10px;
            }
            .recommendation {
                background-color: #eff6ff;
                border-left: 4px solid #3b82f6;
                padding: 15px;
                margin: 15px 0;
                border-radius: 4px;
            }
            .recommendation-title {
                font-weight: bold;
                color: #1e40af;
                margin-bottom: 8px;
            }
            .table {
                width: 100%;
                border-collapse: collapse;
                margin: 20px 0;
                background-color: white;
                box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            }
            .table th, .table td {
                border: 1px solid #e5e7eb;
                padding: 12px;
                text-align: left;
            }
            .table th {
                background-color: #f9fafb;
                font-weight: bold;
                color: #374151;
            }
            .table tr:nth-child(even) {
                background-color: #f9fafb;
            }
            .footer {
                margin-top: 50px;
                padding-top: 20px;
                border-top: 2px solid #e5e7eb;
                text-align: center;
                color: #6b7280;
                font-size: 0.9em;
            }
            .page-break {
                page-break-before: always;
            }
            @media print {
                body {
                    max-width: none;
                    margin: 0;
                    padding: 15px;
                }
                .page-break {
                    page-break-before: always;
                }
            }
        </style>
    </head>
    <body>
        <div class="header">
            <h1>{{ report_name }}</h1>
            <div class="subtitle">Security Assessment Report</div>
        </div>

        <div class="metadata">
            <h2>Assessment Details</h2>
            <div class="metadata-grid">
                <div class="metadata-item">
                    <span class="metadata-label">Assessment Name:</span>
                    <span class="metadata-value">{{ assessment_name }}</span>
                </div>
                <div class="metadata-item">
                    <span class="metadata-label">Template:</span>
                    <span class="metadata-value">{{ template_name }}</span>
                </div>
                <div class="metadata-item">
                    <span class="metadata-label">Status:</span>
                    <span class="metadata-value">{{ status }}</span>
                </div>
                <div class="metadata-item">
                    <span class="metadata-label">Generated:</span>
                    <span class="metadata-value">{{ generated_date }}</span>
                </div>
            </div>
        </div>

        {% if template_data and template_data.report_structure %}
            {% for section in template_data.report_structure %}
                <div class="section">
                    <h2>{{ section.title }}</h2>
                    <div>{{ section.content_template }}</div>
                    
                    <!-- Include assessment data for this section if available -->
                    {% if assessment_data %}
                        <h3>Assessment Findings</h3>
                        {% for step_key, step_data in assessment_data.items() %}
                            {% if step_data %}
                                <div class="findings medium">
                                    <div class="finding-title">{{ step_key|replace('_', ' ')|title }} Findings</div>
                                    <div class="finding-description">
                                        {% for field_key, field_value in step_data.items() %}
                                            <strong>{{ field_key|replace('_', ' ')|title }}:</strong> {{ field_value }}<br>
                                        {% endfor %}
                                    </div>
                                </div>
                            {% endif %}
                        {% endfor %}
                    {% endif %}
                </div>
            {% endfor %}
        {% else %}
            <div class="section">
                <h2>Assessment Summary</h2>
                <p>This assessment was conducted using the {{ template_name }} template.</p>
                
                {% if assessment_data %}
                    <h3>Collected Data</h3>
                    {% for step_key, step_data in assessment_data.items() %}
                        {% if step_data %}
                            <div class="findings low">
                                <div class="finding-title">{{ step_key|replace('_', ' ')|title }}</div>
                                <div class="finding-description">
                                    {% for field_key, field_value in step_data.items() %}
                                        <strong>{{ field_key|replace('_', ' ')|title }}:</strong> {{ field_value }}<br>
                                    {% endfor %}
                                </div>
                            </div>
                        {% endif %}
                    {% endfor %}
                {% endif %}
            </div>
        {% endif %}

        <div class="section page-break">
            <h2>Recommendations</h2>
            <div class="recommendation">
                <div class="recommendation-title">Next Steps</div>
                <p>Based on this assessment, consider the following recommendations:</p>
                <ul>
                    <li>Review and address any high-priority findings</li>
                    <li>Implement security controls as identified in the assessment</li>
                    <li>Schedule regular reassessments to maintain security posture</li>
                    <li>Document remediation efforts and track progress</li>
                </ul>
            </div>
        </div>

        <div class="footer">
            <p>Generated by PentestPro Assessment Platform | {{ generated_date }}</p>
        </div>
    </body>
    </html>
    """
    
    # Create Jinja2 environment and render template
    env = Environment(loader=BaseLoader())
    template = env.from_string(html_template)
    
    # Prepare template data
    context = {
        'report_name': report_data.get('name', 'Security Assessment Report'),
        'assessment_name': report_data.get('name', 'Unnamed Assessment'),
        'template_name': report_data.get('template_name', 'Unknown Template'),
        'status': report_data.get('status', 'Unknown'),
        'generated_date': datetime.now(timezone.utc).strftime('%Y-%m-%d %H:%M:%S UTC'),
        'assessment_data': report_data.get('data', {}),
        'template_data': template_data
    }
    
    return template.render(**context)


def generate_pdf_from_html(html_content: str) -> bytes:
    """Generate PDF from HTML content using WeasyPrint"""
    try:
        # Create HTML object from string
        html_doc = HTML(string=html_content)
        
        # Generate PDF to bytes
        pdf_bytes = html_doc.write_pdf()
        
        return pdf_bytes
    except Exception as e:
        raise HTTPException(status_code=500, detail=f"PDF generation failed: {str(e)}")


async def generate_report_pdf(report_id: str) -> bytes:
    """Generate PDF for a specific report"""
    # Get report data
    report_data = await db.reports.find_one({"id": report_id})
    if not report_data:
        raise HTTPException(status_code=404, detail="Report not found")
    
    # Get template data for better report structure
    template_data = None
    if report_data.get('template_id'):
        template_data = await db.templates.find_one({"id": report_data['template_id']})
    
    # Generate HTML
    html_content = generate_html_report(report_data, template_data)
    
    # Generate PDF
    pdf_bytes = generate_pdf_from_html(html_content)
    
    return pdf_bytes


def parse_from_mongo(item):
    """Convert ISO strings back to datetime objects"""
    if isinstance(item, dict):
        for key, value in item.items():
            if key in ['created_at', 'updated_at', 'completed_at', 'generated_at'] and isinstance(value, str):
                try:
                    item[key] = datetime.fromisoformat(value)
                except ValueError:
                    pass
            elif isinstance(value, dict):
                item[key] = parse_from_mongo(value)
            elif isinstance(value, list):
                item[key] = [parse_from_mongo(sub_item) if isinstance(sub_item, dict) else sub_item for sub_item in value]
    return item


# Template endpoints
@api_router.get("/templates", response_model=List[Template])
async def get_templates():
    """Get all templates"""
    templates = await db.templates.find({}, {"_id": 0}).to_list(1000)
    return [Template(**parse_from_mongo(template)) for template in templates]


@api_router.get("/templates/{template_id}", response_model=Template)
async def get_template(template_id: str):
    """Get a specific template"""
    template = await db.templates.find_one({"id": template_id}, {"_id": 0})
    if not template:
        raise HTTPException(status_code=404, detail="Template not found")
    return Template(**parse_from_mongo(template))


@api_router.post("/templates", response_model=Template)
async def create_template(template_data: TemplateCreate):
    """Create a new template"""
    template = Template(**template_data.model_dump())
    
    doc = prepare_for_mongo(template.model_dump())
    await db.templates.insert_one(doc)
    
    return template


@api_router.put("/templates/{template_id}", response_model=Template)
async def update_template(template_id: str, template_data: TemplateUpdate):
    """Update a template"""
    existing_template = await db.templates.find_one({"id": template_id}, {"_id": 0})
    if not existing_template:
        raise HTTPException(status_code=404, detail="Template not found")
    
    # Update fields
    update_data = template_data.model_dump(exclude_unset=True)
    update_data["updated_at"] = datetime.now(timezone.utc)
    
    prepared_data = prepare_for_mongo(update_data)
    await db.templates.update_one({"id": template_id}, {"$set": prepared_data})
    
    # Return updated template
    updated_template = await db.templates.find_one({"id": template_id}, {"_id": 0})
    return Template(**parse_from_mongo(updated_template))


@api_router.delete("/templates/{template_id}")
async def delete_template(template_id: str):
    """Delete a template"""
    result = await db.templates.delete_one({"id": template_id})
    if result.deleted_count == 0:
        raise HTTPException(status_code=404, detail="Template not found")
    return {"message": "Template deleted successfully"}


# Assessment endpoints
@api_router.get("/assessments", response_model=List[Assessment])
async def get_assessments():
    """Get all assessments"""
    assessments = await db.assessments.find({}, {"_id": 0}).to_list(1000)
    return [Assessment(**parse_from_mongo(assessment)) for assessment in assessments]


@api_router.get("/assessments/{assessment_id}", response_model=Assessment)
async def get_assessment(assessment_id: str):
    """Get a specific assessment"""
    assessment = await db.assessments.find_one({"id": assessment_id}, {"_id": 0})
    if not assessment:
        raise HTTPException(status_code=404, detail="Assessment not found")
    return Assessment(**parse_from_mongo(assessment))


@api_router.post("/assessments", response_model=Assessment)
async def create_assessment(assessment_data: AssessmentCreate):
    """Create a new assessment"""
    # Get template to cache name
    template = await db.templates.find_one({"id": assessment_data.template_id}, {"_id": 0})
    if not template:
        raise HTTPException(status_code=404, detail="Template not found")
    
    assessment = Assessment(
        **assessment_data.model_dump(),
        template_name=template["name"]
    )
    
    doc = prepare_for_mongo(assessment.model_dump())
    await db.assessments.insert_one(doc)
    
    return assessment


@api_router.put("/assessments/{assessment_id}", response_model=Assessment)
async def update_assessment(assessment_id: str, assessment_data: AssessmentUpdate):
    """Update an assessment"""
    existing_assessment = await db.assessments.find_one({"id": assessment_id}, {"_id": 0})
    if not existing_assessment:
        raise HTTPException(status_code=404, detail="Assessment not found")
    
    # Update fields
    update_data = assessment_data.model_dump(exclude_unset=True)
    update_data["updated_at"] = datetime.now(timezone.utc)
    
    # Set completion date if status is completed
    if update_data.get("status") == AssessmentStatus.COMPLETED:
        update_data["completed_at"] = datetime.now(timezone.utc)
    
    prepared_data = prepare_for_mongo(update_data)
    await db.assessments.update_one({"id": assessment_id}, {"$set": prepared_data})
    
    # Return updated assessment
    updated_assessment = await db.assessments.find_one({"id": assessment_id}, {"_id": 0})
    return Assessment(**parse_from_mongo(updated_assessment))


@api_router.delete("/assessments/{assessment_id}")
async def delete_assessment(assessment_id: str):
    """Delete an assessment"""
    result = await db.assessments.delete_one({"id": assessment_id})
    if result.deleted_count == 0:
        raise HTTPException(status_code=404, detail="Assessment not found")
    return {"message": "Assessment deleted successfully"}


# Report endpoints
@api_router.post("/assessments/{assessment_id}/report", response_model=Report)
async def generate_report(assessment_id: str):
    """Generate a report for an assessment"""
    # Get assessment
    assessment = await db.assessments.find_one({"id": assessment_id}, {"_id": 0})
    if not assessment:
        raise HTTPException(status_code=404, detail="Assessment not found")
    
    # Get template
    template = await db.templates.find_one({"id": assessment["template_id"]}, {"_id": 0})
    if not template:
        raise HTTPException(status_code=404, detail="Template not found")
    
    # Generate markdown content
    content = f"# {assessment['name']} Assessment Report\n\n"
    content += f"**Template**: {template['name']}\n"
    content += f"**Status**: {assessment['status']}\n"
    content += f"**Created**: {assessment['created_at']}\n"
    
    if assessment.get('completed_at'):
        content += f"**Completed**: {assessment['completed_at']}\n"
    
    content += "\n---\n\n"
    
    # Add sections from template
    for section in template.get('report_structure', []):
        content += f"## {section['title']}\n\n"
        content += f"{section['content_template']}\n\n"
    
    # Add assessment data
    if assessment.get('data'):
        content += "## Assessment Data\n\n"
        for step_id, step_data in assessment['data'].items():
            content += "### Step Data\n\n"
            for field, value in step_data.items():
                content += f"**{field}**: {value}\n\n"
    
    # Create report
    report = Report(
        assessment_id=assessment_id,
        assessment_name=assessment['name'],
        content=content
    )
    
    doc = prepare_for_mongo(report.model_dump())
    await db.reports.insert_one(doc)
    
    return report


@api_router.get("/assessments/{assessment_id}/reports", response_model=List[Report])
async def get_assessment_reports(assessment_id: str):
    """Get all reports for an assessment"""
    reports = await db.reports.find({"assessment_id": assessment_id}, {"_id": 0}).to_list(1000)
    return [Report(**parse_from_mongo(report)) for report in reports]


@api_router.get("/reports/{report_id}/pdf")
async def download_report_pdf(report_id: str):
    """Download report as PDF"""
    try:
        pdf_bytes = await generate_report_pdf(report_id)
        
        # Get report name for filename
        report_data = await db.reports.find_one({"id": report_id}, {"_id": 0})
        filename = f"{report_data.get('assessment_name', 'report').replace(' ', '_')}_report.pdf"
        
        return StreamingResponse(
            io.BytesIO(pdf_bytes),
            media_type="application/pdf",
            headers={"Content-Disposition": f"attachment; filename={filename}"}
        )
    except Exception as e:
        raise HTTPException(status_code=500, detail=f"PDF generation failed: {str(e)}")


# Dashboard endpoint
@api_router.get("/dashboard")
async def get_dashboard():
    """Get dashboard data"""
    # Get counts
    templates_count = await db.templates.count_documents({})
    assessments_count = await db.assessments.count_documents({})
    completed_count = await db.assessments.count_documents({"status": "completed"})
    
    # Get recent assessments
    recent_assessments = await db.assessments.find(
        {}, {"_id": 0}
    ).sort("updated_at", -1).limit(5).to_list(5)
    
    return {
        "stats": {
            "templates": templates_count,
            "assessments": assessments_count,
            "completed": completed_count,
            "in_progress": assessments_count - completed_count
        },
        "recent_assessments": [Assessment(**parse_from_mongo(a)) for a in recent_assessments]
    }


# Clear all data endpoint
@api_router.post("/clear-data")
async def clear_all_data():
    """Clear all data from the database"""
    await db.templates.delete_many({})
    await db.assessments.delete_many({})
    await db.reports.delete_many({})
    return {"message": "All data cleared successfully"}

# Authentication endpoints
@api_router.post("/auth/register", response_model=Token)
async def register_user(user_data: UserCreate):
    """Register a new user"""
    # Check if user already exists
    existing_user = await get_user_by_email(user_data.email)
    if existing_user:
        raise HTTPException(
            status_code=status.HTTP_400_BAD_REQUEST,
            detail="Email already registered"
        )
    
    # Check if username already exists
    existing_username = await db.users.find_one({"username": user_data.username})
    if existing_username:
        raise HTTPException(
            status_code=status.HTTP_400_BAD_REQUEST,
            detail="Username already taken"
        )
    
    # Create new user
    password_hash = get_password_hash(user_data.password)
    user = User(
        email=user_data.email,
        username=user_data.username,
        full_name=user_data.full_name,
        role=user_data.role,
        organization=user_data.organization,
        team=user_data.team,
        is_verified=True  # Auto-verify for now
    )
    
    # Prepare user data for MongoDB
    user_dict = prepare_for_mongo(user.model_dump())
    user_dict["password_hash"] = password_hash
    
    # Save to database
    await db.users.insert_one(user_dict)
    
    # Create access token
    access_token_expires = timedelta(minutes=ACCESS_TOKEN_EXPIRE_MINUTES)
    access_token = create_access_token(
        data={"sub": user.id}, expires_delta=access_token_expires
    )
    
    return Token(
        access_token=access_token,
        token_type="bearer",
        expires_in=ACCESS_TOKEN_EXPIRE_MINUTES * 60,
        user=user
    )

@api_router.post("/auth/login", response_model=Token)
async def login_user(login_data: UserLogin):
    """Authenticate user and return access token"""
    user = await authenticate_user(login_data.email, login_data.password)
    if not user:
        raise HTTPException(
            status_code=status.HTTP_401_UNAUTHORIZED,
            detail="Incorrect email or password",
            headers={"WWW-Authenticate": "Bearer"},
        )
    
    if not user.is_active:
        raise HTTPException(
            status_code=status.HTTP_401_UNAUTHORIZED,
            detail="Account is deactivated"
        )
    
    # Update last login
    await db.users.update_one(
        {"id": user.id},
        {"$set": {"last_login": datetime.now(timezone.utc).isoformat()}}
    )
    
    # Create access token
    access_token_expires = timedelta(minutes=ACCESS_TOKEN_EXPIRE_MINUTES)
    access_token = create_access_token(
        data={"sub": user.id}, expires_delta=access_token_expires
    )
    
    return Token(
        access_token=access_token,
        token_type="bearer",
        expires_in=ACCESS_TOKEN_EXPIRE_MINUTES * 60,
        user=user
    )

@api_router.get("/auth/me", response_model=User)
async def get_current_user_info(current_user: User = Depends(get_current_user)):
    """Get current user information"""
    return current_user

@api_router.put("/auth/me", response_model=User)
async def update_current_user(
    user_update: UserUpdate,
    current_user: User = Depends(get_current_user)
):
    """Update current user information"""
    update_data = {k: v for k, v in user_update.model_dump().items() if v is not None}
    
    if update_data:
        update_data["updated_at"] = datetime.now(timezone.utc).isoformat()
        await db.users.update_one(
            {"id": current_user.id},
            {"$set": update_data}
        )
    
    # Return updated user
    updated_user_data = await db.users.find_one({"id": current_user.id})
    return User(**updated_user_data)

@api_router.get("/auth/permissions", response_model=UserPermissions)
async def get_user_permissions_endpoint(current_user: User = Depends(get_current_user)):
    """Get current user permissions"""
    return get_user_permissions(current_user)

# User settings endpoints
@api_router.get("/user/settings", response_model=UserSettings)
async def get_user_settings(current_user: User = Depends(get_current_user)):
    """Get current user settings"""
    return current_user.settings

@api_router.put("/user/settings", response_model=UserSettings)
async def update_user_settings(
    settings_update: UserSettingsUpdate,
    current_user: User = Depends(get_current_user)
):
    """Update current user settings"""
    # Get current settings
    current_settings = current_user.settings.model_dump()
    
    # Update with new values
    update_data = {k: v for k, v in settings_update.model_dump().items() if v is not None}
    current_settings.update(update_data)
    
    # Update in database
    await db.users.update_one(
        {"id": current_user.id},
        {"$set": {"settings": current_settings}}
    )
    
    return UserSettings(**current_settings)

# Initialize demo users
async def initialize_demo_users():
    """Initialize demo users for testing purposes"""
    demo_users = [
        {
            "email": "admin@test.com",
            "username": "admin",
            "password": "admin123",
            "full_name": "Admin User",
            "role": UserRole.ADMIN,
            "organization": "PentestPro Demo",
            "team": "Security Team"
        },
        {
            "email": "analyst@test.com", 
            "username": "analyst",
            "password": "analyst123",
            "full_name": "Security Analyst",
            "role": UserRole.SECURITY_ANALYST,
            "organization": "PentestPro Demo",
            "team": "Security Team"
        },
        {
            "email": "viewer@test.com",
            "username": "viewer", 
            "password": "viewer123",
            "full_name": "Viewer User",
            "role": UserRole.VIEWER,
            "organization": "PentestPro Demo",
            "team": "Security Team"
        },
        {
            "email": "auditor@test.com",
            "username": "auditor",
            "password": "auditor123", 
            "full_name": "Auditor User",
            "role": UserRole.AUDITOR,
            "organization": "PentestPro Demo",
            "team": "Security Team"
        }
    ]
    
    for user_data in demo_users:
        # Check if user already exists
        existing_user = await db.users.find_one({"email": user_data["email"]})
        if not existing_user:
            # Create new demo user
            password_hash = get_password_hash(user_data["password"])
            user = User(
                email=user_data["email"],
                username=user_data["username"],
                full_name=user_data["full_name"],
                role=user_data["role"],
                organization=user_data["organization"],
                team=user_data["team"],
                is_verified=True
            )
            
            # Prepare user data for MongoDB
            user_dict = prepare_for_mongo(user.model_dump())
            user_dict["password_hash"] = password_hash
            
            # Save to database
            await db.users.insert_one(user_dict)
            logging.info(f"Created demo user: {user_data['email']}")
        else:
            logging.info(f"Demo user already exists: {user_data['email']}")

# Initialize sample data
@api_router.post("/init-sample-data")
async def initialize_sample_data():
    """
    Initialize sample templates, assessments, and demo users in the database.
    This replaces any existing data to ensure consistency.
    """
    # Clear existing data first
    await db.templates.delete_many({})
    await db.assessments.delete_many({})
    await db.reports.delete_many({})
    await db.users.delete_many({})  # Clear existing users to reinitialize with correct roles
    
    # Initialize demo users after clearing
    await initialize_demo_users()
    
    # Comprehensive sample templates - 25+ Assessment Types
    web_app_template = Template(
        name="Web Application Penetration Test",
        description="Comprehensive web application security assessment following OWASP methodology",
        category="Web Application",
        steps=[
            TemplateStep(
                name="Information Gathering & Reconnaissance",
                description="Comprehensive information gathering and target enumeration",
                instructions="Conduct thorough reconnaissance to identify target scope, technologies, and potential attack vectors. Use both passive and active information gathering techniques.",
                fields=[
                    TemplateField(label="Primary Target URL", type=FieldType.URL, required=True, placeholder="https://example.com"),
                    TemplateField(label="Additional URLs/Domains", type=FieldType.TEXTAREA, placeholder="List all in-scope domains and URLs"),
                    TemplateField(label="Web Technologies Identified", type=FieldType.TEXTAREA, placeholder="Framework, server, CMS, etc."),
                    TemplateField(label="Subdomain Enumeration Results", type=FieldType.TEXTAREA, placeholder="Discovered subdomains"),
                    TemplateField(label="Directory/File Enumeration", type=FieldType.TEXTAREA, placeholder="Discovered directories and files"),
                    TemplateField(label="SSL/TLS Configuration", type=FieldType.SELECT, options=["Secure", "Weak Ciphers", "Expired Certificate", "Self-Signed", "Not Implemented"]),
                    TemplateField(label="WAF Detection", type=FieldType.SELECT, options=["No WAF Detected", "CloudFlare", "AWS WAF", "ModSecurity", "F5 ASM", "Other"]),
                ],
                order=1
            ),
            TemplateStep(
                name="Authentication & Session Management",
                description="Comprehensive authentication and session security testing",
                instructions="Test all authentication mechanisms, session handling, and access controls. Focus on bypass techniques and session vulnerabilities.",
                fields=[
                    TemplateField(label="Authentication Method", type=FieldType.SELECT, options=["Form-based", "Basic Auth", "OAuth 2.0", "SAML", "Multi-factor", "API Key", "JWT"]),
                    TemplateField(label="Password Policy Strength", type=FieldType.SELECT, options=["Strong", "Moderate", "Weak", "None"]),
                    TemplateField(label="Brute Force Protection", type=FieldType.CHECKBOX),
                    TemplateField(label="Account Lockout Mechanism", type=FieldType.CHECKBOX),
                    TemplateField(label="Session Timeout Configured", type=FieldType.CHECKBOX),
                    TemplateField(label="Secure Session Cookies", type=FieldType.CHECKBOX),
                    TemplateField(label="Authentication Bypass Attempts", type=FieldType.TEXTAREA, placeholder="Detail bypass attempts and results"),
                    TemplateField(label="Privilege Escalation Tests", type=FieldType.TEXTAREA, placeholder="Horizontal/vertical privilege escalation tests"),
                ],
                order=2
            ),
            TemplateStep(
                name="Input Validation & Injection Testing",
                description="Comprehensive input validation and injection vulnerability testing",
                instructions="Test all input vectors for injection vulnerabilities including SQL, NoSQL, LDAP, XPath, OS command injection, and template injection.",
                fields=[
                    TemplateField(label="SQL Injection Found", type=FieldType.CHECKBOX),
                    TemplateField(label="SQL Injection Details", type=FieldType.TEXTAREA, placeholder="Parameter, payload, impact"),
                    TemplateField(label="NoSQL Injection Found", type=FieldType.CHECKBOX),
                    TemplateField(label="OS Command Injection", type=FieldType.CHECKBOX),
                    TemplateField(label="LDAP Injection", type=FieldType.CHECKBOX),
                    TemplateField(label="XPath Injection", type=FieldType.CHECKBOX),
                    TemplateField(label="Template Injection", type=FieldType.CHECKBOX),
                    TemplateField(label="File Upload Vulnerabilities", type=FieldType.CHECKBOX),
                    TemplateField(label="XXE (XML External Entity)", type=FieldType.CHECKBOX),
                    TemplateField(label="Input Validation Summary", type=FieldType.TEXTAREA, placeholder="Summary of all injection testing results"),
                ],
                order=3
            ),
            TemplateStep(
                name="Cross-Site Scripting (XSS) Testing",
                description="Comprehensive XSS vulnerability assessment",
                instructions="Test for all types of XSS vulnerabilities including stored, reflected, and DOM-based XSS. Test both manual and automated approaches.",
                fields=[
                    TemplateField(label="Reflected XSS Found", type=FieldType.CHECKBOX),
                    TemplateField(label="Stored XSS Found", type=FieldType.CHECKBOX),
                    TemplateField(label="DOM-based XSS Found", type=FieldType.CHECKBOX),
                    TemplateField(label="XSS Filter Bypass", type=FieldType.CHECKBOX),
                    TemplateField(label="Content Security Policy", type=FieldType.SELECT, options=["Properly Implemented", "Weak Implementation", "Bypassable", "Not Implemented"]),
                    TemplateField(label="XSS Payloads Used", type=FieldType.TEXTAREA, placeholder="List successful XSS payloads"),
                    TemplateField(label="XSS Impact Assessment", type=FieldType.TEXTAREA, placeholder="Describe potential impact of XSS vulnerabilities"),
                ],
                order=4
            ),
            TemplateStep(
                name="Business Logic & Authorization",
                description="Business logic flaw and authorization vulnerability testing",
                instructions="Test business logic flows, authorization mechanisms, and application-specific vulnerabilities that automated tools miss.",
                fields=[
                    TemplateField(label="IDOR (Insecure Direct Object Reference)", type=FieldType.CHECKBOX),
                    TemplateField(label="Missing Function Level Access Control", type=FieldType.CHECKBOX),
                    TemplateField(label="Race Condition Vulnerabilities", type=FieldType.CHECKBOX),
                    TemplateField(label="Business Logic Bypass", type=FieldType.CHECKBOX),
                    TemplateField(label="Price Manipulation", type=FieldType.CHECKBOX),
                    TemplateField(label="Workflow Bypass", type=FieldType.CHECKBOX),
                    TemplateField(label="CSRF Vulnerabilities", type=FieldType.CHECKBOX),
                    TemplateField(label="Business Logic Findings", type=FieldType.TEXTAREA, placeholder="Detail business logic vulnerabilities found"),
                ],
                order=5
            ),
            TemplateStep(
                name="Client-Side Security",
                description="Client-side security controls and vulnerabilities",
                instructions="Analyze client-side security implementations, JavaScript security, and browser-specific vulnerabilities.",
                fields=[
                    TemplateField(label="Clickjacking Protection", type=FieldType.SELECT, options=["X-Frame-Options Set", "CSP frame-ancestors", "Not Protected"]),
                    TemplateField(label="HTTPS Enforcement", type=FieldType.SELECT, options=["HSTS Implemented", "Redirect Only", "Mixed Content", "No HTTPS"]),
                    TemplateField(label="Sensitive Data in Client", type=FieldType.CHECKBOX),
                    TemplateField(label="Client-Side Authentication", type=FieldType.CHECKBOX),
                    TemplateField(label="Insecure JavaScript Libraries", type=FieldType.CHECKBOX),
                    TemplateField(label="Source Code Exposure", type=FieldType.CHECKBOX),
                    TemplateField(label="Client-Side Findings", type=FieldType.TEXTAREA, placeholder="Detail client-side security issues"),
                ],
                order=6
            )
        ],
        report_structure=[
            ReportSection(
                title="Executive Summary", 
                content_template="This comprehensive web application security assessment identified critical vulnerabilities requiring immediate remediation. The assessment covered authentication mechanisms, input validation, session management, and business logic security controls.",
                order=1
            ),
            ReportSection(
                title="Assessment Scope & Methodology", 
                content_template="The assessment followed OWASP ASVS guidelines and included both automated and manual testing techniques. Testing covered authentication, input validation, session management, authorization, and business logic vulnerabilities.",
                order=2
            ),
            ReportSection(
                title="Technical Findings", 
                content_template="Detailed technical findings with CVSS scores, proof-of-concept exploits, and specific remediation guidance for each identified vulnerability.",
                order=3
            ),
            ReportSection(
                title="Risk Assessment & Recommendations", 
                content_template="Risk-prioritized recommendations with implementation timelines and verification criteria for successful remediation.",
                order=4
            )
        ]
    )
    
    network_template = Template(
        name="Network Infrastructure Penetration Test",
        description="Comprehensive network security assessment and infrastructure penetration testing",
        category="Network Security",
        steps=[
            TemplateStep(
                name="Network Discovery & Enumeration",
                description="Network reconnaissance and service enumeration",
                instructions="Perform comprehensive network discovery to identify live hosts, open ports, and running services. Use both active and passive techniques.",
                fields=[
                    TemplateField(label="Target IP Range/CIDR", type=FieldType.TEXT, required=True, placeholder="192.168.1.0/24"),
                    TemplateField(label="Live Hosts Discovered", type=FieldType.NUMBER),
                    TemplateField(label="Total Open Ports", type=FieldType.NUMBER),
                    TemplateField(label="Critical Services Found", type=FieldType.TEXTAREA, placeholder="SSH, RDP, SMB, etc."),
                    TemplateField(label="Network Topology Mapping", type=FieldType.TEXTAREA, placeholder="Network segments and routing"),
                    TemplateField(label="SNMP Community Strings", type=FieldType.SELECT, options=["Secure", "Default Found", "Weak", "Not Tested"]),
                ],
                order=1
            ),
            TemplateStep(
                name="Vulnerability Assessment",
                description="Network vulnerability scanning and analysis",
                instructions="Perform comprehensive vulnerability scanning of discovered services and systems.",
                fields=[
                    TemplateField(label="Vulnerability Scanner Used", type=FieldType.SELECT, options=["Nessus", "OpenVAS", "Rapid7 Nexpose", "Qualys", "Nmap NSE"]),
                    TemplateField(label="Critical Vulnerabilities", type=FieldType.NUMBER),
                    TemplateField(label="High Risk Vulnerabilities", type=FieldType.NUMBER),
                    TemplateField(label="Medium Risk Vulnerabilities", type=FieldType.NUMBER),
                    TemplateField(label="Unpatched Systems Found", type=FieldType.CHECKBOX),
                    TemplateField(label="Default Credentials Found", type=FieldType.CHECKBOX),
                    TemplateField(label="Legacy Systems Identified", type=FieldType.CHECKBOX),
                ],
                order=2
            ),
            TemplateStep(
                name="Service-Specific Testing",
                description="Detailed testing of identified network services",
                instructions="Conduct service-specific penetration testing for SSH, FTP, SMB, RDP, and other discovered services.",
                fields=[
                    TemplateField(label="SSH Brute Force Successful", type=FieldType.CHECKBOX),
                    TemplateField(label="SMB Null Session", type=FieldType.CHECKBOX),
                    TemplateField(label="SMB Share Enumeration", type=FieldType.CHECKBOX),
                    TemplateField(label="FTP Anonymous Access", type=FieldType.CHECKBOX),
                    TemplateField(label="RDP Brute Force", type=FieldType.CHECKBOX),
                    TemplateField(label="DNS Zone Transfer", type=FieldType.CHECKBOX),
                    TemplateField(label="Service Exploitation Results", type=FieldType.TEXTAREA, placeholder="Detailed exploitation results"),
                ],
                order=3
            ),
            TemplateStep(
                name="Post-Exploitation & Lateral Movement",
                description="Post-exploitation activities and lateral movement assessment",
                instructions="If system access is gained, assess lateral movement capabilities and privilege escalation paths.",
                fields=[
                    TemplateField(label="Initial Access Gained", type=FieldType.CHECKBOX),
                    TemplateField(label="Privilege Escalation Successful", type=FieldType.CHECKBOX),
                    TemplateField(label="Lateral Movement Achieved", type=FieldType.CHECKBOX),
                    TemplateField(label="Domain Admin Compromise", type=FieldType.CHECKBOX),
                    TemplateField(label="Sensitive Data Access", type=FieldType.CHECKBOX),
                    TemplateField(label="Persistence Mechanisms", type=FieldType.TEXTAREA, placeholder="Methods used to maintain access"),
                ],
                order=4
            )
        ],
        report_structure=[
            ReportSection(title="Executive Summary", content_template="Network infrastructure assessment findings and business impact analysis.", order=1),
            ReportSection(title="Network Architecture Review", content_template="Analysis of network segmentation, security controls, and architecture.", order=2),
            ReportSection(title="Vulnerability Analysis", content_template="Detailed vulnerability findings with risk ratings and exploitation proof-of-concepts.", order=3),
            ReportSection(title="Remediation Roadmap", content_template="Prioritized security improvements and implementation guidance.", order=4)
        ]
    )
    
    api_template = Template(
        name="API Security Assessment",
        description="Comprehensive REST/GraphQL API security testing following OWASP API Security guidelines",
        category="API Security",
        steps=[
            TemplateStep(
                name="API Discovery & Documentation Review",
                description="API endpoint discovery and documentation analysis",
                instructions="Discover all API endpoints through documentation review, directory enumeration, and traffic analysis. Analyze API documentation for security implications.",
                fields=[
                    TemplateField(label="Base API URL", type=FieldType.URL, required=True, placeholder="https://api.example.com/v1"),
                    TemplateField(label="API Type", type=FieldType.SELECT, options=["REST", "GraphQL", "SOAP", "gRPC", "Mixed"]),
                    TemplateField(label="Documentation Available", type=FieldType.SELECT, options=["Swagger/OpenAPI", "Postman Collection", "Custom Docs", "No Documentation"]),
                    TemplateField(label="Total Endpoints Discovered", type=FieldType.NUMBER),
                    TemplateField(label="Authentication Methods", type=FieldType.SELECT, options=["JWT", "OAuth 2.0", "API Key", "Basic Auth", "Bearer Token", "Custom", "None"]),
                    TemplateField(label="Undocumented Endpoints Found", type=FieldType.CHECKBOX),
                    TemplateField(label="Sensitive Endpoints Exposed", type=FieldType.CHECKBOX),
                    TemplateField(label="API Versioning Scheme", type=FieldType.TEXT, placeholder="v1, v2, etc."),
                ],
                order=1
            ),
            TemplateStep(
                name="Authentication & Authorization Testing",
                description="Comprehensive API authentication and authorization testing",
                instructions="Test all authentication mechanisms, token handling, and authorization controls. Focus on OWASP API Security Top 10 issues.",
                fields=[
                    TemplateField(label="Broken Object Level Authorization", type=FieldType.CHECKBOX),
                    TemplateField(label="Broken Authentication", type=FieldType.CHECKBOX),
                    TemplateField(label="Excessive Data Exposure", type=FieldType.CHECKBOX),
                    TemplateField(label="Lack of Rate Limiting", type=FieldType.CHECKBOX),
                    TemplateField(label="Broken Function Level Authorization", type=FieldType.CHECKBOX),
                    TemplateField(label="Mass Assignment", type=FieldType.CHECKBOX),
                    TemplateField(label="JWT Token Vulnerabilities", type=FieldType.SELECT, options=["None Algorithm Attack", "Weak Secret", "No Expiry", "Signature Bypass", "No Issues"]),
                    TemplateField(label="API Key Exposure", type=FieldType.CHECKBOX),
                    TemplateField(label="Authorization Bypass Details", type=FieldType.TEXTAREA, placeholder="Detail bypass techniques and impact"),
                ],
                order=2
            ),
            TemplateStep(
                name="Input Validation & Injection Testing",
                description="API input validation and injection vulnerability testing",
                instructions="Test all API parameters for injection vulnerabilities and input validation bypass.",
                fields=[
                    TemplateField(label="SQL Injection in API", type=FieldType.CHECKBOX),
                    TemplateField(label="NoSQL Injection", type=FieldType.CHECKBOX),
                    TemplateField(label="XML Injection", type=FieldType.CHECKBOX),
                    TemplateField(label="JSON Injection", type=FieldType.CHECKBOX),
                    TemplateField(label="Command Injection", type=FieldType.CHECKBOX),
                    TemplateField(label="Server Side Request Forgery (SSRF)", type=FieldType.CHECKBOX),
                    TemplateField(label="XML External Entity (XXE)", type=FieldType.CHECKBOX),
                    TemplateField(label="GraphQL Specific Issues", type=FieldType.CHECKBOX),
                    TemplateField(label="Input Validation Results", type=FieldType.TEXTAREA, placeholder="Details of injection testing results"),
                ],
                order=3
            ),
            TemplateStep(
                name="Business Logic & Rate Limiting",
                description="API business logic and rate limiting assessment",
                instructions="Test API business logic, rate limiting, and abuse cases specific to API functionality.",
                fields=[
                    TemplateField(label="Rate Limiting Implemented", type=FieldType.SELECT, options=["Proper Implementation", "Weak Limits", "Bypassable", "Not Implemented"]),
                    TemplateField(label="API Abuse Scenarios", type=FieldType.CHECKBOX),
                    TemplateField(label="Resource Exhaustion", type=FieldType.CHECKBOX),
                    TemplateField(label="Batch Request Abuse", type=FieldType.CHECKBOX),
                    TemplateField(label="Price/Quantity Manipulation", type=FieldType.CHECKBOX),
                    TemplateField(label="Workflow Bypass", type=FieldType.CHECKBOX),
                    TemplateField(label="Business Logic Findings", type=FieldType.TEXTAREA, placeholder="API-specific business logic vulnerabilities"),
                ],
                order=4
            )
        ],
        report_structure=[
            ReportSection(title="API Security Overview", content_template="Comprehensive analysis of API architecture, authentication, and security posture.", order=1),
            ReportSection(title="OWASP API Security Assessment", content_template="Assessment against OWASP API Security Top 10 vulnerabilities.", order=2),
            ReportSection(title="Technical Vulnerabilities", content_template="Detailed technical findings with exploitation proof-of-concepts.", order=3),
            ReportSection(title="API Security Recommendations", content_template="Prioritized recommendations for API security hardening.", order=4)
        ]
    )
    
    cloud_template = Template(
        name="Cloud Security Assessment",
        description="Comprehensive cloud infrastructure and configuration security assessment",
        category="Cloud Security",
        steps=[
            TemplateStep(
                name="Cloud Environment Enumeration",
                description="Cloud service discovery and configuration review",
                instructions="Identify cloud services, configurations, and security posture across the cloud environment.",
                fields=[
                    TemplateField(label="Cloud Provider", type=FieldType.SELECT, options=["AWS", "Azure", "Google Cloud", "Multi-Cloud", "Hybrid"]),
                    TemplateField(label="Services in Scope", type=FieldType.TEXTAREA, placeholder="EC2, S3, Lambda, etc."),
                    TemplateField(label="Total Cloud Resources", type=FieldType.NUMBER),
                    TemplateField(label="IAM Users/Roles Count", type=FieldType.NUMBER),
                    TemplateField(label="Public-Facing Services", type=FieldType.CHECKBOX),
                    TemplateField(label="Data Storage Services", type=FieldType.CHECKBOX),
                ],
                order=1
            ),
            TemplateStep(
                name="Identity & Access Management (IAM)",
                description="Cloud IAM security assessment",
                instructions="Review IAM policies, roles, permissions, and access controls for security misconfigurations.",
                fields=[
                    TemplateField(label="Overprivileged Accounts", type=FieldType.CHECKBOX),
                    TemplateField(label="Unused IAM Entities", type=FieldType.CHECKBOX),
                    TemplateField(label="Weak Password Policies", type=FieldType.CHECKBOX),
                    TemplateField(label="MFA Not Enforced", type=FieldType.CHECKBOX),
                    TemplateField(label="Cross-Account Access Issues", type=FieldType.CHECKBOX),
                    TemplateField(label="Service Account Abuse", type=FieldType.CHECKBOX),
                    TemplateField(label="IAM Findings Summary", type=FieldType.TEXTAREA, placeholder="Key IAM security issues identified"),
                ],
                order=2
            ),
            TemplateStep(
                name="Data Security & Storage",
                description="Cloud data security and storage configuration assessment",
                instructions="Assess data protection, encryption, and storage security configurations.",
                fields=[
                    TemplateField(label="Unencrypted Data Stores", type=FieldType.CHECKBOX),
                    TemplateField(label="Public Storage Buckets", type=FieldType.CHECKBOX),
                    TemplateField(label="Weak Encryption Keys", type=FieldType.CHECKBOX),
                    TemplateField(label="Data Backup Security", type=FieldType.SELECT, options=["Secure", "Partially Secure", "Insecure", "Not Implemented"]),
                    TemplateField(label="Data Classification Issues", type=FieldType.CHECKBOX),
                    TemplateField(label="Data Loss Prevention", type=FieldType.SELECT, options=["Implemented", "Partially Implemented", "Not Implemented"]),
                ],
                order=3
            ),
            TemplateStep(
                name="Network Security & Infrastructure",
                description="Cloud network security and infrastructure hardening assessment",
                instructions="Review network security groups, VPC configurations, and infrastructure security.",
                fields=[
                    TemplateField(label="Open Security Groups", type=FieldType.CHECKBOX),
                    TemplateField(label="Unrestricted Inbound Rules", type=FieldType.CHECKBOX),
                    TemplateField(label="VPC Misconfiguration", type=FieldType.CHECKBOX),
                    TemplateField(label="Insecure Load Balancers", type=FieldType.CHECKBOX),
                    TemplateField(label="Missing Network Monitoring", type=FieldType.CHECKBOX),
                    TemplateField(label="Infrastructure Vulnerabilities", type=FieldType.TEXTAREA, placeholder="Network and infrastructure security issues"),
                ],
                order=4
            )
        ],
        report_structure=[
            ReportSection(title="Cloud Security Posture", content_template="Overall cloud security assessment and compliance status.", order=1),
            ReportSection(title="Configuration Analysis", content_template="Detailed analysis of cloud service configurations and misconfigurations.", order=2),
            ReportSection(title="Compliance & Governance", content_template="Assessment against cloud security frameworks and best practices.", order=3),
            ReportSection(title="Remediation Strategy", content_template="Prioritized cloud security improvements and implementation guidance.", order=4)
        ]
    )
    
    mobile_template = Template(
        name="Mobile Application Security Assessment",
        description="Comprehensive mobile app security testing following OWASP MASVS guidelines",
        category="Mobile Security",
        steps=[
            TemplateStep(
                name="Application Profiling & Setup",
                description="Mobile application analysis setup and profiling",
                instructions="Set up testing environment, analyze app metadata, and perform initial profiling of the mobile application.",
                fields=[
                    TemplateField(label="Mobile Platform", type=FieldType.SELECT, options=["iOS", "Android", "Cross-Platform"], required=True),
                    TemplateField(label="App Framework", type=FieldType.SELECT, options=["Native", "React Native", "Flutter", "Xamarin", "Ionic", "Cordova"]),
                    TemplateField(label="App Store/Package Name", type=FieldType.TEXT, placeholder="com.example.app"),
                    TemplateField(label="App Version Tested", type=FieldType.TEXT, placeholder="1.0.0"),
                    TemplateField(label="Device/Simulator Used", type=FieldType.TEXT, placeholder="iPhone 14 Pro, Pixel 6"),
                    TemplateField(label="Testing Tools Setup", type=FieldType.TEXTAREA, placeholder="Burp Suite, Frida, MobSF, etc."),
                ],
                order=1
            ),
            TemplateStep(
                name="Static Application Security Testing (SAST)",
                description="Source code and binary static analysis",
                instructions="Perform comprehensive static analysis of application code, binaries, and configuration files.",
                fields=[
                    TemplateField(label="Hardcoded Credentials/Secrets", type=FieldType.CHECKBOX),
                    TemplateField(label="Insecure Data Storage", type=FieldType.CHECKBOX),
                    TemplateField(label="Weak Cryptography Implementation", type=FieldType.CHECKBOX),
                    TemplateField(label="Insecure Communication", type=FieldType.CHECKBOX),
                    TemplateField(label="Code Obfuscation Present", type=FieldType.SELECT, options=["Strong", "Weak", "None"]),
                    TemplateField(label="Debug Information Exposed", type=FieldType.CHECKBOX),
                    TemplateField(label="Backup Allowance Enabled", type=FieldType.CHECKBOX),
                    TemplateField(label="App Transport Security Issues", type=FieldType.CHECKBOX),
                    TemplateField(label="Static Analysis Findings", type=FieldType.TEXTAREA, placeholder="Detailed static analysis results"),
                ],
                order=2
            ),
            TemplateStep(
                name="Dynamic Application Security Testing (DAST)",
                description="Runtime security testing and dynamic analysis",
                instructions="Test the application during runtime for security vulnerabilities and behavioral analysis.",
                fields=[
                    TemplateField(label="SSL/TLS Certificate Validation", type=FieldType.SELECT, options=["Properly Validated", "Bypass Possible", "Not Implemented"]),
                    TemplateField(label="Certificate Pinning", type=FieldType.SELECT, options=["Implemented", "Bypassable", "Not Implemented"]),
                    TemplateField(label="Root/Jailbreak Detection", type=FieldType.SELECT, options=["Strong", "Weak", "Bypassable", "None"]),
                    TemplateField(label="Anti-Debugging Protection", type=FieldType.SELECT, options=["Strong", "Weak", "Bypassable", "None"]),
                    TemplateField(label="Runtime Application Self-Protection", type=FieldType.CHECKBOX),
                    TemplateField(label="Memory Dump Analysis", type=FieldType.CHECKBOX),
                    TemplateField(label="Network Traffic Interception", type=FieldType.CHECKBOX),
                    TemplateField(label="Dynamic Analysis Results", type=FieldType.TEXTAREA, placeholder="Runtime testing findings and exploitation results"),
                ],
                order=3
            ),
            TemplateStep(
                name="Platform-Specific Security Testing",
                description="iOS/Android specific security feature testing",
                instructions="Test platform-specific security features and configurations.",
                fields=[
                    TemplateField(label="Keychain/Keystore Security", type=FieldType.SELECT, options=["Secure Implementation", "Weak Implementation", "Insecure"]),
                    TemplateField(label="Biometric Authentication", type=FieldType.SELECT, options=["Properly Implemented", "Bypassable", "Not Used"]),
                    TemplateField(label="App Permissions Analysis", type=FieldType.TEXTAREA, placeholder="Excessive or unnecessary permissions"),
                    TemplateField(label="Deep Link Vulnerabilities", type=FieldType.CHECKBOX),
                    TemplateField(label="URL Scheme Hijacking", type=FieldType.CHECKBOX),
                    TemplateField(label="WebView Security Issues", type=FieldType.CHECKBOX),
                    TemplateField(label="Intent/URL Handler Issues", type=FieldType.CHECKBOX),
                    TemplateField(label="Platform Security Summary", type=FieldType.TEXTAREA, placeholder="Platform-specific security findings"),
                ],
                order=4
            ),
            TemplateStep(
                name="Business Logic & Session Management",
                description="Mobile app business logic and session security testing",
                instructions="Test business logic specific to mobile applications and session management security.",
                fields=[
                    TemplateField(label="Session Management Issues", type=FieldType.CHECKBOX),
                    TemplateField(label="Offline Mode Security", type=FieldType.CHECKBOX),
                    TemplateField(label="Push Notification Security", type=FieldType.CHECKBOX),
                    TemplateField(label="In-App Purchase Bypass", type=FieldType.CHECKBOX),
                    TemplateField(label="Mobile-Specific Business Logic", type=FieldType.CHECKBOX),
                    TemplateField(label="Background App Security", type=FieldType.CHECKBOX),
                    TemplateField(label="Business Logic Findings", type=FieldType.TEXTAREA, placeholder="Mobile business logic vulnerabilities"),
                ],
                order=5
            )
        ],
        report_structure=[
            ReportSection(title="Mobile Security Overview", content_template="Comprehensive mobile application security assessment following OWASP MASVS.", order=1),
            ReportSection(title="Static Analysis Results", content_template="Code review and binary analysis findings with security implications.", order=2),
            ReportSection(title="Dynamic Analysis Results", content_template="Runtime testing results and behavioral security analysis.", order=3),
            ReportSection(title="Platform Security Assessment", content_template="iOS/Android specific security feature evaluation.", order=4),
            ReportSection(title="Mobile Security Recommendations", content_template="Prioritized mobile security improvements and best practices.", order=5)
        ]
    )
    
    social_engineering_template = Template(
        name="Social Engineering Assessment",
        description="Comprehensive social engineering and human factor security assessment",
        category="Social Engineering",
        steps=[
            TemplateStep(
                name="Open Source Intelligence (OSINT)",
                description="Information gathering from public sources",
                instructions="Gather intelligence from public sources about the target organization and employees.",
                fields=[
                    TemplateField(label="Target Organization", type=FieldType.TEXT, required=True),
                    TemplateField(label="Employee Count Identified", type=FieldType.NUMBER),
                    TemplateField(label="Social Media Profiles Found", type=FieldType.NUMBER),
                    TemplateField(label="Sensitive Information Exposed", type=FieldType.CHECKBOX),
                    TemplateField(label="Organizational Chart Reconstructed", type=FieldType.CHECKBOX),
                    TemplateField(label="Technology Stack Identified", type=FieldType.CHECKBOX),
                    TemplateField(label="OSINT Findings Summary", type=FieldType.TEXTAREA, placeholder="Key intelligence gathered"),
                ],
                order=1
            ),
            TemplateStep(
                name="Phishing Campaign Assessment",
                description="Email phishing simulation and awareness testing",
                instructions="Execute controlled phishing campaigns to assess security awareness.",
                fields=[
                    TemplateField(label="Phishing Emails Sent", type=FieldType.NUMBER),
                    TemplateField(label="Click Rate", type=FieldType.TEXT, placeholder="X%"),
                    TemplateField(label="Credential Submission Rate", type=FieldType.TEXT, placeholder="X%"),
                    TemplateField(label="Reporting Rate", type=FieldType.TEXT, placeholder="X%"),
                    TemplateField(label="Malware Download Simulation", type=FieldType.CHECKBOX),
                    TemplateField(label="Spear Phishing Success", type=FieldType.CHECKBOX),
                    TemplateField(label="Phishing Results Analysis", type=FieldType.TEXTAREA, placeholder="Detailed phishing campaign results"),
                ],
                order=2
            ),
            TemplateStep(
                name="Physical Security Assessment",
                description="Physical access and security control testing",
                instructions="Test physical security controls and unauthorized access prevention.",
                fields=[
                    TemplateField(label="Tailgating Successful", type=FieldType.CHECKBOX),
                    TemplateField(label="Badge Cloning Possible", type=FieldType.CHECKBOX),
                    TemplateField(label="Dumpster Diving Results", type=FieldType.CHECKBOX),
                    TemplateField(label="Lock Picking/Bypassing", type=FieldType.CHECKBOX),
                    TemplateField(label="Surveillance System Gaps", type=FieldType.CHECKBOX),
                    TemplateField(label="USB Drop Test", type=FieldType.CHECKBOX),
                    TemplateField(label="Physical Security Findings", type=FieldType.TEXTAREA, placeholder="Physical security assessment results"),
                ],
                order=3
            ),
            TemplateStep(
                name="Voice/Phone-Based Attacks",
                description="Vishing and phone-based social engineering testing",
                instructions="Test susceptibility to voice-based social engineering attacks.",
                fields=[
                    TemplateField(label="Vishing Calls Made", type=FieldType.NUMBER),
                    TemplateField(label="Information Disclosure Rate", type=FieldType.TEXT, placeholder="X%"),
                    TemplateField(label="Password Reset Success", type=FieldType.CHECKBOX),
                    TemplateField(label="IT Support Impersonation", type=FieldType.CHECKBOX),
                    TemplateField(label="Executive Impersonation", type=FieldType.CHECKBOX),
                    TemplateField(label="Voice Attack Results", type=FieldType.TEXTAREA, placeholder="Phone-based attack outcomes"),
                ],
                order=4
            )
        ],
        report_structure=[
            ReportSection(title="Social Engineering Overview", content_template="Assessment of human factor security risks and organizational awareness.", order=1),
            ReportSection(title="Attack Vector Analysis", content_template="Detailed analysis of successful social engineering attack vectors.", order=2),
            ReportSection(title="Security Awareness Assessment", content_template="Employee security awareness and training effectiveness evaluation.", order=3),
            ReportSection(title="Human Factor Recommendations", content_template="Security awareness training and policy recommendations.", order=4)
        ]
    )
    
    wireless_template = Template(
        name="Wireless Network Security Assessment",
        description="Comprehensive wireless network security assessment covering WiFi, Bluetooth, IoT protocols, infrastructure security, and enterprise wireless implementations following industry best practices",
        category="Wireless Security",
        steps=[
            TemplateStep(
                name="Wireless Infrastructure & Architecture Assessment",
                description="Comprehensive evaluation of wireless infrastructure design, deployment, and security architecture",
                instructions="Assess wireless network infrastructure including access points, controllers, management systems, and overall wireless architecture security.",
                fields=[
                    TemplateField(label="Wireless Infrastructure Type", type=FieldType.SELECT, options=["Enterprise Wireless", "SMB Wireless", "Public WiFi", "Industrial Wireless", "Mixed Environment"], required=True),
                    TemplateField(label="Access Point Count", type=FieldType.NUMBER, placeholder="Total number of wireless access points discovered"),
                    TemplateField(label="Wireless Controller Type", type=FieldType.SELECT, options=["Centralized Controller", "Cloud-Managed", "Autonomous APs", "Hybrid Management", "No Central Management"]),
                    TemplateField(label="Vendor Ecosystem", type=FieldType.TEXTAREA, placeholder="Cisco, Aruba, Ubiquiti, Meraki, etc."),
                    TemplateField(label="Coverage Area Assessment", type=FieldType.SELECT, options=["Comprehensive Coverage", "Adequate Coverage", "Limited Coverage", "Poor Coverage"]),
                    TemplateField(label="Frequency Bands Used", type=FieldType.TEXTAREA, placeholder="2.4GHz, 5GHz, 6GHz usage and configuration"),
                    TemplateField(label="Channel Planning & Interference", type=FieldType.SELECT, options=["Optimal Channel Plan", "Good Channel Plan", "Basic Channel Plan", "Poor Channel Planning"]),
                    TemplateField(label="Power Management", type=FieldType.SELECT, options=["Dynamic Power Control", "Static Power Settings", "Default Power", "Excessive Power"]),
                    TemplateField(label="Physical Security of APs", type=FieldType.SELECT, options=["Physically Secured", "Partially Secured", "Basic Security", "Unsecured"]),
                    TemplateField(label="Management Interface Security", type=FieldType.SELECT, options=["Secure Management", "Basic Security", "Default Credentials", "Insecure Management"]),
                    TemplateField(label="Firmware Management", type=FieldType.SELECT, options=["Centralized Updates", "Manual Updates", "Outdated Firmware", "Mixed Firmware Versions"]),
                ],
                order=1
            ),
            TemplateStep(
                name="WiFi Security Configuration Analysis",
                description="Detailed analysis of WiFi security configurations, encryption standards, and authentication mechanisms",
                instructions="Systematically analyze WiFi network configurations, security protocols, encryption implementations, and authentication mechanisms across all discovered networks.",
                fields=[
                    TemplateField(label="Total Wireless Networks Discovered", type=FieldType.NUMBER, placeholder="Total SSIDs discovered in assessment scope"),
                    TemplateField(label="Open Networks (No Security)", type=FieldType.NUMBER, placeholder="Unencrypted networks with no authentication"),
                    TemplateField(label="WEP Encrypted Networks", type=FieldType.NUMBER, placeholder="Networks using deprecated WEP encryption"),
                    TemplateField(label="WPA/WPA2-PSK Networks", type=FieldType.NUMBER, placeholder="Networks using WPA/WPA2 with pre-shared keys"),
                    TemplateField(label="WPA2-Enterprise Networks", type=FieldType.NUMBER, placeholder="Enterprise networks with 802.1X authentication"),
                    TemplateField(label="WPA3-SAE Networks", type=FieldType.NUMBER, placeholder="Networks using WPA3 Simultaneous Authentication of Equals"),
                    TemplateField(label="WPA3-Enterprise Networks", type=FieldType.NUMBER, placeholder="Enterprise networks with WPA3-Enterprise"),
                    TemplateField(label="Hidden SSID Networks", type=FieldType.NUMBER, placeholder="Networks with SSID broadcast disabled"),
                    TemplateField(label="Guest Network Implementation", type=FieldType.SELECT, options=["Properly Isolated", "Basic Isolation", "Limited Isolation", "No Isolation", "No Guest Network"]),
                    TemplateField(label="MAC Address Filtering", type=FieldType.SELECT, options=["Implemented", "Partially Implemented", "Not Implemented"]),
                    TemplateField(label="Weak PSK Implementation", type=FieldType.TEXTAREA, placeholder="Networks with weak or default pre-shared keys"),
                    TemplateField(label="Rogue Access Points Detected", type=FieldType.NUMBER, placeholder="Unauthorized access points discovered"),
                ],
                order=2
            ),
            TemplateStep(
                name="Wireless Attack Testing & Exploitation",
                description="Active security testing through wireless attack simulation and penetration testing techniques",
                instructions="Conduct ethical wireless penetration testing using industry-standard attack techniques to identify exploitable vulnerabilities and assess defensive capabilities.",
                fields=[
                    TemplateField(label="Attack Testing Tools Used", type=FieldType.TEXTAREA, placeholder="Aircrack-ng, Kismet, WiFi Pineapple, custom tools, etc."),
                    TemplateField(label="WEP Cracking Success", type=FieldType.NUMBER, placeholder="Number of WEP networks successfully cracked"),
                    TemplateField(label="WPA/WPA2 PSK Cracking", type=FieldType.TEXTAREA, placeholder="Successful dictionary/brute force attacks against PSK networks"),
                    TemplateField(label="Evil Twin Attack Success", type=FieldType.SELECT, options=["Highly Successful", "Partially Successful", "Limited Success", "Unsuccessful"]),
                    TemplateField(label="Captive Portal Bypass", type=FieldType.SELECT, options=["Successfully Bypassed", "Partial Bypass", "Bypass Attempted", "Not Applicable"]),
                    TemplateField(label="Deauthentication Attack Effectiveness", type=FieldType.SELECT, options=["Highly Effective", "Moderately Effective", "Limited Effectiveness", "Ineffective"]),
                    TemplateField(label="Client Device Exploitation", type=FieldType.TEXTAREA, placeholder="Successful attacks against wireless client devices"),
                    TemplateField(label="Man-in-the-Middle Attacks", type=FieldType.SELECT, options=["Successful MITM", "Partial MITM", "MITM Attempted", "MITM Failed"]),
                    TemplateField(label="Wireless Injection Attacks", type=FieldType.SELECT, options=["Injection Successful", "Limited Injection", "Injection Failed", "Not Tested"]),
                    TemplateField(label="Credential Harvesting", type=FieldType.TEXTAREA, placeholder="Credentials or sensitive data captured during testing"),
                    TemplateField(label="Network Pivoting Success", type=FieldType.SELECT, options=["Internal Network Access", "Limited Network Access", "No Network Access", "Not Attempted"]),
                    TemplateField(label="Detection & Response", type=FieldType.SELECT, options=["Attack Detected & Blocked", "Attack Detected", "No Detection", "Unknown"]),
                ],
                order=3
            ),
            TemplateStep(
                name="Enterprise Wireless Security & 802.1X Assessment",
                description="Comprehensive evaluation of enterprise wireless security implementations including 802.1X, RADIUS, and certificate-based authentication",
                instructions="Assess enterprise wireless security controls including 802.1X authentication, RADIUS infrastructure, certificate management, and advanced enterprise security features.",
                fields=[
                    TemplateField(label="802.1X Authentication Implementation", type=FieldType.SELECT, options=["Properly Implemented", "Partially Implemented", "Misconfigured", "Not Implemented"]),
                    TemplateField(label="EAP Method Analysis", type=FieldType.TEXTAREA, placeholder="EAP-TLS, EAP-TTLS, PEAP, EAP-FAST analysis and security assessment"),
                    TemplateField(label="RADIUS Server Configuration", type=FieldType.SELECT, options=["Secure Configuration", "Adequate Configuration", "Weak Configuration", "Default Configuration"]),
                    TemplateField(label="Certificate Validation", type=FieldType.SELECT, options=["Strict Certificate Validation", "Basic Validation", "Weak Validation", "No Validation"]),
                    TemplateField(label="Certificate Authority Security", type=FieldType.SELECT, options=["Secure CA Implementation", "Basic CA Security", "Weak CA Security", "Self-Signed Certificates"]),
                    TemplateField(label="RADIUS Shared Secret Security", type=FieldType.SELECT, options=["Strong Shared Secrets", "Adequate Secrets", "Weak Secrets", "Default Secrets"]),
                    TemplateField(label="Network Access Control (NAC)", type=FieldType.SELECT, options=["Comprehensive NAC", "Basic NAC", "Limited NAC", "No NAC"]),
                    TemplateField(label="Dynamic VLAN Assignment", type=FieldType.SELECT, options=["Properly Configured", "Basic Implementation", "Misconfigured", "Not Implemented"]),
                    TemplateField(label="Guest Network Isolation", type=FieldType.SELECT, options=["Complete Isolation", "Partial Isolation", "Basic Isolation", "No Isolation"]),
                    TemplateField(label="Inter-Client Communication", type=FieldType.SELECT, options=["Blocked (Secure)", "Allowed (Risky)", "Partially Blocked", "Unrestricted"]),
                    TemplateField(label="Captive Portal Security", type=FieldType.SELECT, options=["Secure Captive Portal", "Basic Portal", "Weak Portal Security", "No Captive Portal"]),
                    TemplateField(label="Enterprise Security Bypass", type=FieldType.TEXTAREA, placeholder="Successful bypasses of enterprise security controls"),
                ],
                order=4
            ),
            TemplateStep(
                name="Bluetooth & IoT Wireless Protocol Security Assessment",
                description="Security assessment of Bluetooth, IoT wireless protocols, and alternative wireless technologies beyond traditional WiFi",
                instructions="Evaluate security of Bluetooth implementations, IoT wireless protocols (Zigbee, Z-Wave, etc.), and other wireless technologies present in the environment.",
                fields=[
                    TemplateField(label="Bluetooth Device Discovery", type=FieldType.NUMBER, placeholder="Number of Bluetooth devices discovered"),
                    TemplateField(label="Bluetooth Security Analysis", type=FieldType.TEXTAREA, placeholder="Bluetooth version analysis, pairing security, encryption assessment"),
                    TemplateField(label="Bluetooth Attack Success", type=FieldType.SELECT, options=["Multiple Successful Attacks", "Some Successful Attacks", "Limited Success", "No Successful Attacks"]),
                    TemplateField(label="IoT Wireless Protocols Detected", type=FieldType.TEXTAREA, placeholder="Zigbee, Z-Wave, LoRaWAN, Thread, Matter, proprietary protocols"),
                    TemplateField(label="IoT Device Security Assessment", type=FieldType.SELECT, options=["Comprehensive IoT Security", "Basic IoT Security", "Weak IoT Security", "No IoT Security"]),
                    TemplateField(label="IoT Communication Encryption", type=FieldType.SELECT, options=["Strong Encryption", "Basic Encryption", "Weak Encryption", "No Encryption"]),
                    TemplateField(label="IoT Authentication Mechanisms", type=FieldType.SELECT, options=["Strong Authentication", "Basic Authentication", "Weak Authentication", "No Authentication"]),
                    TemplateField(label="IoT Default Credential Usage", type=FieldType.NUMBER, placeholder="IoT devices using default credentials"),
                    TemplateField(label="RF Spectrum Analysis", type=FieldType.TEXTAREA, placeholder="Radio frequency interference, unauthorized transmissions, spectrum usage"),
                    TemplateField(label="Wireless Protocol Vulnerabilities", type=FieldType.TEXTAREA, placeholder="Protocol-level vulnerabilities in non-WiFi wireless communications"),
                    TemplateField(label="Industrial Wireless Security", type=FieldType.SELECT, options=["Industrial Protocols Secure", "Basic Industrial Security", "Weak Industrial Security", "Not Applicable"]),
                ],
                order=5
            ),
            TemplateStep(
                name="Wireless Monitoring, Detection & Incident Response",
                description="Assessment of wireless security monitoring capabilities, threat detection systems, and incident response procedures",
                instructions="Evaluate wireless security monitoring systems, intrusion detection capabilities, and organizational readiness to detect and respond to wireless security incidents.",
                fields=[
                    TemplateField(label="Wireless IDS/IPS Implementation", type=FieldType.SELECT, options=["Comprehensive WIDS/WIPS", "Basic Wireless IDS", "Limited Detection", "No Wireless IDS"]),
                    TemplateField(label="Rogue AP Detection Capability", type=FieldType.SELECT, options=["Automated Rogue Detection", "Manual Detection Process", "Basic Detection", "No Rogue Detection"]),
                    TemplateField(label="Wireless Traffic Monitoring", type=FieldType.SELECT, options=["Comprehensive Traffic Analysis", "Basic Traffic Monitoring", "Limited Monitoring", "No Traffic Monitoring"]),
                    TemplateField(label="Anomaly Detection Systems", type=FieldType.SELECT, options=["Advanced Anomaly Detection", "Basic Anomaly Detection", "Manual Analysis", "No Anomaly Detection"]),
                    TemplateField(label="Incident Response Procedures", type=FieldType.SELECT, options=["Formal Wireless IR Procedures", "General IR Procedures", "Informal Procedures", "No IR Procedures"]),
                    TemplateField(label="Forensic Capabilities", type=FieldType.SELECT, options=["Wireless Forensic Tools", "Basic Forensic Capability", "Limited Forensics", "No Forensic Capability"]),
                    TemplateField(label="Alerting & Notification Systems", type=FieldType.SELECT, options=["Real-time Alerting", "Periodic Alerts", "Manual Notifications", "No Alert System"]),
                    TemplateField(label="Compliance Monitoring", type=FieldType.SELECT, options=["Automated Compliance Checks", "Manual Compliance Review", "Basic Compliance", "No Compliance Monitoring"]),
                    TemplateField(label="Wireless Asset Management", type=FieldType.SELECT, options=["Comprehensive Asset Tracking", "Basic Asset Management", "Manual Tracking", "No Asset Management"]),
                    TemplateField(label="Security Policy Enforcement", type=FieldType.SELECT, options=["Automated Policy Enforcement", "Manual Policy Checks", "Basic Enforcement", "No Policy Enforcement"]),
                    TemplateField(label="Threat Intelligence Integration", type=FieldType.SELECT, options=["Integrated Threat Intel", "Basic Threat Feeds", "Manual Intel Review", "No Threat Intelligence"]),
                    TemplateField(label="Wireless Security Training", type=FieldType.SELECT, options=["Regular Security Training", "Annual Training", "Basic Training", "No Wireless Training"]),
                ],
                order=6
            )
        ],
        report_structure=[
            ReportSection(
                title="Wireless Security Assessment Executive Summary",
                content_template="Comprehensive overview of wireless network security posture, critical vulnerabilities, attack success rates, and strategic recommendations for wireless security enhancement.",
                order=1
            ),
            ReportSection(
                title="Wireless Infrastructure & Architecture Security Analysis",
                content_template="Detailed assessment of wireless infrastructure design, deployment security, access point configurations, and overall wireless architecture security.",
                order=2
            ),
            ReportSection(
                title="WiFi Security Configuration Assessment",
                content_template="Comprehensive analysis of WiFi security configurations, encryption standards, authentication mechanisms, and network security implementations.",
                order=3
            ),
            ReportSection(
                title="Wireless Penetration Testing Results",
                content_template="Results from active wireless security testing including attack success rates, exploitation techniques, and defensive capability assessment.",
                order=4
            ),
            ReportSection(
                title="Enterprise Wireless Security Evaluation",
                content_template="Assessment of enterprise wireless security controls including 802.1X implementation, RADIUS infrastructure, and advanced security features.",
                order=5
            ),
            ReportSection(
                title="Bluetooth & IoT Wireless Protocol Security",
                content_template="Security analysis of Bluetooth implementations, IoT wireless protocols, and alternative wireless technologies beyond traditional WiFi.",
                order=6
            ),
            ReportSection(
                title="Wireless Monitoring & Detection Capabilities",
                content_template="Evaluation of wireless security monitoring systems, threat detection capabilities, and incident response readiness for wireless security events.",
                order=7
            ),
            ReportSection(
                title="Wireless Security Enhancement Roadmap",
                content_template="Strategic recommendations for wireless security improvements including infrastructure hardening, policy enhancements, and monitoring system upgrades.",
                order=8
            )
        ]
    )
    
    # Additional 18 Assessment Templates to reach 25+ total
    physical_security_template = Template(
        name="Physical Security Assessment",
        description="Comprehensive physical security and facility penetration testing following industry standards",
        category="Physical Security",
        steps=[
            TemplateStep(
                name="Site Reconnaissance & Intelligence Gathering",
                description="Comprehensive physical location reconnaissance and intelligence collection",
                instructions="Conduct thorough reconnaissance of physical facilities, entry points, security controls, and surrounding environment. Use OSINT techniques and physical observation.",
                fields=[
                    TemplateField(label="Primary Facility Address", type=FieldType.TEXT, required=True, placeholder="Full address of target facility"),
                    TemplateField(label="Secondary Locations", type=FieldType.TEXTAREA, placeholder="Branch offices, parking structures, etc."),
                    TemplateField(label="Building Access Points", type=FieldType.NUMBER, placeholder="Total number of entrances/exits"),
                    TemplateField(label="Security Cameras Observed", type=FieldType.NUMBER, placeholder="Visible surveillance cameras"),
                    TemplateField(label="Security Guards Present", type=FieldType.SELECT, options=["24/7 Coverage", "Business Hours Only", "Intermittent", "None Observed"]),
                    TemplateField(label="Perimeter Security", type=FieldType.SELECT, options=["High Security Fence", "Standard Fence", "Wall/Barrier", "Natural Barriers", "Open Perimeter"]),
                    TemplateField(label="Visitor Management System", type=FieldType.SELECT, options=["Electronic Badge System", "Manual Sign-in", "Escort Required", "No Visible System"]),
                    TemplateField(label="Parking Security", type=FieldType.SELECT, options=["Gated/Controlled", "Badge Required", "Open Access", "Not Applicable"]),
                    TemplateField(label="Reconnaissance Notes", type=FieldType.TEXTAREA, placeholder="Detailed observations, security patterns, staff behavior"),
                ],
                order=1
            ),
            TemplateStep(
                name="Physical Access Control Testing",
                description="Comprehensive testing of physical access control mechanisms",
                instructions="Test various physical access controls including locks, card readers, biometric systems, and entry procedures. Document bypass techniques and vulnerabilities.",
                fields=[
                    TemplateField(label="Access Control Type", type=FieldType.SELECT, options=["RFID/Proximity Cards", "Magnetic Strip", "PIN/Keypad", "Biometric", "Key/Lock", "Multiple Systems"]),
                    TemplateField(label="Card Reader Bypass Successful", type=FieldType.CHECKBOX),
                    TemplateField(label="Lock Picking Attempted", type=FieldType.CHECKBOX),
                    TemplateField(label="Lock Picking Success Rate", type=FieldType.TEXT, placeholder="Percentage or fraction"),
                    TemplateField(label="Tailgating Successful", type=FieldType.CHECKBOX),
                    TemplateField(label="Badge Cloning Possible", type=FieldType.CHECKBOX),
                    TemplateField(label="Mantrap/Airlock Present", type=FieldType.CHECKBOX),
                    TemplateField(label="Emergency Exit Security", type=FieldType.SELECT, options=["Alarmed & Monitored", "Alarmed Only", "Unlocked", "Secured"]),
                    TemplateField(label="Unauthorized Areas Accessed", type=FieldType.TEXTAREA, placeholder="List areas accessed without authorization"),
                    TemplateField(label="Access Control Bypass Methods", type=FieldType.TEXTAREA, placeholder="Detailed bypass techniques used"),
                ],
                order=2
            ),
            TemplateStep(
                name="Social Engineering & Human Factor Testing",
                description="Human element security testing and social engineering assessment",
                instructions="Test employee security awareness, social engineering susceptibility, and human factor vulnerabilities in physical security.",
                fields=[
                    TemplateField(label="Pretexting Scenarios Used", type=FieldType.TEXTAREA, placeholder="Delivery person, contractor, IT support, etc."),
                    TemplateField(label="Employee Challenge Rate", type=FieldType.TEXT, placeholder="Percentage of employees who challenged unauthorized access"),
                    TemplateField(label="Uniform/Clothing Effectiveness", type=FieldType.SELECT, options=["Highly Effective", "Somewhat Effective", "Not Effective", "Not Tested"]),
                    TemplateField(label="Authority Exploitation", type=FieldType.CHECKBOX),
                    TemplateField(label="Information Gathering Success", type=FieldType.CHECKBOX),
                    TemplateField(label="USB Drop Test Executed", type=FieldType.CHECKBOX),
                    TemplateField(label="USB Drop Success Rate", type=FieldType.TEXT, placeholder="Devices plugged in / devices dropped"),
                    TemplateField(label="Dumpster Diving Results", type=FieldType.TEXTAREA, placeholder="Sensitive information found in trash"),
                    TemplateField(label="Social Engineering Findings", type=FieldType.TEXTAREA, placeholder="Detailed social engineering test results"),
                ],
                order=3
            ),
            TemplateStep(
                name="Surveillance & Detection Evasion",
                description="Surveillance system assessment and detection evasion testing",
                instructions="Assess surveillance coverage, blind spots, detection capabilities, and test evasion techniques.",
                fields=[
                    TemplateField(label="Camera Coverage Assessment", type=FieldType.SELECT, options=["Complete Coverage", "Good Coverage", "Moderate Coverage", "Poor Coverage"]),
                    TemplateField(label="Blind Spots Identified", type=FieldType.CHECKBOX),
                    TemplateField(label="Motion Detection Active", type=FieldType.CHECKBOX),
                    TemplateField(label="Night Vision Capability", type=FieldType.CHECKBOX),
                    TemplateField(label="Recording vs Live Monitoring", type=FieldType.SELECT, options=["Live Monitoring", "Recording Only", "Mixed", "Unknown"]),
                    TemplateField(label="Alarm System Integration", type=FieldType.CHECKBOX),
                    TemplateField(label="Detection Evasion Success", type=FieldType.CHECKBOX),
                    TemplateField(label="Surveillance Response Time", type=FieldType.TEXT, placeholder="Time to security response"),
                    TemplateField(label="Surveillance Findings", type=FieldType.TEXTAREA, placeholder="Blind spots, evasion techniques, system weaknesses"),
                ],
                order=4
            ),
            TemplateStep(
                name="Information Security in Physical Spaces",
                description="Assessment of information security in physical environment",
                instructions="Evaluate protection of sensitive information, workstation security, and data exposure in physical spaces.",
                fields=[
                    TemplateField(label="Clean Desk Policy Compliance", type=FieldType.SELECT, options=["Strictly Enforced", "Moderately Enforced", "Poorly Enforced", "Not Enforced"]),
                    TemplateField(label="Screen Privacy Protection", type=FieldType.SELECT, options=["Privacy Screens Used", "Positioning Awareness", "No Protection", "Mixed"]),
                    TemplateField(label="Unattended Workstations", type=FieldType.NUMBER, placeholder="Number of unlocked/unattended systems"),
                    TemplateField(label="Physical Document Security", type=FieldType.SELECT, options=["Locked Storage", "Open Storage", "Mixed", "No Documents Observed"]),
                    TemplateField(label="Sensitive Information Exposed", type=FieldType.CHECKBOX),
                    TemplateField(label="Server Room/IT Areas Security", type=FieldType.SELECT, options=["Highly Secured", "Moderately Secured", "Poorly Secured", "Not Accessible"]),
                    TemplateField(label="Network Infrastructure Exposure", type=FieldType.CHECKBOX),
                    TemplateField(label="Physical Information Security Findings", type=FieldType.TEXTAREA, placeholder="Exposed information, security gaps, recommendations"),
                ],
                order=5
            )
        ],
        report_structure=[
            ReportSection(
                title="Physical Security Assessment Summary",
                content_template="Comprehensive evaluation of physical security controls, access mechanisms, and human factor vulnerabilities. Assessment identifies critical physical security gaps and unauthorized access possibilities.",
                order=1
            ),
            ReportSection(
                title="Access Control & Perimeter Security Analysis",
                content_template="Detailed analysis of physical access control systems, perimeter security, and entry point vulnerabilities with specific bypass techniques tested.",
                order=2
            ),
            ReportSection(
                title="Human Factor & Social Engineering Results",
                content_template="Assessment of employee security awareness, social engineering susceptibility, and human element vulnerabilities in physical security.",
                order=3
            ),
            ReportSection(
                title="Surveillance & Detection Systems Evaluation",
                content_template="Analysis of surveillance coverage, detection capabilities, blind spots, and evasion possibilities.",
                order=4
            ),
            ReportSection(
                title="Physical Security Remediation Strategy",
                content_template="Prioritized physical security improvements, policy recommendations, and implementation roadmap for enhanced facility security.",
                order=5
            )
        ]
    )
    
    iot_security_template = Template(
        name="IoT Device Security Assessment",
        description="Comprehensive Internet of Things device security testing, firmware analysis, and ecosystem evaluation",
        category="IoT Security",
        steps=[
            TemplateStep(
                name="IoT Device Discovery & Inventory",
                description="Comprehensive IoT device enumeration and ecosystem mapping",
                instructions="Systematically discover and catalog all IoT devices in the environment using network scanning, protocol analysis, and physical inspection.",
                fields=[
                    TemplateField(label="Total IoT Devices Discovered", type=FieldType.NUMBER, placeholder="Number of unique IoT devices identified"),
                    TemplateField(label="Device Categories", type=FieldType.TEXTAREA, placeholder="Smart cameras, sensors, actuators, wearables, etc."),
                    TemplateField(label="Communication Protocols", type=FieldType.TEXTAREA, placeholder="WiFi, Zigbee, Z-Wave, LoRa, Bluetooth, etc."),
                    TemplateField(label="Device Manufacturers", type=FieldType.TEXTAREA, placeholder="List of device manufacturers identified"),
                    TemplateField(label="Firmware Versions Identified", type=FieldType.TEXTAREA, placeholder="Firmware versions for each device type"),
                    TemplateField(label="Default Credentials Discovered", type=FieldType.NUMBER, placeholder="Number of devices with default credentials"),
                    TemplateField(label="Unencrypted Communications", type=FieldType.CHECKBOX),
                    TemplateField(label="Unknown/Unidentified Devices", type=FieldType.NUMBER, placeholder="Devices that couldn't be properly identified"),
                    TemplateField(label="Device Inventory Details", type=FieldType.TEXTAREA, placeholder="Detailed device inventory with IPs, MACs, models"),
                ],
                order=1
            ),
            TemplateStep(
                name="Network Protocol & Communication Analysis",
                description="IoT network communication security assessment",
                instructions="Analyze IoT device network communications, protocol security, and data transmission patterns.",
                fields=[
                    TemplateField(label="Primary Communication Protocol", type=FieldType.SELECT, options=["WiFi", "Ethernet", "Zigbee", "Z-Wave", "LoRa", "Bluetooth", "Cellular", "Mixed"]),
                    TemplateField(label="Encryption in Transit", type=FieldType.SELECT, options=["Strong Encryption", "Weak Encryption", "No Encryption", "Mixed"]),
                    TemplateField(label="Certificate Validation", type=FieldType.SELECT, options=["Properly Implemented", "Weak Implementation", "Not Implemented"]),
                    TemplateField(label="Protocol Vulnerabilities", type=FieldType.CHECKBOX),
                    TemplateField(label="Man-in-the-Middle Possible", type=FieldType.CHECKBOX),
                    TemplateField(label="Replay Attack Vulnerable", type=FieldType.CHECKBOX),
                    TemplateField(label="Network Segmentation", type=FieldType.SELECT, options=["Properly Segmented", "Partially Segmented", "Not Segmented"]),
                    TemplateField(label="Cloud Service Integration", type=FieldType.SELECT, options=["Secure Integration", "Weak Integration", "Insecure Integration", "No Cloud"]),
                    TemplateField(label="Communication Analysis Results", type=FieldType.TEXTAREA, placeholder="Detailed protocol and communication security findings"),
                ],
                order=2
            ),
            TemplateStep(
                name="Device Authentication & Access Control",
                description="IoT device authentication and authorization security testing",
                instructions="Test device authentication mechanisms, access controls, and authorization bypass techniques.",
                fields=[
                    TemplateField(label="Authentication Method", type=FieldType.SELECT, options=["Username/Password", "Certificate-based", "Token-based", "Biometric", "None", "Multiple Methods"]),
                    TemplateField(label="Password Policy Strength", type=FieldType.SELECT, options=["Strong Policy", "Moderate Policy", "Weak Policy", "No Policy"]),
                    TemplateField(label="Multi-Factor Authentication", type=FieldType.SELECT, options=["Required", "Optional", "Not Available"]),
                    TemplateField(label="Session Management", type=FieldType.SELECT, options=["Secure", "Weak", "None"]),
                    TemplateField(label="Privilege Escalation Possible", type=FieldType.CHECKBOX),
                    TemplateField(label="Admin Interface Accessible", type=FieldType.CHECKBOX),
                    TemplateField(label="Debug Interfaces Exposed", type=FieldType.CHECKBOX),
                    TemplateField(label="Firmware Update Authentication", type=FieldType.SELECT, options=["Cryptographically Signed", "Checksum Only", "No Verification"]),
                    TemplateField(label="Access Control Findings", type=FieldType.TEXTAREA, placeholder="Authentication bypass techniques, weak controls identified"),
                ],
                order=3
            ),
            TemplateStep(
                name="Firmware Security Analysis",
                description="Comprehensive IoT firmware reverse engineering and security analysis",
                instructions="Extract and analyze device firmware for security vulnerabilities, backdoors, and hardcoded credentials.",
                fields=[
                    TemplateField(label="Firmware Extraction Method", type=FieldType.SELECT, options=["JTAG/SWD", "UART", "SPI Flash", "OTA Download", "Physical Chip Reading", "Not Possible"]),
                    TemplateField(label="Firmware Successfully Extracted", type=FieldType.CHECKBOX),
                    TemplateField(label="Firmware Encryption", type=FieldType.SELECT, options=["Strongly Encrypted", "Weakly Encrypted", "Obfuscated", "Unencrypted"]),
                    TemplateField(label="Hardcoded Credentials Found", type=FieldType.NUMBER, placeholder="Number of hardcoded credential instances"),
                    TemplateField(label="Cryptographic Keys Exposed", type=FieldType.CHECKBOX),
                    TemplateField(label="Buffer Overflow Vulnerabilities", type=FieldType.NUMBER, placeholder="Number of potential buffer overflows"),
                    TemplateField(label="Backdoor Functions Discovered", type=FieldType.CHECKBOX),
                    TemplateField(label="Code Quality Assessment", type=FieldType.SELECT, options=["High Quality", "Moderate Quality", "Poor Quality"]),
                    TemplateField(label="Third-Party Components", type=FieldType.TEXTAREA, placeholder="Vulnerable third-party libraries/components identified"),
                    TemplateField(label="Firmware Analysis Summary", type=FieldType.TEXTAREA, placeholder="Detailed firmware security analysis results"),
                ],
                order=4
            ),
            TemplateStep(
                name="Physical Hardware Security Assessment",
                description="Physical IoT device security and hardware vulnerability testing",
                instructions="Assess physical security of IoT devices including debug interfaces, tamper resistance, and hardware-based attacks.",
                fields=[
                    TemplateField(label="Device Enclosure Security", type=FieldType.SELECT, options=["Tamper-Evident", "Tamper-Resistant", "Standard Case", "Easily Opened"]),
                    TemplateField(label="Debug Interfaces Present", type=FieldType.SELECT, options=["JTAG", "UART", "SWD", "Multiple", "None Visible"]),
                    TemplateField(label="Debug Interface Protection", type=FieldType.SELECT, options=["Disabled", "Password Protected", "Fused", "Unprotected"]),
                    TemplateField(label="Secure Boot Implementation", type=FieldType.SELECT, options=["Implemented", "Partial", "Bypassable", "Not Implemented"]),
                    TemplateField(label="Hardware Security Module", type=FieldType.SELECT, options=["Present", "Not Present", "Unknown"]),
                    TemplateField(label="Side-Channel Attack Resistance", type=FieldType.SELECT, options=["Resistant", "Partially Resistant", "Vulnerable", "Not Tested"]),
                    TemplateField(label="Physical Tampering Detection", type=FieldType.SELECT, options=["Active Protection", "Logging Only", "None"]),
                    TemplateField(label="Hardware Security Findings", type=FieldType.TEXTAREA, placeholder="Physical security assessment results and vulnerabilities"),
                ],
                order=5
            )
        ],
        report_structure=[
            ReportSection(
                title="IoT Security Ecosystem Overview",
                content_template="Comprehensive assessment of IoT device ecosystem including device inventory, communication protocols, and overall security posture.",
                order=1
            ),
            ReportSection(
                title="Network Communication Security Analysis",
                content_template="Detailed analysis of IoT device communications, protocol security, encryption implementation, and network-based vulnerabilities.",
                order=2
            ),
            ReportSection(
                title="Device Authentication & Access Control Assessment",
                content_template="Evaluation of IoT device authentication mechanisms, session management, and access control vulnerabilities.",
                order=3
            ),
            ReportSection(
                title="Firmware Security Analysis Results",
                content_template="Comprehensive firmware reverse engineering results including hardcoded credentials, cryptographic vulnerabilities, and code quality assessment.",
                order=4
            ),
            ReportSection(
                title="Physical Hardware Security Evaluation",
                content_template="Physical device security assessment including debug interface analysis, tamper resistance, and hardware-based attack vectors.",
                order=5
            ),
            ReportSection(
                title="IoT Security Remediation Roadmap",
                content_template="Prioritized IoT security improvements including device replacement recommendations, network segmentation, and security policy updates.",
                order=6
            )
        ]
    )
    
    malware_analysis_template = Template(
        name="Malware Analysis & Reverse Engineering",
        description="Comprehensive malware analysis, reverse engineering, and threat assessment following NIST standards",
        category="Malware Analysis",
        steps=[
            TemplateStep(
                name="Malware Sample Acquisition & Triage",
                description="Malware sample collection, validation, and initial triage assessment",
                instructions="Safely acquire malware samples, validate integrity, and perform initial triage to classify threat level and analysis approach.",
                fields=[
                    TemplateField(label="Primary Sample Hash (SHA-256)", type=FieldType.TEXT, required=True, placeholder="SHA-256 hash of primary malware sample"),
                    TemplateField(label="Additional Sample Hashes", type=FieldType.TEXTAREA, placeholder="MD5, SHA-1, and other related sample hashes"),
                    TemplateField(label="Sample Source", type=FieldType.SELECT, options=["Incident Response", "Threat Intelligence", "Honeypot", "Email Attachment", "Web Download", "Network Capture", "Unknown"]),
                    TemplateField(label="File Size (bytes)", type=FieldType.NUMBER, placeholder="File size in bytes"),
                    TemplateField(label="File Type", type=FieldType.SELECT, options=["PE Executable", "DLL Library", "ELF Binary", "Mach-O Binary", "Script (JS/VBS/PS1)", "Office Document", "PDF", "Archive", "Other"]),
                    TemplateField(label="Submission Date", type=FieldType.TEXT, placeholder="When sample was first identified"),
                    TemplateField(label="Initial Risk Assessment", type=FieldType.SELECT, options=["Critical", "High", "Medium", "Low", "Unknown"]),
                    TemplateField(label="Antivirus Detection Rate", type=FieldType.TEXT, placeholder="X/Y engines detect (e.g., 45/70)"),
                    TemplateField(label="Family Classification", type=FieldType.TEXT, placeholder="Malware family if known"),
                    TemplateField(label="Sample Acquisition Notes", type=FieldType.TEXTAREA, placeholder="Collection context, related indicators, source details"),
                ],
                order=1
            ),
            TemplateStep(
                name="Static Analysis & Code Examination",
                description="Comprehensive static analysis without malware execution",
                instructions="Perform detailed static analysis including string extraction, API analysis, code structure examination, and cryptographic analysis.",
                fields=[
                    TemplateField(label="Packer/Obfuscation Detected", type=FieldType.SELECT, options=["UPX", "ASPack", "Themida", "VMProtect", "Custom Packer", "Obfuscated", "None Detected"]),
                    TemplateField(label="Unpacking Successful", type=FieldType.CHECKBOX),
                    TemplateField(label="Compilation Timestamp", type=FieldType.TEXT, placeholder="PE compilation date if available"),
                    TemplateField(label="Programming Language", type=FieldType.SELECT, options=["C/C++", "C#/.NET", "Delphi", "Python", "JavaScript", "PowerShell", "Visual Basic", "Assembly", "Mixed", "Unknown"]),
                    TemplateField(label="Embedded Strings Analysis", type=FieldType.TEXTAREA, placeholder="Significant strings: URLs, IPs, file paths, registry keys"),
                    TemplateField(label="API Imports Analysis", type=FieldType.TEXTAREA, placeholder="Key API functions and libraries imported"),
                    TemplateField(label="Cryptographic Functions", type=FieldType.TEXTAREA, placeholder="Encryption/hashing functions identified"),
                    TemplateField(label="Network Indicators", type=FieldType.TEXTAREA, placeholder="Hardcoded IPs, domains, URLs found in binary"),
                    TemplateField(label="Anti-Analysis Techniques", type=FieldType.TEXTAREA, placeholder="Anti-debugging, anti-VM, sandbox evasion techniques"),
                    TemplateField(label="Static Analysis Summary", type=FieldType.TEXTAREA, placeholder="Key findings from static analysis"),
                ],
                order=2
            ),
            TemplateStep(
                name="Dynamic Behavior Analysis",
                description="Controlled malware execution and behavioral monitoring",
                instructions="Execute malware in isolated sandbox environment while monitoring system behavior, network communications, and malicious activities.",
                fields=[
                    TemplateField(label="Sandbox Environment", type=FieldType.SELECT, options=["VMware", "VirtualBox", "Hyper-V", "Cuckoo Sandbox", "Commercial Sandbox", "Bare Metal"]),
                    TemplateField(label="Operating System", type=FieldType.SELECT, options=["Windows 10", "Windows 11", "Windows 7", "Linux", "macOS", "Multiple OS"]),
                    TemplateField(label="Execution Successful", type=FieldType.CHECKBOX),
                    TemplateField(label="Network Communications", type=FieldType.TEXTAREA, placeholder="C2 servers, DNS queries, HTTP/HTTPS traffic"),
                    TemplateField(label="File System Modifications", type=FieldType.TEXTAREA, placeholder="Files created, modified, deleted"),
                    TemplateField(label="Registry Changes", type=FieldType.TEXTAREA, placeholder="Registry keys created, modified, deleted"),
                    TemplateField(label="Process Behavior", type=FieldType.TEXTAREA, placeholder="Child processes, injection, hollowing"),
                    TemplateField(label="Persistence Mechanisms", type=FieldType.TEXTAREA, placeholder="Registry run keys, services, scheduled tasks"),
                    TemplateField(label="Privilege Escalation", type=FieldType.CHECKBOX),
                    TemplateField(label="Data Exfiltration Observed", type=FieldType.CHECKBOX),
                    TemplateField(label="Command & Control Activity", type=FieldType.TEXTAREA, placeholder="C2 communication patterns, protocols, commands"),
                    TemplateField(label="Payload Delivery", type=FieldType.TEXTAREA, placeholder="Additional malware downloaded or executed"),
                ],
                order=3
            ),
            TemplateStep(
                name="Network Traffic & Communication Analysis",
                description="Network behavior and command & control communication analysis",
                instructions="Analyze network traffic patterns, C2 communications, and network-based indicators of compromise.",
                fields=[
                    TemplateField(label="C2 Servers Identified", type=FieldType.TEXTAREA, placeholder="Command and control server IPs/domains"),
                    TemplateField(label="Communication Protocol", type=FieldType.SELECT, options=["HTTP", "HTTPS", "DNS", "TCP Raw", "UDP", "IRC", "P2P", "Custom Protocol", "Multiple"]),
                    TemplateField(label="Encryption Used", type=FieldType.SELECT, options=["None", "Base64", "XOR", "AES", "RSA", "Custom", "Unknown"]),
                    TemplateField(label="User-Agent Strings", type=FieldType.TEXTAREA, placeholder="HTTP User-Agent strings used"),
                    TemplateField(label="DNS Queries", type=FieldType.TEXTAREA, placeholder="DNS queries made by malware"),
                    TemplateField(label="Network IOCs", type=FieldType.TEXTAREA, placeholder="IPs, domains, URLs for blocking"),
                    TemplateField(label="Communication Frequency", type=FieldType.TEXT, placeholder="Beacon interval or communication pattern"),
                    TemplateField(label="Data Exfiltration Methods", type=FieldType.TEXTAREA, placeholder="How data is stolen and transmitted"),
                    TemplateField(label="Network Evasion Techniques", type=FieldType.TEXTAREA, placeholder="Domain generation, fast flux, tunneling"),
                    TemplateField(label="Network Analysis Summary", type=FieldType.TEXTAREA, placeholder="Network behavior and communication analysis results"),
                ],
                order=4
            ),
            TemplateStep(
                name="Reverse Engineering & Code Analysis",
                description="Advanced reverse engineering and malware code analysis",
                instructions="Perform detailed reverse engineering using disassemblers and debuggers to understand malware functionality and extract IOCs.",
                fields=[
                    TemplateField(label="Disassembly Tool Used", type=FieldType.SELECT, options=["IDA Pro", "Ghidra", "Radare2", "x64dbg", "OllyDbg", "Binary Ninja", "Multiple Tools"]),
                    TemplateField(label="Main Function Analysis", type=FieldType.TEXTAREA, placeholder="Primary malware functionality and logic flow"),
                    TemplateField(label="Encryption/Decryption Routines", type=FieldType.TEXTAREA, placeholder="Cryptographic implementations found"),
                    TemplateField(label="String Decryption", type=FieldType.TEXTAREA, placeholder="Method for decrypting obfuscated strings"),
                    TemplateField(label="Configuration Extraction", type=FieldType.TEXTAREA, placeholder="Malware configuration parameters"),
                    TemplateField(label="Anti-Analysis Bypass", type=FieldType.TEXTAREA, placeholder="Techniques used to bypass anti-analysis"),
                    TemplateField(label="Vulnerability Exploits", type=FieldType.TEXTAREA, placeholder="CVEs or exploits leveraged by malware"),
                    TemplateField(label="Code Similarities", type=FieldType.TEXTAREA, placeholder="Code reuse, shared libraries, family connections"),
                    TemplateField(label="Attribution Indicators", type=FieldType.TEXTAREA, placeholder="Coding patterns, language artifacts, TTP similarities"),
                    TemplateField(label="Reverse Engineering Summary", type=FieldType.TEXTAREA, placeholder="Detailed technical analysis and findings"),
                ],
                order=5
            )
        ],
        report_structure=[
            ReportSection(
                title="Malware Analysis Executive Summary",
                content_template="High-level assessment of malware capabilities, threat level, and business impact with key findings and recommendations.",
                order=1
            ),
            ReportSection(
                title="Technical Analysis & Reverse Engineering",
                content_template="Comprehensive technical analysis including static analysis, dynamic behavior, and reverse engineering findings.",
                order=2
            ),
            ReportSection(
                title="Behavioral Analysis & Attack Chain",
                content_template="Detailed malware behavior analysis including attack methodology, persistence mechanisms, and payload activities.",
                order=3
            ),
            ReportSection(
                title="Network Communication & C2 Analysis",
                content_template="Analysis of network communications, command and control infrastructure, and data exfiltration methods.",
                order=4
            ),
            ReportSection(
                title="Indicators of Compromise (IOCs)",
                content_template="Comprehensive IOC list including file hashes, network indicators, registry keys, and behavioral indicators for detection and blocking.",
                order=5
            ),
            ReportSection(
                title="Detection & Mitigation Recommendations",
                content_template="Detection strategies, prevention measures, incident response actions, and long-term security improvements.",
                order=6
            )
        ]
    )
    
    osint_template = Template(
        name="OSINT (Open Source Intelligence)",
        description="Comprehensive open source intelligence gathering, analysis, and threat landscape assessment",
        category="OSINT",
        steps=[
            TemplateStep(
                name="Target Organization Profiling",
                description="Comprehensive organizational intelligence gathering and profiling",
                instructions="Conduct systematic intelligence collection about the target organization using passive reconnaissance techniques and open sources.",
                fields=[
                    TemplateField(label="Primary Target Organization", type=FieldType.TEXT, required=True, placeholder="Full legal organization name"),
                    TemplateField(label="Industry Sector", type=FieldType.TEXT, placeholder="Healthcare, Finance, Technology, etc."),
                    TemplateField(label="Organization Size", type=FieldType.SELECT, options=["< 50 employees", "50-250", "250-1000", "1000-5000", "5000+", "Unknown"]),
                    TemplateField(label="Geographic Locations", type=FieldType.TEXTAREA, placeholder="Physical office locations, subsidiaries, data centers"),
                    TemplateField(label="Domain Names Discovered", type=FieldType.TEXTAREA, placeholder="Primary and secondary domains owned by organization"),
                    TemplateField(label="Subsidiary Organizations", type=FieldType.TEXTAREA, placeholder="Related companies, acquisitions, partnerships"),
                    TemplateField(label="Business Registration Details", type=FieldType.TEXTAREA, placeholder="Legal registrations, business licenses, regulatory filings"),
                    TemplateField(label="Financial Information", type=FieldType.TEXTAREA, placeholder="Public financial data, funding, acquisitions"),
                    TemplateField(label="Strategic Partnerships", type=FieldType.TEXTAREA, placeholder="Key business partners, vendors, customers"),
                    TemplateField(label="Organizational Intelligence Summary", type=FieldType.TEXTAREA, placeholder="Key organizational insights and intelligence gathered"),
                ],
                order=1
            ),
            TemplateStep(
                name="Personnel & Human Intelligence",
                description="Employee profiling and human intelligence gathering",
                instructions="Identify and profile key personnel, organizational structure, and human intelligence vectors.",
                fields=[
                    TemplateField(label="Executive Leadership Identified", type=FieldType.NUMBER, placeholder="Number of C-level executives identified"),
                    TemplateField(label="IT/Security Personnel Count", type=FieldType.NUMBER, placeholder="IT and security staff identified"),
                    TemplateField(label="Total Employee Profiles", type=FieldType.NUMBER, placeholder="Total employees with public profiles"),
                    TemplateField(label="Social Media Presence", type=FieldType.SELECT, options=["Extensive", "Moderate", "Limited", "Minimal"]),
                    TemplateField(label="LinkedIn Intelligence", type=FieldType.TEXTAREA, placeholder="Employee roles, departments, org structure from LinkedIn"),
                    TemplateField(label="Key Personnel Details", type=FieldType.TEXTAREA, placeholder="Names, roles, contact info of key personnel"),
                    TemplateField(label="Employee Email Patterns", type=FieldType.TEXT, placeholder="firstname.lastname@company.com"),
                    TemplateField(label="Former Employee Information", type=FieldType.TEXTAREA, placeholder="Ex-employees with potential insider knowledge"),
                    TemplateField(label="Conference/Event Speakers", type=FieldType.TEXTAREA, placeholder="Employees speaking at conferences, revealing technical details"),
                    TemplateField(label="Personal Information Exposure", type=FieldType.CHECKBOX),
                ],
                order=2
            ),
            TemplateStep(
                name="Technical Infrastructure Intelligence",
                description="Technology stack and infrastructure intelligence gathering",
                instructions="Identify technical infrastructure, technology stack, and IT architecture through passive reconnaissance.",
                fields=[
                    TemplateField(label="Web Technologies Identified", type=FieldType.TEXTAREA, placeholder="Web servers, frameworks, CMS, analytics tools"),
                    TemplateField(label="Cloud Infrastructure", type=FieldType.SELECT, options=["AWS", "Azure", "Google Cloud", "Multi-Cloud", "On-Premise", "Hybrid", "Unknown"]),
                    TemplateField(label="Email Infrastructure", type=FieldType.TEXT, placeholder="Office 365, Gmail, Exchange, etc."),
                    TemplateField(label="DNS Information", type=FieldType.TEXTAREA, placeholder="DNS records, subdomains, mail servers"),
                    TemplateField(label="SSL/TLS Certificate Details", type=FieldType.TEXTAREA, placeholder="Certificate authorities, expiration dates, SANs"),
                    TemplateField(label="Network Ranges Identified", type=FieldType.TEXTAREA, placeholder="IP ranges, ASN information, hosting providers"),
                    TemplateField(label="Third-Party Services", type=FieldType.TEXTAREA, placeholder="SaaS tools, vendors, integrations identified"),
                    TemplateField(label="Mobile Applications", type=FieldType.TEXTAREA, placeholder="Mobile apps published by organization"),
                    TemplateField(label="Job Postings Intelligence", type=FieldType.TEXTAREA, placeholder="Technology requirements from job listings"),
                    TemplateField(label="Technical Infrastructure Summary", type=FieldType.TEXTAREA, placeholder="Overall technical architecture insights"),
                ],
                order=3
            ),
            TemplateStep(
                name="Digital Footprint & Data Exposure Analysis",
                description="Comprehensive digital presence and information leakage assessment",
                instructions="Analyze digital footprint across various platforms, search for data breaches, and identify information exposure.",
                fields=[
                    TemplateField(label="Search Engine Intelligence", type=FieldType.TEXTAREA, placeholder="Sensitive information found via Google, Bing, etc."),
                    TemplateField(label="Social Media Exposure", type=FieldType.TEXTAREA, placeholder="Corporate and employee social media intelligence"),
                    TemplateField(label="Code Repository Exposure", type=FieldType.TEXTAREA, placeholder="GitHub, GitLab, Bitbucket repositories and exposed code"),
                    TemplateField(label="Data Breaches Identified", type=FieldType.TEXTAREA, placeholder="Historical breaches involving organization or employees"),
                    TemplateField(label="Paste Site Intelligence", type=FieldType.TEXTAREA, placeholder="Pastebin, GitHub Gists, paste sites with exposed data"),
                    TemplateField(label="Document Leakage", type=FieldType.TEXTAREA, placeholder="Exposed PDFs, documents, presentations"),
                    TemplateField(label="Image Metadata Intelligence", type=FieldType.TEXTAREA, placeholder="EXIF data, location information from public images"),
                    TemplateField(label="Dark Web Mentions", type=FieldType.TEXTAREA, placeholder="Organization mentions on dark web forums/markets"),
                    TemplateField(label="Wayback Machine Intelligence", type=FieldType.TEXTAREA, placeholder="Historical website data and changes"),
                    TemplateField(label="Digital Footprint Risk Level", type=FieldType.SELECT, options=["Critical", "High", "Medium", "Low"]),
                ],
                order=4
            ),
            TemplateStep(
                name="Threat Intelligence & Attack Surface Analysis",
                description="Threat landscape analysis and attack surface mapping",
                instructions="Correlate gathered intelligence to identify potential attack vectors, threats, and security risks.",
                fields=[
                    TemplateField(label="Primary Attack Vectors Identified", type=FieldType.TEXTAREA, placeholder="Most likely attack methods based on OSINT"),
                    TemplateField(label="Phishing Target Recommendations", type=FieldType.TEXTAREA, placeholder="High-value targets for social engineering"),
                    TemplateField(label="Credential Stuffing Opportunities", type=FieldType.TEXTAREA, placeholder="Exposed credentials suitable for credential stuffing"),
                    TemplateField(label="Supply Chain Risk Assessment", type=FieldType.TEXTAREA, placeholder="Third-party risks identified through OSINT"),
                    TemplateField(label="Brand Impersonation Risk", type=FieldType.SELECT, options=["High Risk", "Medium Risk", "Low Risk"]),
                    TemplateField(label="Regulatory Compliance Exposure", type=FieldType.TEXTAREA, placeholder="Compliance-related information exposure"),
                    TemplateField(label="Competitive Intelligence Value", type=FieldType.SELECT, options=["High Value", "Medium Value", "Low Value"]),
                    TemplateField(label="Real-time Threat Indicators", type=FieldType.TEXTAREA, placeholder="IOCs, domains, IPs related to threats against organization"),
                    TemplateField(label="Attack Surface Summary", type=FieldType.TEXTAREA, placeholder="Comprehensive attack surface analysis"),
                ],
                order=5
            )
        ],
        report_structure=[
            ReportSection(
                title="OSINT Intelligence Executive Summary",
                content_template="High-level summary of intelligence gathered, key findings, and strategic security implications for the organization.",
                order=1
            ),
            ReportSection(
                title="Organizational Intelligence Profile",
                content_template="Comprehensive organizational profiling including corporate structure, personnel, and business intelligence gathered through OSINT.",
                order=2
            ),
            ReportSection(
                title="Technical Infrastructure Intelligence",
                content_template="Detailed technical intelligence including technology stack, infrastructure, and IT architecture insights.",
                order=3
            ),
            ReportSection(
                title="Digital Footprint & Exposure Analysis",
                content_template="Analysis of digital presence, information leakage, data breaches, and exposure across various online platforms.",
                order=4
            ),
            ReportSection(
                title="Threat Landscape & Attack Surface Assessment",
                content_template="Threat intelligence correlation, attack vector identification, and attack surface mapping based on OSINT findings.",
                order=5
            ),
            ReportSection(
                title="OSINT-Based Security Recommendations",
                content_template="Strategic recommendations for reducing digital exposure, improving security posture, and mitigating OSINT-identified risks.",
                order=6
            )
        ]
    )
    
    forensics_template = Template(
        name="Digital Forensics Investigation",
        description="Comprehensive digital forensics investigation following NIST SP 800-86 guidelines and legal standards",
        category="Digital Forensics",
        steps=[
            TemplateStep(
                name="Case Initialization & Evidence Identification",
                description="Investigation planning, scope definition, and evidence source identification",
                instructions="Establish investigation parameters, legal requirements, and systematically identify all potential evidence sources.",
                fields=[
                    TemplateField(label="Case Number/ID", type=FieldType.TEXT, required=True, placeholder="Unique case identifier"),
                    TemplateField(label="Investigation Type", type=FieldType.SELECT, options=["Incident Response", "Criminal Investigation", "Internal Investigation", "Compliance Audit", "Civil Litigation", "Data Breach"]),
                    TemplateField(label="Legal Authority", type=FieldType.SELECT, options=["Court Warrant", "Search Warrant", "Consent", "Internal Policy", "Regulatory Requirement", "Emergency"]),
                    TemplateField(label="Investigation Scope", type=FieldType.TEXTAREA, placeholder="Specific systems, timeframes, and data types in scope"),
                    TemplateField(label="Evidence Sources Identified", type=FieldType.TEXTAREA, placeholder="Computers, servers, mobile devices, cloud services, network logs"),
                    TemplateField(label="Key Personnel Interviews", type=FieldType.TEXTAREA, placeholder="Witnesses, system administrators, users to be interviewed"),
                    TemplateField(label="Timeline of Interest", type=FieldType.TEXT, placeholder="Investigation timeframe (start - end dates)"),
                    TemplateField(label="Preservation Notices Issued", type=FieldType.CHECKBOX),
                    TemplateField(label="Legal Counsel Consulted", type=FieldType.CHECKBOX),
                    TemplateField(label="Investigation Planning Notes", type=FieldType.TEXTAREA, placeholder="Initial case assessment and investigation strategy"),
                ],
                order=1
            ),
            TemplateStep(
                name="Evidence Collection & Preservation",
                description="Forensically sound evidence acquisition and chain of custody management",
                instructions="Collect digital evidence using forensically sound methods while maintaining legal chain of custody requirements.",
                fields=[
                    TemplateField(label="Collection Method", type=FieldType.SELECT, options=["Physical Imaging", "Logical Imaging", "Live Response", "Network Capture", "Cloud Acquisition", "Mobile Extraction"]),
                    TemplateField(label="Imaging Tools Used", type=FieldType.TEXTAREA, placeholder="FTK Imager, dd, Cellebrite, EnCase, etc."),
                    TemplateField(label="Write Blockers Used", type=FieldType.CHECKBOX),
                    TemplateField(label="Hash Algorithms Applied", type=FieldType.SELECT, options=["MD5", "SHA-1", "SHA-256", "Multiple Hashes"]),
                    TemplateField(label="Images Successfully Created", type=FieldType.NUMBER, placeholder="Number of forensic images created"),
                    TemplateField(label="Chain of Custody Maintained", type=FieldType.CHECKBOX),
                    TemplateField(label="Evidence Integrity Verified", type=FieldType.SELECT, options=["Fully Verified", "Partially Verified", "Verification Failed", "Verification Pending"]),
                    TemplateField(label="Live System Analysis", type=FieldType.CHECKBOX),
                    TemplateField(label="Volatile Data Captured", type=FieldType.TEXTAREA, placeholder="RAM, running processes, network connections"),
                    TemplateField(label="Collection Challenges", type=FieldType.TEXTAREA, placeholder="Encryption, remote systems, damaged media"),
                    TemplateField(label="Evidence Storage Location", type=FieldType.TEXT, placeholder="Secure evidence storage facility/system"),
                ],
                order=2
            ),
            TemplateStep(
                name="Digital Evidence Examination & Analysis",
                description="Comprehensive examination and analysis of acquired digital evidence",
                instructions="Systematically examine digital evidence to identify, extract, and analyze relevant artifacts and data.",
                fields=[
                    TemplateField(label="Forensic Tools Used", type=FieldType.TEXTAREA, placeholder="EnCase, FTK, Autopsy, X-Ways, Volatility"),
                    TemplateField(label="File System Analysis", type=FieldType.TEXTAREA, placeholder="File system type, structure, deleted files, slack space"),
                    TemplateField(label="Deleted Files Recovered", type=FieldType.NUMBER, placeholder="Number of deleted files recovered"),
                    TemplateField(label="Registry Analysis", type=FieldType.TEXTAREA, placeholder="Windows registry artifacts, user activity, system configuration"),
                    TemplateField(label="Browser Artifacts", type=FieldType.TEXTAREA, placeholder="History, cookies, downloads, cache analysis"),
                    TemplateField(label="Email Analysis", type=FieldType.TEXTAREA, placeholder="PST/OST files, webmail, deleted emails"),
                    TemplateField(label="Database Analysis", type=FieldType.TEXTAREA, placeholder="Database files, queries, deleted records"),
                    TemplateField(label="Multimedia Analysis", type=FieldType.TEXTAREA, placeholder="Images, videos, metadata analysis"),
                    TemplateField(label="Encryption Encountered", type=FieldType.SELECT, options=["None", "File-level", "Disk-level", "Database", "Multiple Types"]),
                    TemplateField(label="Password Cracking Attempts", type=FieldType.TEXTAREA, placeholder="Methods used, success rate, time required"),
                    TemplateField(label="Steganography Detection", type=FieldType.CHECKBOX),
                    TemplateField(label="Anti-Forensics Techniques", type=FieldType.TEXTAREA, placeholder="Evidence of tampering, wiping, or obfuscation"),
                ],
                order=3
            ),
            TemplateStep(
                name="Timeline Reconstruction & Correlation",
                description="Chronological event reconstruction and cross-evidence correlation analysis",
                instructions="Create detailed timeline of events and correlate evidence across multiple sources to reconstruct the sequence of activities.",
                fields=[
                    TemplateField(label="Timeline Creation Method", type=FieldType.SELECT, options=["Automated Tools", "Manual Analysis", "Hybrid Approach"]),
                    TemplateField(label="Timeline Scope", type=FieldType.TEXT, placeholder="Date range covered by timeline analysis"),
                    TemplateField(label="Key Events Identified", type=FieldType.NUMBER, placeholder="Number of significant timeline events"),
                    TemplateField(label="File System Timeline", type=FieldType.TEXTAREA, placeholder="File creation, modification, access times"),
                    TemplateField(label="Network Activity Timeline", type=FieldType.TEXTAREA, placeholder="Network connections, data transfers, remote access"),
                    TemplateField(label="User Activity Timeline", type=FieldType.TEXTAREA, placeholder="Logins, logouts, application usage, document access"),
                    TemplateField(label="System Events Timeline", type=FieldType.TEXTAREA, placeholder="System boots, shutdowns, configuration changes"),
                    TemplateField(label="External Evidence Correlation", type=FieldType.TEXTAREA, placeholder="Physical logs, witness statements, external systems"),
                    TemplateField(label="Timeline Gaps Identified", type=FieldType.TEXTAREA, placeholder="Missing time periods, potential data destruction"),
                    TemplateField(label="Evidence Correlation Analysis", type=FieldType.TEXTAREA, placeholder="Cross-system correlation and validation"),
                ],
                order=4
            ),
            TemplateStep(
                name="Artifact Analysis & Expert Interpretation",
                description="Expert analysis of digital artifacts and interpretation of findings",
                instructions="Perform expert-level analysis of digital artifacts, interpret findings in context, and draw investigative conclusions.",
                fields=[
                    TemplateField(label="Malware Analysis Performed", type=FieldType.CHECKBOX),
                    TemplateField(label="Malware Artifacts Found", type=FieldType.TEXTAREA, placeholder="Malicious files, persistence mechanisms, C2 communications"),
                    TemplateField(label="Data Exfiltration Evidence", type=FieldType.TEXTAREA, placeholder="Large file transfers, unusual network activity, unauthorized access"),
                    TemplateField(label="Intellectual Property Theft", type=FieldType.CHECKBOX),
                    TemplateField(label="Insider Threat Indicators", type=FieldType.TEXTAREA, placeholder="Unauthorized access, data copying, policy violations"),
                    TemplateField(label="External Attack Evidence", type=FieldType.TEXTAREA, placeholder="Remote access tools, lateral movement, privilege escalation"),
                    TemplateField(label="Data Destruction Attempts", type=FieldType.TEXTAREA, placeholder="File deletion, disk wiping, log clearing"),
                    TemplateField(label="Privacy Violations", type=FieldType.TEXTAREA, placeholder="PII exposure, unauthorized data access"),
                    TemplateField(label="Compliance Violations", type=FieldType.TEXTAREA, placeholder="Regulatory non-compliance, policy violations"),
                    TemplateField(label="Attribution Analysis", type=FieldType.TEXTAREA, placeholder="User attribution, source identification, actor profiling"),
                    TemplateField(label="Expert Opinion Confidence", type=FieldType.SELECT, options=["High Confidence", "Medium Confidence", "Low Confidence", "Inconclusive"]),
                ],
                order=5
            )
        ],
        report_structure=[
            ReportSection(
                title="Forensic Investigation Executive Summary",
                content_template="High-level summary of investigation scope, methodology, key findings, and conclusions for executive and legal audiences.",
                order=1
            ),
            ReportSection(
                title="Investigation Methodology & Evidence Handling",
                content_template="Detailed methodology, evidence collection procedures, chain of custody, and forensic tool validation to establish legal admissibility.",
                order=2
            ),
            ReportSection(
                title="Digital Evidence Analysis Results",
                content_template="Comprehensive analysis results including file system examination, artifact analysis, and recovered digital evidence.",
                order=3
            ),
            ReportSection(
                title="Timeline Reconstruction & Event Correlation",
                content_template="Detailed chronological reconstruction of events with supporting evidence and cross-system correlation analysis.",
                order=4
            ),
            ReportSection(
                title="Expert Analysis & Interpretation",
                content_template="Expert interpretation of digital artifacts, evidence correlation, and investigative conclusions with confidence assessments.",
                order=5
            ),
            ReportSection(
                title="Legal Considerations & Recommendations",
                content_template="Legal admissibility considerations, evidence preservation recommendations, and next steps for legal proceedings.",
                order=6
            )
        ]
    )
    
    compliance_template = Template(
        name="Compliance Assessment (PCI DSS / HIPAA / SOC2)",
        description="Comprehensive compliance assessment for regulatory standards including framework analysis, control evaluation, and gap remediation following industry best practices",
        category="Compliance",
        steps=[
            TemplateStep(
                name="Compliance Framework & Scope Definition",
                description="Comprehensive compliance framework identification and assessment scope establishment",
                instructions="Identify applicable compliance frameworks, define assessment scope, establish business context, and determine regulatory requirements for the organization.",
                fields=[
                    TemplateField(label="Primary Compliance Framework", type=FieldType.SELECT, options=["PCI DSS", "HIPAA", "SOC 2 Type I", "SOC 2 Type II", "ISO 27001", "NIST CSF", "GDPR", "CCPA", "FedRAMP", "SOX"], required=True),
                    TemplateField(label="Additional Compliance Requirements", type=FieldType.TEXTAREA, placeholder="Secondary frameworks, industry standards, contractual requirements"),
                    TemplateField(label="Business Type & Industry", type=FieldType.SELECT, options=["Healthcare", "Financial Services", "E-commerce/Retail", "Technology/SaaS", "Government/Public", "Education", "Manufacturing", "Other"]),
                    TemplateField(label="Organizational Size", type=FieldType.SELECT, options=["Small (<50 employees)", "Medium (50-500 employees)", "Large (500-5000 employees)", "Enterprise (5000+ employees)"]),
                    TemplateField(label="Geographic Scope", type=FieldType.TEXTAREA, placeholder="Countries, states, regions where organization operates"),
                    TemplateField(label="Assessment Scope Definition", type=FieldType.TEXTAREA, placeholder="Systems, processes, departments, and data types included in assessment"),
                    TemplateField(label="Exclusions & Limitations", type=FieldType.TEXTAREA, placeholder="Systems or processes explicitly excluded from assessment"),
                    TemplateField(label="Business Drivers for Compliance", type=FieldType.TEXTAREA, placeholder="Customer requirements, regulatory mandates, business objectives"),
                    TemplateField(label="Previous Assessment History", type=FieldType.TEXTAREA, placeholder="Prior assessments, audit results, certification status"),
                    TemplateField(label="Assessment Timeline", type=FieldType.TEXT, placeholder="Assessment duration and key milestones"),
                    TemplateField(label="Stakeholder Identification", type=FieldType.TEXTAREA, placeholder="Key stakeholders, process owners, subject matter experts"),
                ],
                order=1
            ),
            TemplateStep(
                name="Control Framework Assessment & Mapping",
                description="Comprehensive evaluation of security controls against compliance framework requirements",
                instructions="Systematically assess implementation and effectiveness of security controls across technical, administrative, and physical domains.",
                fields=[
                    TemplateField(label="Control Assessment Methodology", type=FieldType.SELECT, options=["Interview & Documentation Review", "Technical Testing", "Observation", "Comprehensive (All Methods)", "Risk-Based Sampling"]),
                    TemplateField(label="Technical Controls Assessment", type=FieldType.TEXTAREA, placeholder="Access controls, encryption, network security, system hardening, vulnerability management"),
                    TemplateField(label="Administrative Controls Assessment", type=FieldType.TEXTAREA, placeholder="Policies, procedures, training, incident response, change management"),
                    TemplateField(label="Physical Controls Assessment", type=FieldType.TEXTAREA, placeholder="Facility security, access controls, environmental protections, asset management"),
                    TemplateField(label="Data Protection Controls", type=FieldType.SELECT, options=["Comprehensive Protection", "Adequate Protection", "Basic Protection", "Insufficient Protection"]),
                    TemplateField(label="Access Control Implementation", type=FieldType.SELECT, options=["Role-Based Access Control", "Attribute-Based Access Control", "Basic Access Control", "Inadequate Access Control"]),
                    TemplateField(label="Monitoring & Logging Controls", type=FieldType.SELECT, options=["Comprehensive Monitoring", "Basic Monitoring", "Limited Monitoring", "No Monitoring"]),
                    TemplateField(label="Incident Response Capabilities", type=FieldType.SELECT, options=["Mature Program", "Developing Program", "Basic Procedures", "No Formal Program"]),
                    TemplateField(label="Risk Management Framework", type=FieldType.SELECT, options=["Formal Risk Program", "Basic Risk Assessment", "Informal Risk Management", "No Risk Program"]),
                    TemplateField(label="Vendor & Third-Party Management", type=FieldType.SELECT, options=["Comprehensive Program", "Basic Management", "Limited Oversight", "No Formal Management"]),
                    TemplateField(label="Control Testing Results", type=FieldType.TEXTAREA, placeholder="Detailed results of control effectiveness testing"),
                ],
                order=2
            ),
            TemplateStep(
                name="Evidence Collection & Documentation Review",
                description="Systematic collection and evaluation of compliance evidence and supporting documentation",
                instructions="Gather, review, and validate compliance evidence including policies, procedures, technical configurations, and operational records.",
                fields=[
                    TemplateField(label="Policy Documentation Status", type=FieldType.SELECT, options=["Complete & Current", "Mostly Complete", "Partially Complete", "Inadequate"]),
                    TemplateField(label="Procedure Documentation Quality", type=FieldType.SELECT, options=["Comprehensive & Detailed", "Adequate", "Basic", "Insufficient"]),
                    TemplateField(label="Technical Evidence Collected", type=FieldType.TEXTAREA, placeholder="System configurations, security settings, technical controls evidence"),
                    TemplateField(label="Operational Evidence Review", type=FieldType.TEXTAREA, placeholder="Logs, monitoring data, incident records, change management records"),
                    TemplateField(label="Training Records Assessment", type=FieldType.SELECT, options=["Complete Training Records", "Adequate Records", "Incomplete Records", "No Training Records"]),
                    TemplateField(label="Audit Trail Completeness", type=FieldType.SELECT, options=["Comprehensive Audit Trails", "Adequate Trails", "Limited Trails", "No Audit Trails"]),
                    TemplateField(label="Document Version Control", type=FieldType.SELECT, options=["Formal Version Control", "Basic Version Control", "Informal Control", "No Version Control"]),
                    TemplateField(label="Evidence Validation Methods", type=FieldType.TEXTAREA, placeholder="Methods used to validate evidence authenticity and completeness"),
                    TemplateField(label="Documentation Gaps Identified", type=FieldType.TEXTAREA, placeholder="Missing or inadequate documentation requiring attention"),
                    TemplateField(label="Sample Size & Selection", type=FieldType.TEXTAREA, placeholder="Sampling methodology and justification for evidence selection"),
                    TemplateField(label="Evidence Quality Assessment", type=FieldType.SELECT, options=["High Quality Evidence", "Adequate Evidence", "Limited Evidence Quality", "Poor Evidence Quality"]),
                ],
                order=3
            ),
            TemplateStep(
                name="Gap Analysis & Risk Assessment",
                description="Comprehensive identification and analysis of compliance gaps with associated risk evaluation",
                instructions="Systematically identify compliance deficiencies, assess associated risks, and prioritize remediation efforts based on business impact and regulatory requirements.",
                fields=[
                    TemplateField(label="Total Compliance Requirements Assessed", type=FieldType.NUMBER, placeholder="Total number of control requirements evaluated"),
                    TemplateField(label="Fully Compliant Controls", type=FieldType.NUMBER, placeholder="Number of controls meeting compliance requirements"),
                    TemplateField(label="Partially Compliant Controls", type=FieldType.NUMBER, placeholder="Number of controls partially meeting requirements"),
                    TemplateField(label="Non-Compliant Controls", type=FieldType.NUMBER, placeholder="Number of controls not meeting requirements"),
                    TemplateField(label="Critical Compliance Gaps", type=FieldType.TEXTAREA, placeholder="High-risk gaps requiring immediate attention"),
                    TemplateField(label="High Risk Findings", type=FieldType.TEXTAREA, placeholder="Significant compliance deficiencies with high business impact"),
                    TemplateField(label="Medium Risk Findings", type=FieldType.TEXTAREA, placeholder="Moderate compliance issues requiring attention"),
                    TemplateField(label="Low Risk Findings", type=FieldType.TEXTAREA, placeholder="Minor compliance improvements for enhanced posture"),
                    TemplateField(label="Regulatory Risk Assessment", type=FieldType.SELECT, options=["High Regulatory Risk", "Moderate Regulatory Risk", "Low Regulatory Risk", "Minimal Regulatory Risk"]),
                    TemplateField(label="Business Impact Analysis", type=FieldType.TEXTAREA, placeholder="Potential business impact of identified compliance gaps"),
                    TemplateField(label="Financial Impact Estimate", type=FieldType.SELECT, options=["Significant Financial Risk", "Moderate Financial Risk", "Low Financial Risk", "Minimal Financial Risk"]),
                    TemplateField(label="Root Cause Analysis", type=FieldType.TEXTAREA, placeholder="Underlying causes of compliance gaps and systemic issues"),
                ],
                order=4
            ),
            TemplateStep(
                name="Compliance Monitoring & Audit Trail Evaluation",
                description="Assessment of ongoing compliance monitoring capabilities and audit trail effectiveness",
                instructions="Evaluate the organization's ability to continuously monitor compliance status, maintain audit trails, and demonstrate ongoing adherence to regulatory requirements.",
                fields=[
                    TemplateField(label="Compliance Monitoring Program", type=FieldType.SELECT, options=["Comprehensive Automated Monitoring", "Partially Automated", "Manual Monitoring", "No Formal Monitoring"]),
                    TemplateField(label="Monitoring Tool Implementation", type=FieldType.SELECT, options=["Enterprise Compliance Platform", "Multiple Specialized Tools", "Basic Tools", "No Dedicated Tools"]),
                    TemplateField(label="Real-time Monitoring Capabilities", type=FieldType.SELECT, options=["Real-time Dashboards", "Near Real-time", "Periodic Reporting", "Manual Reporting"]),
                    TemplateField(label="Compliance Metrics & KPIs", type=FieldType.SELECT, options=["Comprehensive Metrics", "Basic KPIs", "Limited Metrics", "No Formal Metrics"]),
                    TemplateField(label="Audit Log Management", type=FieldType.SELECT, options=["Centralized Log Management", "Distributed Logging", "Basic Logging", "Inadequate Logging"]),
                    TemplateField(label="Log Retention Compliance", type=FieldType.SELECT, options=["Meets All Requirements", "Meets Most Requirements", "Partially Compliant", "Non-Compliant"]),
                    TemplateField(label="Audit Trail Integrity", type=FieldType.SELECT, options=["Tamper-Proof Logs", "Protected Logs", "Basic Protection", "No Protection"]),
                    TemplateField(label="Compliance Reporting Frequency", type=FieldType.SELECT, options=["Real-time/Daily", "Weekly", "Monthly", "Quarterly", "Annual Only"]),
                    TemplateField(label="Management Oversight", type=FieldType.SELECT, options=["Executive Dashboard", "Management Reports", "Basic Reporting", "No Management Reporting"]),
                    TemplateField(label="Continuous Compliance Assessment", type=FieldType.SELECT, options=["Automated Assessment", "Periodic Assessment", "Manual Review", "No Ongoing Assessment"]),
                    TemplateField(label="Alert & Notification System", type=FieldType.SELECT, options=["Automated Alerts", "Manual Notifications", "Basic Alerting", "No Alert System"]),
                ],
                order=5
            ),
            TemplateStep(
                name="Remediation Planning & Compliance Roadmap",
                description="Comprehensive remediation strategy development and compliance improvement roadmap creation",
                instructions="Develop detailed remediation plans for identified gaps, create implementation timelines, assign responsibilities, and establish ongoing compliance maintenance strategies.",
                fields=[
                    TemplateField(label="Remediation Prioritization Approach", type=FieldType.SELECT, options=["Risk-Based Prioritization", "Regulatory Timeline Priority", "Cost-Based Priority", "Mixed Approach"]),
                    TemplateField(label="Critical Remediation Items", type=FieldType.TEXTAREA, placeholder="Immediate actions required for critical compliance gaps"),
                    TemplateField(label="Short-term Remediation Plan (0-3 months)", type=FieldType.TEXTAREA, placeholder="Quick wins and urgent remediation activities"),
                    TemplateField(label="Medium-term Remediation Plan (3-12 months)", type=FieldType.TEXTAREA, placeholder="Moderate complexity improvements and system enhancements"),
                    TemplateField(label="Long-term Strategic Plan (12+ months)", type=FieldType.TEXTAREA, placeholder="Strategic improvements and comprehensive program development"),
                    TemplateField(label="Resource Requirements", type=FieldType.TEXTAREA, placeholder="Personnel, budget, technology resources needed for remediation"),
                    TemplateField(label="Implementation Timeline", type=FieldType.TEXTAREA, placeholder="Detailed timeline with milestones and dependencies"),
                    TemplateField(label="Responsibility Assignment", type=FieldType.TEXTAREA, placeholder="Ownership and accountability for remediation activities"),
                    TemplateField(label="Budget Estimation", type=FieldType.SELECT, options=["Detailed Cost Analysis", "High-Level Estimates", "Resource Requirements Only", "No Cost Analysis"]),
                    TemplateField(label="Success Metrics Definition", type=FieldType.TEXTAREA, placeholder="KPIs and metrics to measure remediation success"),
                    TemplateField(label="Ongoing Maintenance Strategy", type=FieldType.TEXTAREA, placeholder="Long-term compliance maintenance and continuous improvement approach"),
                    TemplateField(label="Re-assessment Schedule", type=FieldType.SELECT, options=["Quarterly Re-assessment", "Semi-Annual", "Annual", "Bi-Annual", "As-Needed"]),
                ],
                order=6
            )
        ],
        report_structure=[
            ReportSection(
                title="Compliance Assessment Executive Summary",
                content_template="Executive overview of compliance posture, critical findings, regulatory risk assessment, and strategic recommendations for leadership and regulatory stakeholders.",
                order=1
            ),
            ReportSection(
                title="Compliance Framework & Scope Analysis",
                content_template="Detailed analysis of applicable compliance frameworks, assessment scope, business context, and regulatory requirements.",
                order=2
            ),
            ReportSection(
                title="Control Framework Assessment Results", 
                content_template="Comprehensive evaluation of technical, administrative, and physical controls across all compliance domains with effectiveness ratings.",
                order=3
            ),
            ReportSection(
                title="Evidence Collection & Documentation Review",
                content_template="Assessment of compliance evidence quality, documentation completeness, and validation results across all control areas.",
                order=4
            ),
            ReportSection(
                title="Gap Analysis & Risk Assessment",
                content_template="Detailed analysis of compliance gaps, risk prioritization, business impact assessment, and root cause analysis of deficiencies.",
                order=5
            ),
            ReportSection(
                title="Compliance Monitoring & Audit Capabilities",
                content_template="Evaluation of ongoing compliance monitoring programs, audit trail effectiveness, and continuous compliance management capabilities.",
                order=6
            ),
            ReportSection(
                title="Remediation Roadmap & Implementation Strategy",
                content_template="Prioritized remediation plan with timelines, resource requirements, implementation strategies, and long-term compliance maintenance approach.",
                order=7
            )
        ]
    )
    
    red_team_template = Template(
        name="Red Team Engagement",
        description="Full-spectrum adversary simulation following MITRE ATT&CK framework and advanced persistent threat methodologies",
        category="Red Team",
        steps=[
            TemplateStep(
                name="Pre-Engagement & Intelligence Collection",
                description="Comprehensive target intelligence gathering and attack surface mapping",
                instructions="Conduct thorough reconnaissance and intelligence gathering to understand the target environment, identify attack vectors, and plan engagement approach.",
                fields=[
                    TemplateField(label="Target Organization", type=FieldType.TEXT, required=True, placeholder="Primary target organization name"),
                    TemplateField(label="Engagement Scope", type=FieldType.TEXTAREA, placeholder="In-scope systems, networks, and limitations"),
                    TemplateField(label="Rules of Engagement", type=FieldType.TEXTAREA, placeholder="Approved methods, restrictions, emergency contacts"),
                    TemplateField(label="OSINT Collection Period", type=FieldType.TEXT, placeholder="Duration of intelligence gathering phase"),
                    TemplateField(label="External Attack Surface", type=FieldType.TEXTAREA, placeholder="Public-facing services, domains, cloud infrastructure"),
                    TemplateField(label="Employee Intelligence", type=FieldType.TEXTAREA, placeholder="Key personnel, social media profiles, organizational structure"),
                    TemplateField(label="Technology Stack Intelligence", type=FieldType.TEXTAREA, placeholder="Identified technologies, versions, potential vulnerabilities"),
                    TemplateField(label="Physical Locations", type=FieldType.TEXTAREA, placeholder="Office locations, security measures, access points"),
                    TemplateField(label="Third-Party Relationships", type=FieldType.TEXTAREA, placeholder="Vendors, partners, supply chain connections"),
                    TemplateField(label="Attack Vector Prioritization", type=FieldType.TEXTAREA, placeholder="Most promising attack vectors ranked by likelihood"),
                ],
                order=1
            ),
            TemplateStep(
                name="Initial Access & Foothold Establishment",
                description="Gaining initial access through various attack vectors",
                instructions="Execute initial access attempts using prioritized attack vectors while maintaining stealth and avoiding detection.",
                fields=[
                    TemplateField(label="Primary Attack Vector", type=FieldType.SELECT, options=["Spear Phishing", "Watering Hole", "Physical Access", "VPN Exploitation", "Remote Service Exploit", "Supply Chain", "Social Engineering"]),
                    TemplateField(label="Phishing Campaign Executed", type=FieldType.CHECKBOX),
                    TemplateField(label="Phishing Success Rate", type=FieldType.TEXT, placeholder="Clicks/opens vs total targets"),
                    TemplateField(label="Payload Delivery Method", type=FieldType.SELECT, options=["Email Attachment", "Malicious Link", "USB Drop", "Physical Installation", "Web Exploit", "Supply Chain"]),
                    TemplateField(label="External Service Compromise", type=FieldType.TEXTAREA, placeholder="VPN, RDP, webmail, or other external services compromised"),
                    TemplateField(label="Vulnerability Exploited", type=FieldType.TEXTAREA, placeholder="CVEs or zero-days used for initial access"),
                    TemplateField(label="Physical Access Achieved", type=FieldType.CHECKBOX),
                    TemplateField(label="Social Engineering Success", type=FieldType.TEXTAREA, placeholder="Pretexting, phone calls, or in-person social engineering"),
                    TemplateField(label="Initial Compromise Timeline", type=FieldType.TEXT, placeholder="Time from engagement start to first compromise"),
                    TemplateField(label="Detection Evasion Techniques", type=FieldType.TEXTAREA, placeholder="Methods used to avoid security controls"),
                    TemplateField(label="Initial Foothold Systems", type=FieldType.TEXTAREA, placeholder="First systems compromised and their roles"),
                ],
                order=2
            ),
            TemplateStep(
                name="Persistence & Defense Evasion",
                description="Establishing persistent access and evading security controls",
                instructions="Establish persistent access mechanisms while maintaining stealth and evading detection by security tools and personnel.",
                fields=[
                    TemplateField(label="Persistence Mechanisms", type=FieldType.TEXTAREA, placeholder="Registry keys, scheduled tasks, services, WMI events"),
                    TemplateField(label="Backdoor Installation", type=FieldType.CHECKBOX),
                    TemplateField(label="Legitimate Tool Abuse", type=FieldType.TEXTAREA, placeholder="PowerShell, WMI, PsExec, remote admin tools"),
                    TemplateField(label="Living Off The Land", type=FieldType.CHECKBOX),
                    TemplateField(label="Anti-Forensics Techniques", type=FieldType.TEXTAREA, placeholder="Log deletion, timestamp modification, file wiping"),
                    TemplateField(label="Security Tool Evasion", type=FieldType.TEXTAREA, placeholder="AV evasion, EDR bypass, SIEM blind spots"),
                    TemplateField(label="Communication Channels", type=FieldType.TEXTAREA, placeholder="C2 infrastructure, exfiltration channels, covert communications"),
                    TemplateField(label="Encryption Used", type=FieldType.SELECT, options=["HTTPS", "DNS Tunneling", "Steganography", "Custom Protocol", "Multiple Methods"]),
                    TemplateField(label="Persistence Testing", type=FieldType.TEXTAREA, placeholder="Reboot survival, credential changes, system updates"),
                    TemplateField(label="Stealth Assessment", type=FieldType.SELECT, options=["Undetected", "Partially Detected", "Fully Detected", "Detection Unknown"]),
                ],
                order=3
            ),
            TemplateStep(
                name="Discovery & Lateral Movement",
                description="Network reconnaissance and lateral movement throughout the environment",
                instructions="Conduct internal reconnaissance to map the network and move laterally to gain access to additional systems and resources.",
                fields=[
                    TemplateField(label="Network Discovery Methods", type=FieldType.TEXTAREA, placeholder="Port scanning, ARP discovery, DNS enumeration, AD queries"),
                    TemplateField(label="Active Directory Enumeration", type=FieldType.TEXTAREA, placeholder="Domain structure, users, groups, permissions, GPOs"),
                    TemplateField(label="Credential Harvesting", type=FieldType.TEXTAREA, placeholder="Mimikatz, LSASS dumps, browser passwords, keylogging"),
                    TemplateField(label="Lateral Movement Techniques", type=FieldType.TEXTAREA, placeholder="Pass-the-hash, pass-the-ticket, RDP, WMI, PsExec"),
                    TemplateField(label="Systems Compromised", type=FieldType.NUMBER, placeholder="Total number of systems accessed"),
                    TemplateField(label="Network Segments Accessed", type=FieldType.TEXTAREA, placeholder="Different network zones or VLANs accessed"),
                    TemplateField(label="Service Account Compromise", type=FieldType.CHECKBOX),
                    TemplateField(label="Administrative Access Gained", type=FieldType.TEXTAREA, placeholder="Local admin, domain admin, service accounts"),
                    TemplateField(label="Internal Services Exploited", type=FieldType.TEXTAREA, placeholder="File shares, databases, internal web apps"),
                    TemplateField(label="Cloud Resource Access", type=FieldType.TEXTAREA, placeholder="AWS, Azure, O365, or other cloud services accessed"),
                ],
                order=4
            ),
            TemplateStep(
                name="Privilege Escalation & Objective Achievement",
                description="Escalating privileges and achieving engagement objectives",
                instructions="Escalate privileges to achieve administrative access and complete engagement objectives such as accessing crown jewel data.",
                fields=[
                    TemplateField(label="Privilege Escalation Methods", type=FieldType.TEXTAREA, placeholder="Kernel exploits, DLL hijacking, service misconfigurations"),
                    TemplateField(label="Domain Administrator Achieved", type=FieldType.CHECKBOX),
                    TemplateField(label="Enterprise Administrator Achieved", type=FieldType.CHECKBOX),
                    TemplateField(label="Crown Jewels Identified", type=FieldType.TEXTAREA, placeholder="Critical business data, intellectual property, customer data"),
                    TemplateField(label="Crown Jewels Accessed", type=FieldType.CHECKBOX),
                    TemplateField(label="Data Exfiltration Simulated", type=FieldType.CHECKBOX),
                    TemplateField(label="Business Impact Demonstration", type=FieldType.TEXTAREA, placeholder="Potential damage, data exposure, system disruption"),
                    TemplateField(label="Regulatory Data Accessed", type=FieldType.TEXTAREA, placeholder="PII, PHI, financial data, or other regulated information"),
                    TemplateField(label="Infrastructure Control", type=FieldType.TEXTAREA, placeholder="Domain controllers, critical servers, network devices"),
                    TemplateField(label="Objective Achievement Rate", type=FieldType.TEXT, placeholder="Percentage of engagement objectives completed"),
                ],
                order=5
            ),
            TemplateStep(
                name="Impact Assessment & Evidence Collection",
                description="Documenting impact and collecting evidence of compromise",
                instructions="Document the full impact of the engagement, collect evidence for reporting, and prepare for safe disengagement.",
                fields=[
                    TemplateField(label="Evidence Collection Method", type=FieldType.SELECT, options=["Screenshots", "Video Recording", "File Samples", "Network Captures", "Comprehensive Documentation"]),
                    TemplateField(label="Business Impact Assessment", type=FieldType.TEXTAREA, placeholder="Financial impact, operational disruption, reputational damage"),
                    TemplateField(label="Compliance Impact", type=FieldType.TEXTAREA, placeholder="Regulatory violations, audit findings, legal implications"),
                    TemplateField(label="Detection Timeline", type=FieldType.TEXT, placeholder="Time until detected or engagement end"),
                    TemplateField(label="Blue Team Response", type=FieldType.TEXTAREA, placeholder="Security team response, incident handling, containment"),
                    TemplateField(label="Lessons Learned", type=FieldType.TEXTAREA, placeholder="Key insights about defensive posture and gaps"),
                    TemplateField(label="Remediation Priority", type=FieldType.TEXTAREA, placeholder="Critical issues requiring immediate attention"),
                    TemplateField(label="Cleanup Actions", type=FieldType.TEXTAREA, placeholder="Artifacts removed, accounts disabled, backdoors eliminated"),
                    TemplateField(label="Engagement Success Rate", type=FieldType.SELECT, options=["Complete Success", "Partial Success", "Limited Success", "Unsuccessful"]),
                ],
                order=6
            )
        ],
        report_structure=[
            ReportSection(
                title="Red Team Executive Summary",
                content_template="Executive-level assessment of organizational security posture, attack success, and business risk with clear recommendations for leadership.",
                order=1
            ),
            ReportSection(
                title="Attack Chain & MITRE ATT&CK Mapping",
                content_template="Detailed analysis of the complete attack chain with MITRE ATT&CK framework mapping and technique documentation.",
                order=2
            ),
            ReportSection(
                title="Technical Exploitation Details",
                content_template="Comprehensive technical details of exploits used, vulnerabilities leveraged, and access methods employed throughout the engagement.",
                order=3
            ),
            ReportSection(
                title="Defensive Gap Analysis",
                content_template="Analysis of security control failures, detection gaps, and defensive weaknesses that enabled successful compromise.",
                order=4
            ),
            ReportSection(
                title="Business Impact & Risk Assessment",
                content_template="Detailed business impact analysis including financial risk, operational impact, and regulatory compliance implications.",
                order=5
            ),
            ReportSection(
                title="Strategic Security Recommendations",
                content_template="Prioritized strategic recommendations for improving security posture, detection capabilities, and incident response based on engagement findings.",
                order=6
            )
        ]
    )
    
    code_review_template = Template(
        name="Source Code Security Review",
        description="Comprehensive source code security analysis covering architecture review, static analysis, dynamic testing, secure development lifecycle assessment, and dependency security evaluation",
        category="Code Security",
        steps=[
            TemplateStep(
                name="Code Architecture & Design Security Review",
                description="Comprehensive review of application architecture, design patterns, and security framework implementation",
                instructions="Analyze application architecture, design patterns, security frameworks, and overall code organization to identify architectural security issues and design flaws.",
                fields=[
                    TemplateField(label="Application Type", type=FieldType.SELECT, options=["Web Application", "Mobile Application", "API/Microservices", "Desktop Application", "Embedded System", "Library/Framework", "Multiple Types"], required=True),
                    TemplateField(label="Primary Programming Languages", type=FieldType.TEXTAREA, placeholder="Java, C#, Python, JavaScript, Go, etc.", required=True),
                    TemplateField(label="Secondary Languages & Scripts", type=FieldType.TEXTAREA, placeholder="SQL, HTML, CSS, shell scripts, configuration languages"),
                    TemplateField(label="Total Lines of Code", type=FieldType.NUMBER, placeholder="Approximate total lines of source code"),
                    TemplateField(label="Application Architecture Pattern", type=FieldType.SELECT, options=["Monolithic", "Microservices", "Serverless", "Layered Architecture", "MVC", "Hybrid", "Other"]),
                    TemplateField(label="Security Framework Implementation", type=FieldType.SELECT, options=["Comprehensive Security Framework", "Partial Security Framework", "Basic Security Libraries", "Custom Security Implementation", "No Security Framework"]),
                    TemplateField(label="Authentication Architecture", type=FieldType.SELECT, options=["OAuth 2.0/OpenID Connect", "SAML", "JWT", "Session-based", "API Keys", "Custom Authentication", "Multiple Methods"]),
                    TemplateField(label="Authorization Model", type=FieldType.SELECT, options=["RBAC (Role-Based)", "ABAC (Attribute-Based)", "ACL (Access Control List)", "Custom Authorization", "No Formal Authorization"]),
                    TemplateField(label="Data Flow Security", type=FieldType.SELECT, options=["Secure Data Flow Design", "Partially Secure", "Basic Data Handling", "Insecure Data Flow"]),
                    TemplateField(label="API Security Design", type=FieldType.SELECT, options=["REST API with Security", "GraphQL with Security", "SOAP with Security", "Basic API", "Insecure API Design", "Not Applicable"]),
                    TemplateField(label="Architectural Security Issues", type=FieldType.TEXTAREA, placeholder="Design flaws, architectural vulnerabilities, security anti-patterns"),
                ],
                order=1
            ),
            TemplateStep(
                name="Static Application Security Testing (SAST)",
                description="Comprehensive automated static code analysis and manual code review for security vulnerabilities",
                instructions="Perform thorough static analysis using SAST tools and manual code review to identify security vulnerabilities, coding flaws, and potential attack vectors.",
                fields=[
                    TemplateField(label="SAST Tools Used", type=FieldType.TEXTAREA, placeholder="SonarQube, Checkmarx, Veracode, Semgrep, CodeQL, Snyk Code, etc."),
                    TemplateField(label="Scan Coverage Percentage", type=FieldType.SELECT, options=["90-100%", "75-89%", "50-74%", "25-49%", "<25%"]),
                    TemplateField(label="Critical Vulnerabilities Found", type=FieldType.NUMBER, placeholder="Number of critical severity security issues"),
                    TemplateField(label="High Severity Vulnerabilities", type=FieldType.NUMBER, placeholder="Number of high severity security issues"),
                    TemplateField(label="Medium Severity Issues", type=FieldType.NUMBER, placeholder="Number of medium severity security issues"),
                    TemplateField(label="SQL Injection Vulnerabilities", type=FieldType.NUMBER, placeholder="SQL injection and database query vulnerabilities"),
                    TemplateField(label="Cross-Site Scripting (XSS)", type=FieldType.NUMBER, placeholder="Reflected, stored, and DOM-based XSS vulnerabilities"),
                    TemplateField(label="Command Injection Issues", type=FieldType.NUMBER, placeholder="OS command injection vulnerabilities"),
                    TemplateField(label="Path Traversal Vulnerabilities", type=FieldType.NUMBER, placeholder="Directory traversal and path manipulation issues"),
                    TemplateField(label="Hardcoded Credentials & Secrets", type=FieldType.NUMBER, placeholder="Passwords, API keys, tokens hardcoded in source"),
                    TemplateField(label="Cryptographic Implementation Issues", type=FieldType.NUMBER, placeholder="Weak encryption, improper key management, crypto misuse"),
                    TemplateField(label="Input Validation & Sanitization", type=FieldType.SELECT, options=["Comprehensive Validation", "Adequate Validation", "Basic Validation", "Insufficient Validation"]),
                    TemplateField(label="Output Encoding Implementation", type=FieldType.SELECT, options=["Proper Output Encoding", "Partial Encoding", "Basic Encoding", "No Output Encoding"]),
                    TemplateField(label="Race Condition Vulnerabilities", type=FieldType.NUMBER, placeholder="Concurrency and threading security issues"),
                    TemplateField(label="Business Logic Vulnerabilities", type=FieldType.TEXTAREA, placeholder="Application-specific logic flaws and business rule bypasses"),
                ],
                order=2
            ),
            TemplateStep(
                name="Dynamic Code Analysis & Runtime Security Assessment",
                description="Dynamic analysis, interactive testing, and runtime security behavior evaluation",
                instructions="Analyze application behavior during runtime, perform dynamic testing, and assess security controls effectiveness in live execution environment.",
                fields=[
                    TemplateField(label="Dynamic Analysis Tools Used", type=FieldType.TEXTAREA, placeholder="DAST tools, IAST tools, runtime analysis platforms"),
                    TemplateField(label="Runtime Environment Tested", type=FieldType.SELECT, options=["Production-like", "Staging Environment", "Development Environment", "Local Testing", "Multiple Environments"]),
                    TemplateField(label="Interactive Application Security Testing (IAST)", type=FieldType.SELECT, options=["Comprehensive IAST", "Basic IAST", "Manual Interactive Testing", "Not Performed"]),
                    TemplateField(label="Memory Safety Analysis", type=FieldType.SELECT, options=["Memory-Safe Languages", "Buffer Overflow Protection", "Basic Memory Checks", "Memory Safety Issues Found"]),
                    TemplateField(label="Runtime Protection Mechanisms", type=FieldType.SELECT, options=["ASLR/DEP Enabled", "Stack Canaries", "Basic Protections", "No Runtime Protection"]),
                    TemplateField(label="Error Handling Security", type=FieldType.SELECT, options=["Secure Error Handling", "Adequate Error Handling", "Information Leakage", "Poor Error Handling"]),
                    TemplateField(label="Logging & Monitoring Implementation", type=FieldType.SELECT, options=["Comprehensive Security Logging", "Basic Security Logging", "Limited Logging", "No Security Logging"]),
                    TemplateField(label="Session Management Security", type=FieldType.SELECT, options=["Secure Session Management", "Adequate Session Handling", "Basic Session Security", "Insecure Sessions"]),
                    TemplateField(label="Configuration Security", type=FieldType.SELECT, options=["Hardened Configuration", "Adequate Configuration", "Default Configuration", "Insecure Configuration"]),
                    TemplateField(label="Runtime Vulnerability Exploitation", type=FieldType.TEXTAREA, placeholder="Successfully exploited vulnerabilities during dynamic testing"),
                    TemplateField(label="Performance Impact Assessment", type=FieldType.SELECT, options=["No Performance Impact", "Minimal Impact", "Moderate Impact", "Significant Impact"]),
                ],
                order=3
            ),
            TemplateStep(
                name="Secure Development Lifecycle (SDLC) Assessment",
                description="Evaluation of secure development practices, processes, and security integration throughout development lifecycle",
                instructions="Assess the integration of security practices throughout the development lifecycle including design, coding standards, testing, and deployment security.",
                fields=[
                    TemplateField(label="SDLC Security Integration", type=FieldType.SELECT, options=["Security by Design", "Integrated Security", "Basic Security Integration", "Ad Hoc Security", "No Security Integration"]),
                    TemplateField(label="Secure Coding Standards", type=FieldType.SELECT, options=["Comprehensive Standards", "Basic Standards", "Informal Guidelines", "No Standards"]),
                    TemplateField(label="Code Review Process", type=FieldType.SELECT, options=["Security-Focused Reviews", "General Code Reviews", "Peer Reviews Only", "No Formal Reviews"]),
                    TemplateField(label="Security Testing Integration", type=FieldType.SELECT, options=["Automated in CI/CD", "Manual Security Testing", "Ad Hoc Testing", "No Security Testing"]),
                    TemplateField(label="Developer Security Training", type=FieldType.SELECT, options=["Regular Security Training", "Annual Training", "Basic Training", "No Security Training"]),
                    TemplateField(label="Threat Modeling Process", type=FieldType.SELECT, options=["Formal Threat Modeling", "Basic Threat Analysis", "Informal Assessment", "No Threat Modeling"]),
                    TemplateField(label="Security Requirements Process", type=FieldType.SELECT, options=["Formal Security Requirements", "Basic Security Requirements", "Implied Requirements", "No Security Requirements"]),
                    TemplateField(label="Version Control Security", type=FieldType.SELECT, options=["Secure Repository Management", "Basic Access Control", "Limited Security", "No Repository Security"]),
                    TemplateField(label="Build & Deployment Security", type=FieldType.SELECT, options=["Secure CI/CD Pipeline", "Basic Pipeline Security", "Manual Deployment", "Insecure Deployment"]),
                    TemplateField(label="Security Documentation Quality", type=FieldType.SELECT, options=["Comprehensive Documentation", "Adequate Documentation", "Basic Documentation", "Poor Documentation"]),
                    TemplateField(label="Incident Response Integration", type=FieldType.SELECT, options=["Integrated Response Process", "Basic Response Plan", "Informal Process", "No Response Plan"]),
                ],
                order=4
            ),
            TemplateStep(
                name="Third-Party Dependencies & Supply Chain Security Analysis",
                description="Comprehensive assessment of third-party components, dependencies, and supply chain security risks",
                instructions="Analyze all third-party dependencies, libraries, frameworks, and external components for security vulnerabilities and supply chain risks.",
                fields=[
                    TemplateField(label="Dependency Management Approach", type=FieldType.SELECT, options=["Automated Dependency Management", "Manual Dependency Tracking", "Basic Package Management", "No Formal Management"]),
                    TemplateField(label="Software Bill of Materials (SBOM)", type=FieldType.SELECT, options=["Comprehensive SBOM", "Basic Component List", "Partial Inventory", "No SBOM"]),
                    TemplateField(label="Total Third-Party Dependencies", type=FieldType.NUMBER, placeholder="Number of external libraries and components"),
                    TemplateField(label="Critical Dependency Vulnerabilities", type=FieldType.NUMBER, placeholder="Critical vulnerabilities in dependencies"),
                    TemplateField(label="High Risk Dependency Issues", type=FieldType.NUMBER, placeholder="High severity dependency vulnerabilities"),
                    TemplateField(label="Outdated Dependencies", type=FieldType.NUMBER, placeholder="Number of outdated or end-of-life dependencies"),
                    TemplateField(label="Dependency Vulnerability Scanning", type=FieldType.SELECT, options=["Automated Continuous Scanning", "Regular Manual Scans", "Periodic Checks", "No Vulnerability Scanning"]),
                    TemplateField(label="License Compliance Assessment", type=FieldType.SELECT, options=["Full License Compliance", "Basic License Review", "Limited License Check", "No License Review"]),
                    TemplateField(label="Supply Chain Verification", type=FieldType.SELECT, options=["Cryptographic Verification", "Basic Source Verification", "Trust-Based", "No Verification"]),
                    TemplateField(label="Malicious Component Detection", type=FieldType.SELECT, options=["Advanced Threat Detection", "Basic Malware Scanning", "Manual Review", "No Malicious Component Check"]),
                    TemplateField(label="Dependency Update Process", type=FieldType.SELECT, options=["Automated Security Updates", "Managed Update Process", "Manual Updates", "Rarely Updated"]),
                    TemplateField(label="Vendoring & Mirroring Strategy", type=FieldType.SELECT, options=["Internal Repository Mirror", "Vendored Dependencies", "Direct External Sources", "Mixed Approach"]),
                ],
                order=5
            ),
            TemplateStep(
                name="Code Quality & Security Metrics Evaluation",
                description="Assessment of code quality metrics, security measurement programs, and continuous improvement practices",
                instructions="Evaluate code quality metrics, security KPIs, measurement practices, and continuous improvement approaches for maintaining secure code.",
                fields=[
                    TemplateField(label="Code Quality Metrics Tracking", type=FieldType.SELECT, options=["Comprehensive Quality Metrics", "Basic Quality Metrics", "Limited Metrics", "No Quality Metrics"]),
                    TemplateField(label="Security Metrics Program", type=FieldType.SELECT, options=["Formal Security Metrics", "Basic Security KPIs", "Ad Hoc Measurements", "No Security Metrics"]),
                    TemplateField(label="Code Coverage Assessment", type=FieldType.SELECT, options=["High Coverage (>80%)", "Good Coverage (60-80%)", "Fair Coverage (40-60%)", "Low Coverage (<40%)"]),
                    TemplateField(label="Security Test Coverage", type=FieldType.SELECT, options=["Comprehensive Security Tests", "Basic Security Tests", "Limited Security Testing", "No Security Test Coverage"]),
                    TemplateField(label="Technical Debt Management", type=FieldType.SELECT, options=["Proactive Debt Management", "Reactive Management", "Basic Tracking", "No Debt Management"]),
                    TemplateField(label="Code Complexity Analysis", type=FieldType.SELECT, options=["Low Complexity", "Moderate Complexity", "High Complexity", "Very High Complexity"]),
                    TemplateField(label="Maintainability Index", type=FieldType.SELECT, options=["High Maintainability", "Good Maintainability", "Fair Maintainability", "Poor Maintainability"]),
                    TemplateField(label="Security Regression Testing", type=FieldType.SELECT, options=["Automated Regression Tests", "Manual Regression Testing", "Basic Regression Checks", "No Regression Testing"]),
                    TemplateField(label="Continuous Integration Security", type=FieldType.SELECT, options=["Security Gates in CI", "Basic CI Security", "Limited CI Integration", "No CI Security Integration"]),
                    TemplateField(label="Performance Security Impact", type=FieldType.SELECT, options=["Optimized Secure Code", "Balanced Performance/Security", "Security Over Performance", "Performance Over Security"]),
                    TemplateField(label="Security Improvement Trends", type=FieldType.SELECT, options=["Improving Security Posture", "Stable Security", "Declining Security", "Inconsistent Security"]),
                    TemplateField(label="Developer Security Awareness", type=FieldType.SELECT, options=["High Security Awareness", "Good Awareness", "Basic Awareness", "Low Security Awareness"]),
                ],
                order=6
            )
        ],
        report_structure=[
            ReportSection(
                title="Source Code Security Assessment Executive Summary",
                content_template="Executive overview of application security posture, critical vulnerabilities, development security maturity, and strategic recommendations for secure development.",
                order=1
            ),
            ReportSection(
                title="Architecture & Design Security Analysis",
                content_template="Comprehensive evaluation of application architecture, design patterns, security frameworks, and architectural security considerations.",
                order=2
            ),
            ReportSection(
                title="Static Analysis & Vulnerability Assessment",
                content_template="Detailed results from static application security testing including vulnerability classifications, severity analysis, and code-level security issues.",
                order=3
            ),
            ReportSection(
                title="Dynamic Analysis & Runtime Security Evaluation",
                content_template="Assessment of runtime security behavior, dynamic testing results, and security control effectiveness during application execution.",
                order=4
            ),
            ReportSection(
                title="Secure Development Lifecycle Assessment",
                content_template="Evaluation of security integration throughout development processes, secure coding practices, and development security maturity.",
                order=5
            ),
            ReportSection(
                title="Supply Chain & Dependency Security Analysis",
                content_template="Comprehensive analysis of third-party dependencies, supply chain risks, and external component security assessment.",
                order=6
            ),
            ReportSection(
                title="Code Quality & Security Metrics Evaluation",
                content_template="Assessment of code quality metrics, security measurement programs, and continuous improvement practices for maintaining secure code.",
                order=7
            ),
            ReportSection(
                title="Secure Development Recommendations & Roadmap",
                content_template="Strategic recommendations for improving application security, development processes, and long-term secure coding practices implementation.",
                order=8
            )
        ]
    )
    
    # Additional comprehensive templates (continuing to 25+)
    database_security_template = Template(
        name="Database Security Assessment",
        description="Comprehensive database security assessment covering configuration, access controls, and data protection",
        category="Database Security",
        steps=[
            TemplateStep(
                name="Database Environment Discovery & Inventory",
                description="Comprehensive database service discovery and environment mapping",
                instructions="Systematically discover and inventory all database systems in the environment including versions, configurations, and network topology.",
                fields=[
                    TemplateField(label="Database Systems Count", type=FieldType.NUMBER, placeholder="Total number of database instances discovered"),
                    TemplateField(label="Database Types Identified", type=FieldType.TEXTAREA, placeholder="MySQL, PostgreSQL, MSSQL, Oracle, MongoDB, Redis, etc."),
                    TemplateField(label="Version Information", type=FieldType.TEXTAREA, placeholder="Database versions and patch levels"),
                    TemplateField(label="Network Topology", type=FieldType.TEXTAREA, placeholder="Network segments, firewall rules, network access"),
                    TemplateField(label="Service Accounts Identified", type=FieldType.TEXTAREA, placeholder="Database service accounts and privileges"),
                    TemplateField(label="Database Roles & Users", type=FieldType.TEXTAREA, placeholder="Administrative and application users identified"),
                    TemplateField(label="High-Value Databases", type=FieldType.TEXTAREA, placeholder="Databases containing sensitive or critical data"),
                    TemplateField(label="Clustering & Replication", type=FieldType.TEXTAREA, placeholder="Database clusters, replication setup, high availability"),
                    TemplateField(label="Database Connections", type=FieldType.TEXTAREA, placeholder="Applications and systems connecting to databases"),
                    TemplateField(label="Discovery Tools Used", type=FieldType.TEXTAREA, placeholder="Nmap, database scanners, network discovery tools"),
                ],
                order=1
            ),
            TemplateStep(
                name="Authentication & Access Control Assessment",
                description="Comprehensive database authentication and authorization security testing",
                instructions="Test database authentication mechanisms, user privileges, and access control implementations.",
                fields=[
                    TemplateField(label="Authentication Methods", type=FieldType.TEXTAREA, placeholder="Database native, LDAP, Kerberos, certificate-based"),
                    TemplateField(label="Default Credentials Found", type=FieldType.NUMBER, placeholder="Number of systems with default credentials"),
                    TemplateField(label="Anonymous Access Possible", type=FieldType.CHECKBOX),
                    TemplateField(label="Weak Password Policy", type=FieldType.CHECKBOX),
                    TemplateField(label="Password Complexity Requirements", type=FieldType.SELECT, options=["Strong Requirements", "Moderate Requirements", "Weak Requirements", "No Requirements"]),
                    TemplateField(label="Account Lockout Policy", type=FieldType.SELECT, options=["Properly Configured", "Weak Configuration", "Not Configured"]),
                    TemplateField(label="Privileged Account Management", type=FieldType.SELECT, options=["Well Managed", "Moderately Managed", "Poorly Managed"]),
                    TemplateField(label="Role-Based Access Control", type=FieldType.SELECT, options=["Properly Implemented", "Partially Implemented", "Not Implemented"]),
                    TemplateField(label="Excessive Privileges Identified", type=FieldType.TEXTAREA, placeholder="Users with unnecessary administrative privileges"),
                    TemplateField(label="Shared Account Usage", type=FieldType.TEXTAREA, placeholder="Shared or generic accounts identified"),
                    TemplateField(label="Authentication Bypass Possible", type=FieldType.CHECKBOX),
                ],
                order=2
            ),
            TemplateStep(
                name="Database Vulnerability & Configuration Assessment",
                description="Database vulnerability scanning and security configuration review",
                instructions="Perform comprehensive vulnerability assessment and security configuration review of database systems.",
                fields=[
                    TemplateField(label="Vulnerability Scanner Used", type=FieldType.SELECT, options=["Nessus", "OpenVAS", "Rapid7", "Database-specific Tools", "Manual Testing", "Multiple Tools"]),
                    TemplateField(label="Critical Vulnerabilities", type=FieldType.NUMBER, placeholder="Number of critical severity vulnerabilities"),
                    TemplateField(label="High Risk Vulnerabilities", type=FieldType.NUMBER, placeholder="Number of high severity vulnerabilities"),
                    TemplateField(label="Medium Risk Vulnerabilities", type=FieldType.NUMBER, placeholder="Number of medium severity vulnerabilities"),
                    TemplateField(label="Unpatched Systems", type=FieldType.NUMBER, placeholder="Number of systems missing critical patches"),
                    TemplateField(label="Configuration Weaknesses", type=FieldType.TEXTAREA, placeholder="Insecure configurations, unnecessary features enabled"),
                    TemplateField(label="Network Security", type=FieldType.SELECT, options=["Properly Secured", "Partially Secured", "Poorly Secured"]),
                    TemplateField(label="SSL/TLS Implementation", type=FieldType.SELECT, options=["Strong Implementation", "Weak Implementation", "Not Implemented"]),
                    TemplateField(label="Database Firewall", type=FieldType.SELECT, options=["Implemented", "Partially Implemented", "Not Implemented"]),
                    TemplateField(label="Unnecessary Services", type=FieldType.TEXTAREA, placeholder="Unnecessary database features or services enabled"),
                    TemplateField(label="Security Baseline Compliance", type=FieldType.SELECT, options=["Compliant", "Partially Compliant", "Non-Compliant"]),
                ],
                order=3
            ),
            TemplateStep(
                name="Data Protection & Encryption Assessment",
                description="Assessment of data encryption, masking, and protection mechanisms",
                instructions="Evaluate data protection mechanisms including encryption at rest and in transit, data masking, and backup security.",
                fields=[
                    TemplateField(label="Encryption at Rest", type=FieldType.SELECT, options=["Fully Encrypted", "Partially Encrypted", "Not Encrypted"]),
                    TemplateField(label="Encryption in Transit", type=FieldType.SELECT, options=["Always Encrypted", "Partially Encrypted", "Not Encrypted"]),
                    TemplateField(label="Key Management", type=FieldType.SELECT, options=["Proper Key Management", "Weak Key Management", "No Key Management"]),
                    TemplateField(label="Transparent Data Encryption (TDE)", type=FieldType.SELECT, options=["Implemented", "Partially Implemented", "Not Implemented"]),
                    TemplateField(label="Column-Level Encryption", type=FieldType.SELECT, options=["Implemented", "Partially Implemented", "Not Implemented"]),
                    TemplateField(label="Data Masking/Anonymization", type=FieldType.SELECT, options=["Implemented", "Partially Implemented", "Not Implemented"]),
                    TemplateField(label="Backup Encryption", type=FieldType.SELECT, options=["Encrypted", "Partially Encrypted", "Not Encrypted"]),
                    TemplateField(label="Backup Access Controls", type=FieldType.SELECT, options=["Properly Controlled", "Weakly Controlled", "Not Controlled"]),
                    TemplateField(label="Sensitive Data Identified", type=FieldType.TEXTAREA, placeholder="PII, PHI, financial data, intellectual property"),
                    TemplateField(label="Data Classification", type=FieldType.SELECT, options=["Properly Classified", "Partially Classified", "Not Classified"]),
                ],
                order=4
            ),
            TemplateStep(
                name="Database Security Testing & Exploitation",
                description="Active security testing and exploitation of database vulnerabilities",
                instructions="Perform controlled exploitation testing including SQL injection, privilege escalation, and data extraction attempts.",
                fields=[
                    TemplateField(label="SQL Injection Testing", type=FieldType.SELECT, options=["Vulnerable", "Partially Vulnerable", "Not Vulnerable"]),
                    TemplateField(label="NoSQL Injection Testing", type=FieldType.SELECT, options=["Vulnerable", "Partially Vulnerable", "Not Vulnerable", "Not Applicable"]),
                    TemplateField(label="Stored Procedure Vulnerabilities", type=FieldType.CHECKBOX),
                    TemplateField(label="Privilege Escalation Possible", type=FieldType.CHECKBOX),
                    TemplateField(label="Data Extraction Successful", type=FieldType.CHECKBOX),
                    TemplateField(label="Database Fingerprinting", type=FieldType.TEXTAREA, placeholder="Information leaked through error messages, banners"),
                    TemplateField(label="Denial of Service Possible", type=FieldType.CHECKBOX),
                    TemplateField(label="File System Access", type=FieldType.CHECKBOX),
                    TemplateField(label="Command Execution", type=FieldType.CHECKBOX),
                    TemplateField(label="Cross-Database Access", type=FieldType.CHECKBOX),
                    TemplateField(label="Exploitation Success Rate", type=FieldType.TEXT, placeholder="Percentage of successful exploitation attempts"),
                    TemplateField(label="Business Logic Vulnerabilities", type=FieldType.TEXTAREA, placeholder="Application-specific database security issues"),
                ],
                order=5
            )
        ],
        report_structure=[
            ReportSection(
                title="Database Security Assessment Summary",
                content_template="Executive summary of database security posture, critical vulnerabilities, and business risk assessment.",
                order=1
            ),
            ReportSection(
                title="Database Environment Analysis",
                content_template="Comprehensive analysis of database infrastructure, topology, and security architecture.",
                order=2
            ),
            ReportSection(
                title="Authentication & Access Control Evaluation",
                content_template="Detailed assessment of database authentication mechanisms, user privileges, and access control implementations.",
                order=3
            ),
            ReportSection(
                title="Vulnerability Assessment Results",
                content_template="Database vulnerability findings including configuration weaknesses, unpatched systems, and security gaps.",
                order=4
            ),
            ReportSection(
                title="Data Protection & Encryption Analysis",
                content_template="Assessment of data protection mechanisms including encryption, masking, backup security, and compliance status.",
                order=5
            ),
            ReportSection(
                title="Database Security Hardening Recommendations",
                content_template="Comprehensive database security recommendations including configuration hardening, patch management, and security controls implementation.",
                order=6
            )
        ]
    )
    
    # Continue with more templates...
    threat_intel_template = Template(
        name="Threat Intelligence Assessment",
        description="Comprehensive threat landscape analysis, actor profiling, and strategic intelligence assessment",
        category="Threat Intelligence",
        steps=[
            TemplateStep(
                name="Threat Landscape & Industry Analysis",
                description="Comprehensive threat landscape assessment specific to organization and industry",
                instructions="Analyze current threat landscape relevant to the organization's industry, geography, and business model using multiple intelligence sources.",
                fields=[
                    TemplateField(label="Target Organization", type=FieldType.TEXT, required=True, placeholder="Organization name for threat analysis"),
                    TemplateField(label="Industry Sector", type=FieldType.SELECT, options=["Financial Services", "Healthcare", "Government", "Technology", "Manufacturing", "Energy/Utilities", "Retail", "Education", "Defense", "Other"]),
                    TemplateField(label="Geographic Regions", type=FieldType.TEXTAREA, placeholder="Operating regions and geopolitical considerations"),
                    TemplateField(label="Business Model", type=FieldType.SELECT, options=["B2B", "B2C", "B2G", "Mixed", "Non-Profit"]),
                    TemplateField(label="Crown Jewel Assets", type=FieldType.TEXTAREA, placeholder="Most valuable data and systems to protect"),
                    TemplateField(label="Regulatory Environment", type=FieldType.TEXTAREA, placeholder="Compliance requirements, regulatory oversight"),
                    TemplateField(label="Threat Intelligence Sources", type=FieldType.TEXTAREA, placeholder="Commercial feeds, government sources, open source intel"),
                    TemplateField(label="Analysis Time Period", type=FieldType.TEXT, placeholder="Timeframe for threat analysis (e.g., last 12 months)"),
                    TemplateField(label="Industry Threat Trends", type=FieldType.TEXTAREA, placeholder="Current threat trends affecting the industry"),
                    TemplateField(label="Geopolitical Threat Factors", type=FieldType.TEXTAREA, placeholder="Nation-state tensions, sanctions, conflicts affecting threats"),
                ],
                order=1
            ),
            TemplateStep(
                name="Threat Actor Identification & Profiling",
                description="Identification and comprehensive profiling of relevant threat actors",
                instructions="Identify, classify, and profile threat actors most likely to target the organization based on motivation, capability, and opportunity.",
                fields=[
                    TemplateField(label="Nation-State Actors", type=FieldType.TEXTAREA, placeholder="APT groups, state-sponsored actors relevant to organization"),
                    TemplateField(label="Cybercriminal Groups", type=FieldType.TEXTAREA, placeholder="Organized crime groups, ransomware operators, fraud rings"),
                    TemplateField(label="Hacktivist Groups", type=FieldType.TEXTAREA, placeholder="Activist groups with ideological motivations"),
                    TemplateField(label="Insider Threats", type=FieldType.TEXTAREA, placeholder="Malicious insiders, negligent employees, compromised accounts"),
                    TemplateField(label="Competitor Intelligence", type=FieldType.TEXTAREA, placeholder="Industrial espionage, competitive intelligence gathering"),
                    TemplateField(label="Threat Actor Motivations", type=FieldType.TEXTAREA, placeholder="Financial, political, ideological, competitive motivations"),
                    TemplateField(label="Actor Capabilities Assessment", type=FieldType.TEXTAREA, placeholder="Technical sophistication, resources, tools available"),
                    TemplateField(label="Historical Targeting Patterns", type=FieldType.TEXTAREA, placeholder="Past attacks on similar organizations or industry"),
                    TemplateField(label="Actor Attribution Confidence", type=FieldType.SELECT, options=["High Confidence", "Medium Confidence", "Low Confidence", "Suspected"]),
                    TemplateField(label="Threat Actor Prioritization", type=FieldType.TEXTAREA, placeholder="Most concerning actors ranked by threat level"),
                ],
                order=2
            ),
            TemplateStep(
                name="Attack Campaign & TTP Analysis",
                description="Analysis of attack campaigns and tactics, techniques, procedures",
                instructions="Analyze recent attack campaigns, extract TTPs, and map to MITRE ATT&CK framework for defensive planning.",
                fields=[
                    TemplateField(label="Recent Campaign Analysis", type=FieldType.TEXTAREA, placeholder="Major campaigns affecting industry or similar organizations"),
                    TemplateField(label="Initial Access Methods", type=FieldType.TEXTAREA, placeholder="Phishing, exploit kits, watering holes, supply chain"),
                    TemplateField(label="Persistence Techniques", type=FieldType.TEXTAREA, placeholder="Registry manipulation, scheduled tasks, services"),
                    TemplateField(label="Privilege Escalation TTPs", type=FieldType.TEXTAREA, placeholder="Local exploits, credential theft, token manipulation"),
                    TemplateField(label="Lateral Movement Methods", type=FieldType.TEXTAREA, placeholder="Pass-the-hash, remote services, network shares"),
                    TemplateField(label="Data Collection & Exfiltration", type=FieldType.TEXTAREA, placeholder="Data staging, compression, encryption, exfiltration channels"),
                    TemplateField(label="Command & Control", type=FieldType.TEXTAREA, placeholder="C2 infrastructure, domains, protocols, communication patterns"),
                    TemplateField(label="MITRE ATT&CK Mapping", type=FieldType.TEXTAREA, placeholder="Relevant MITRE ATT&CK techniques and sub-techniques"),
                    TemplateField(label="Tool & Malware Analysis", type=FieldType.TEXTAREA, placeholder="Common tools, malware families, custom implants"),
                    TemplateField(label="Defensive Evasion Techniques", type=FieldType.TEXTAREA, placeholder="AV evasion, obfuscation, living off the land"),
                ],
                order=3
            ),
            TemplateStep(
                name="Vulnerability & Exploit Intelligence",
                description="Analysis of vulnerabilities and exploits relevant to organizational attack surface",
                instructions="Identify vulnerabilities actively exploited by threat actors and assess organizational exposure to current exploit trends.",
                fields=[
                    TemplateField(label="Zero-Day Exploitation Trends", type=FieldType.TEXTAREA, placeholder="Recent zero-days used by threat actors"),
                    TemplateField(label="N-Day Exploit Activity", type=FieldType.TEXTAREA, placeholder="Patched vulnerabilities still being exploited"),
                    TemplateField(label="Vulnerability Categories", type=FieldType.TEXTAREA, placeholder="Most exploited vulnerability types and vendors"),
                    TemplateField(label="Exploit Kit Analysis", type=FieldType.TEXTAREA, placeholder="Active exploit kits and their capabilities"),
                    TemplateField(label="Weaponized Exploits", type=FieldType.TEXTAREA, placeholder="CVEs weaponized by threat actors"),
                    TemplateField(label="Organizational Exposure", type=FieldType.TEXTAREA, placeholder="Organization's exposure to identified vulnerabilities"),
                    TemplateField(label="Patch Management Assessment", type=FieldType.TEXTAREA, placeholder="Critical patches and update recommendations"),
                    TemplateField(label="Supply Chain Vulnerabilities", type=FieldType.TEXTAREA, placeholder="Third-party software and hardware risks"),
                    TemplateField(label="Exploit Timeline Analysis", type=FieldType.TEXT, placeholder="Time from disclosure to active exploitation"),
                    TemplateField(label="Mitigation Effectiveness", type=FieldType.TEXTAREA, placeholder="Effectiveness of current security controls against identified exploits"),
                ],
                order=4
            ),
            TemplateStep(
                name="Strategic Threat Assessment & Risk Quantification",
                description="Strategic threat assessment and quantified risk analysis",
                instructions="Synthesize threat intelligence into strategic risk assessment with quantified threat probabilities and business impact analysis.",
                fields=[
                    TemplateField(label="Threat Probability Assessment", type=FieldType.TEXTAREA, placeholder="Likelihood of various threat scenarios"),
                    TemplateField(label="Business Impact Analysis", type=FieldType.TEXTAREA, placeholder="Potential business impact of successful attacks"),
                    TemplateField(label="Risk Scoring Methodology", type=FieldType.SELECT, options=["CVSS", "FAIR", "Custom Framework", "Qualitative Assessment"]),
                    TemplateField(label="Critical Risk Scenarios", type=FieldType.TEXTAREA, placeholder="Highest risk attack scenarios for the organization"),
                    TemplateField(label="Threat Trend Analysis", type=FieldType.TEXTAREA, placeholder="Emerging threats and future threat predictions"),
                    TemplateField(label="Industry Comparison", type=FieldType.TEXTAREA, placeholder="Threat level compared to industry peers"),
                    TemplateField(label="Geographic Risk Factors", type=FieldType.TEXTAREA, placeholder="Location-based threat considerations"),
                    TemplateField(label="Seasonal Threat Patterns", type=FieldType.TEXTAREA, placeholder="Time-based threat trends and patterns"),
                    TemplateField(label="Threat Intelligence Gaps", type=FieldType.TEXTAREA, placeholder="Areas needing additional intelligence collection"),
                    TemplateField(label="Strategic Recommendations", type=FieldType.TEXTAREA, placeholder="High-level strategic security recommendations"),
                ],
                order=5
            )
        ],
        report_structure=[
            ReportSection(
                title="Threat Intelligence Executive Summary",
                content_template="Strategic threat assessment summary for executive leadership including key threats, risk levels, and business implications.",
                order=1
            ),
            ReportSection(
                title="Threat Actor Landscape Analysis",
                content_template="Comprehensive analysis of relevant threat actors including capabilities, motivations, and targeting patterns.",
                order=2
            ),
            ReportSection(
                title="Attack Campaign & TTP Analysis",
                content_template="Detailed analysis of attack campaigns, tactics, techniques, procedures with MITRE ATT&CK framework mapping.",
                order=3
            ),
            ReportSection(
                title="Vulnerability & Exploit Intelligence",
                content_template="Analysis of vulnerability trends, exploit activity, and organizational exposure to current threats.",
                order=4
            ),
            ReportSection(
                title="Strategic Risk Assessment",
                content_template="Quantified threat-based risk assessment with business impact analysis and strategic recommendations.",
                order=5
            ),
            ReportSection(
                title="Threat-Informed Defense Strategy",
                content_template="Intelligence-driven security recommendations including detection strategies, prevention measures, and response planning.",
                order=6
            )
        ]
    )
    
    # Additional templates to reach 25+ comprehensive assessment types
    incident_response_template = Template(
        name="Incident Response Tabletop Exercise",
        description="Comprehensive incident response readiness assessment and crisis simulation following NIST SP 800-61 guidelines",
        category="Incident Response",
        steps=[
            TemplateStep(
                name="Incident Response Program Assessment",
                description="Comprehensive evaluation of incident response program maturity and readiness",
                instructions="Assess the organization's incident response program including policies, procedures, team structure, and preparedness level.",
                fields=[
                    TemplateField(label="IR Program Maturity Level", type=FieldType.SELECT, options=["Ad Hoc", "Developing", "Defined", "Managed", "Optimizing"]),
                    TemplateField(label="Formal IR Plan Exists", type=FieldType.CHECKBOX),
                    TemplateField(label="IR Plan Last Updated", type=FieldType.TEXT, placeholder="Date of last IR plan update"),
                    TemplateField(label="Response Team Structure", type=FieldType.SELECT, options=["Dedicated Team", "Hybrid Team", "Outsourced", "Ad Hoc", "None"]),
                    TemplateField(label="Team Members Count", type=FieldType.NUMBER, placeholder="Number of trained IR team members"),
                    TemplateField(label="Team Training Frequency", type=FieldType.SELECT, options=["Quarterly", "Semi-Annual", "Annual", "Ad Hoc", "None"]),
                    TemplateField(label="IR Roles & Responsibilities", type=FieldType.TEXTAREA, placeholder="Defined roles: IR Manager, Analysts, Communications, Legal, etc."),
                    TemplateField(label="Authority & Decision Making", type=FieldType.TEXTAREA, placeholder="Authority levels, escalation chains, decision-making processes"),
                    TemplateField(label="Budget & Resources", type=FieldType.SELECT, options=["Adequate", "Limited", "Insufficient", "Not Defined"]),
                    TemplateField(label="Legal & Compliance Framework", type=FieldType.TEXTAREA, placeholder="Legal requirements, regulatory obligations, breach notification laws"),
                ],
                order=1
            ),
            TemplateStep(
                name="Detection & Analysis Capabilities Assessment",
                description="Evaluation of incident detection, analysis, and classification capabilities",
                instructions="Assess the organization's ability to detect, analyze, and classify security incidents effectively.",
                fields=[
                    TemplateField(label="Security Monitoring Coverage", type=FieldType.SELECT, options=["24/7 SOC", "Business Hours Only", "Automated Only", "Limited", "None"]),
                    TemplateField(label="SIEM Implementation", type=FieldType.SELECT, options=["Advanced SIEM", "Basic SIEM", "Log Aggregation", "Manual Review", "None"]),
                    TemplateField(label="Threat Intelligence Integration", type=FieldType.SELECT, options=["Fully Integrated", "Partially Integrated", "Manual Process", "Not Used"]),
                    TemplateField(label="Incident Classification System", type=FieldType.SELECT, options=["Formal Classification", "Basic Classification", "Informal", "None"]),
                    TemplateField(label="Mean Time to Detection (MTTD)", type=FieldType.TEXT, placeholder="Average time to detect incidents"),
                    TemplateField(label="Detection Sources", type=FieldType.TEXTAREA, placeholder="Automated tools, user reports, third-party notifications"),
                    TemplateField(label="False Positive Rate", type=FieldType.SELECT, options=["Low (<10%)", "Medium (10-30%)", "High (30-50%)", "Very High (>50%)"]),
                    TemplateField(label="Forensics Capabilities", type=FieldType.SELECT, options=["In-House Experts", "Basic Capabilities", "Outsourced", "Limited", "None"]),
                    TemplateField(label="Evidence Collection Procedures", type=FieldType.CHECKBOX),
                    TemplateField(label="Analysis Tools & Technologies", type=FieldType.TEXTAREA, placeholder="Forensic tools, malware analysis, network analysis capabilities"),
                ],
                order=2
            ),
            TemplateStep(
                name="Containment & Eradication Assessment",
                description="Evaluation of incident containment and eradication procedures and capabilities",
                instructions="Assess the organization's ability to contain threats and eradicate malicious presence from systems.",
                fields=[
                    TemplateField(label="Containment Strategies", type=FieldType.TEXTAREA, placeholder="Network isolation, system shutdown, account disabling procedures"),
                    TemplateField(label="Network Segmentation Capability", type=FieldType.SELECT, options=["Micro-Segmentation", "Basic Segmentation", "Limited", "None"]),
                    TemplateField(label="Isolation Procedures", type=FieldType.TEXTAREA, placeholder="System isolation, user quarantine, network blocking"),
                    TemplateField(label="Eradication Tools", type=FieldType.TEXTAREA, placeholder="Anti-malware, reimaging, patching capabilities"),
                    TemplateField(label="System Recovery Procedures", type=FieldType.SELECT, options=["Documented & Tested", "Documented", "Informal", "None"]),
                    TemplateField(label="Backup & Restoration", type=FieldType.SELECT, options=["Automated & Tested", "Available", "Limited", "Inadequate"]),
                    TemplateField(label="Mean Time to Containment", type=FieldType.TEXT, placeholder="Average time to contain incidents"),
                    TemplateField(label="Vulnerability Management Integration", type=FieldType.CHECKBOX),
                    TemplateField(label="Patch Management Process", type=FieldType.SELECT, options=["Automated", "Managed", "Manual", "Ad Hoc"]),
                    TemplateField(label="Configuration Management", type=FieldType.SELECT, options=["Automated", "Managed", "Manual", "None"]),
                ],
                order=3
            ),
            TemplateStep(
                name="Communications & Coordination Assessment",
                description="Evaluation of internal and external communication processes during incidents",
                instructions="Assess communication plans, stakeholder coordination, and external notification procedures.",
                fields=[
                    TemplateField(label="Communication Plan Exists", type=FieldType.CHECKBOX),
                    TemplateField(label="Internal Communication Channels", type=FieldType.TEXTAREA, placeholder="Email, phone trees, messaging systems, war rooms"),
                    TemplateField(label="Executive Notification Procedures", type=FieldType.SELECT, options=["Defined Thresholds", "Case by Case", "Informal", "None"]),
                    TemplateField(label="Legal Counsel Integration", type=FieldType.CHECKBOX),
                    TemplateField(label="Law Enforcement Coordination", type=FieldType.SELECT, options=["Established Relationships", "Procedures Defined", "Ad Hoc", "None"]),
                    TemplateField(label="Regulatory Notification Procedures", type=FieldType.CHECKBOX),
                    TemplateField(label="Customer Communication Plan", type=FieldType.SELECT, options=["Comprehensive Plan", "Basic Plan", "Informal", "None"]),
                    TemplateField(label="Media Relations Procedures", type=FieldType.SELECT, options=["Defined Process", "Basic Guidelines", "None"]),
                    TemplateField(label="Third-Party Vendor Coordination", type=FieldType.TEXTAREA, placeholder="Security vendors, cloud providers, managed services"),
                    TemplateField(label="Status Reporting Procedures", type=FieldType.TEXTAREA, placeholder="Regular updates, dashboards, executive briefings"),
                ],
                order=4
            ),
            TemplateStep(
                name="Tabletop Exercise Execution & Evaluation",
                description="Conduct tabletop exercise simulation and evaluate response effectiveness",
                instructions="Execute a realistic incident scenario and evaluate team response, decision-making, and coordination.",
                fields=[
                    TemplateField(label="Scenario Type", type=FieldType.SELECT, options=["Ransomware Attack", "Data Breach", "APT Campaign", "Insider Threat", "DDoS Attack", "Supply Chain Compromise", "Custom Scenario"]),
                    TemplateField(label="Scenario Complexity", type=FieldType.SELECT, options=["Multi-Vector Attack", "Single Vector", "Escalating Incident", "Crisis Scenario"]),
                    TemplateField(label="Exercise Participants", type=FieldType.TEXTAREA, placeholder="IR team, executives, legal, communications, IT, business units"),
                    TemplateField(label="Exercise Duration", type=FieldType.TEXT, placeholder="Duration of tabletop exercise"),
                    TemplateField(label="Decision Points Tested", type=FieldType.TEXTAREA, placeholder="Key decision points and dilemmas presented"),
                    TemplateField(label="Communication Effectiveness", type=FieldType.SELECT, options=["Excellent", "Good", "Fair", "Poor"]),
                    TemplateField(label="Response Time Assessment", type=FieldType.SELECT, options=["Met Objectives", "Partially Met", "Below Expectations"]),
                    TemplateField(label="Coordination Effectiveness", type=FieldType.SELECT, options=["Excellent", "Good", "Fair", "Poor"]),
                    TemplateField(label="Knowledge Gaps Identified", type=FieldType.TEXTAREA, placeholder="Skills, procedures, or knowledge gaps discovered"),
                    TemplateField(label="Resource Constraints", type=FieldType.TEXTAREA, placeholder="Resource limitations or bottlenecks identified"),
                    TemplateField(label="Exercise Lessons Learned", type=FieldType.TEXTAREA, placeholder="Key insights and improvement areas identified"),
                ],
                order=5
            )
        ],
        report_structure=[
            ReportSection(
                title="Incident Response Readiness Assessment",
                content_template="Comprehensive evaluation of incident response program maturity, capabilities, and organizational readiness.",
                order=1
            ),
            ReportSection(
                title="Tabletop Exercise Results & Analysis",
                content_template="Detailed results of tabletop exercise including scenario response, decision-making effectiveness, and team coordination.",
                order=2
            ),
            ReportSection(
                title="Capability Gap Analysis",
                content_template="Analysis of identified gaps in detection, analysis, containment, and communication capabilities.",
                order=3
            ),
            ReportSection(
                title="Response Effectiveness Evaluation",
                content_template="Evaluation of response times, coordination effectiveness, and decision-making quality during the exercise.",
                order=4
            ),
            ReportSection(
                title="Incident Response Improvement Roadmap",
                content_template="Prioritized recommendations for improving incident response capabilities, procedures, and team readiness.",
                order=5
            )
        ]
    )
    
    container_security_template = Template(
        name="Container Security Assessment",
        description="Comprehensive container and orchestration security assessment following CIS benchmarks and NIST guidelines",
        category="Container Security",
        steps=[
            TemplateStep(
                name="Container Infrastructure & Architecture Assessment",
                description="Comprehensive evaluation of container infrastructure and orchestration platform security",
                instructions="Assess container platform architecture, configuration, and overall security posture of the containerized environment.",
                fields=[
                    TemplateField(label="Container Orchestration Platform", type=FieldType.SELECT, options=["Kubernetes", "Docker Swarm", "OpenShift", "Amazon ECS", "Azure Container Instances", "Google Cloud Run", "Nomad", "Rancher"], required=True),
                    TemplateField(label="Container Runtime", type=FieldType.SELECT, options=["Docker", "containerd", "CRI-O", "Podman", "rkt", "gVisor", "Kata Containers"]),
                    TemplateField(label="Cluster Node Count", type=FieldType.NUMBER, placeholder="Total number of nodes in cluster"),
                    TemplateField(label="Namespace Count", type=FieldType.NUMBER, placeholder="Number of namespaces configured"),
                    TemplateField(label="Running Container Count", type=FieldType.NUMBER, placeholder="Total containers currently running"),
                    TemplateField(label="Infrastructure as Code", type=FieldType.SELECT, options=["Terraform", "Ansible", "Helm Charts", "Kustomize", "Manual Configuration", "Mixed"]),
                    TemplateField(label="Container Registry Type", type=FieldType.SELECT, options=["Docker Hub", "Amazon ECR", "Azure Container Registry", "Google Container Registry", "Harbor", "Quay", "Private Registry"]),
                    TemplateField(label="Multi-Tenancy Implementation", type=FieldType.SELECT, options=["Hard Multi-Tenancy", "Soft Multi-Tenancy", "Single Tenant", "Mixed"]),
                    TemplateField(label="Service Mesh Deployed", type=FieldType.SELECT, options=["Istio", "Linkerd", "Consul Connect", "AWS App Mesh", "None"]),
                    TemplateField(label="Infrastructure Assessment Notes", type=FieldType.TEXTAREA, placeholder="Architecture overview, deployment patterns, scaling configuration"),
                ],
                order=1
            ),
            TemplateStep(
                name="Container Image Security Analysis",
                description="Comprehensive container image vulnerability assessment and security scanning",
                instructions="Analyze container images for vulnerabilities, misconfigurations, and security best practices compliance.",
                fields=[
                    TemplateField(label="Image Scanning Tool Used", type=FieldType.SELECT, options=["Clair", "Trivy", "Anchore", "Twistlock/Prisma", "Aqua Security", "Snyk", "Docker Security Scanning", "Multiple Tools"]),
                    TemplateField(label="Total Images Scanned", type=FieldType.NUMBER, placeholder="Number of container images analyzed"),
                    TemplateField(label="Critical Vulnerabilities Found", type=FieldType.NUMBER, placeholder="Critical severity vulnerabilities"),
                    TemplateField(label="High Severity Vulnerabilities", type=FieldType.NUMBER, placeholder="High severity vulnerabilities"),
                    TemplateField(label="Medium Severity Vulnerabilities", type=FieldType.NUMBER, placeholder="Medium severity vulnerabilities"),
                    TemplateField(label="Base Image Analysis", type=FieldType.TEXTAREA, placeholder="Base images used, official vs unofficial sources"),
                    TemplateField(label="Outdated Base Images", type=FieldType.NUMBER, placeholder="Number of images using outdated base images"),
                    TemplateField(label="Secrets in Images", type=FieldType.NUMBER, placeholder="Images containing hardcoded secrets"),
                    TemplateField(label="Malware Detection", type=FieldType.CHECKBOX),
                    TemplateField(label="License Compliance Issues", type=FieldType.NUMBER, placeholder="Images with license compliance issues"),
                    TemplateField(label="Image Signing Verification", type=FieldType.SELECT, options=["All Images Signed", "Partially Signed", "Not Implemented"]),
                    TemplateField(label="Image Provenance Tracking", type=FieldType.SELECT, options=["Full Provenance", "Partial Tracking", "No Tracking"]),
                ],
                order=2
            ),
            TemplateStep(
                name="Runtime Security & Configuration Assessment",
                description="Runtime container security controls and configuration analysis",
                instructions="Evaluate runtime security controls, container configurations, and security policies in the live environment.",
                fields=[
                    TemplateField(label="Privileged Containers Detected", type=FieldType.NUMBER, placeholder="Number of containers running in privileged mode"),
                    TemplateField(label="Root User Containers", type=FieldType.NUMBER, placeholder="Containers running as root user"),
                    TemplateField(label="Security Context Configuration", type=FieldType.SELECT, options=["Properly Configured", "Partially Configured", "Default Settings", "Insecure"]),
                    TemplateField(label="Pod Security Standards", type=FieldType.SELECT, options=["Restricted", "Baseline", "Privileged", "Not Implemented"]),
                    TemplateField(label="AppArmor/SELinux Enforcement", type=FieldType.SELECT, options=["Enforcing", "Permissive", "Disabled", "Mixed"]),
                    TemplateField(label="Resource Limits Configured", type=FieldType.SELECT, options=["All Containers", "Partial Coverage", "Minimal", "None"]),
                    TemplateField(label="Network Policies Implemented", type=FieldType.SELECT, options=["Comprehensive", "Basic", "Limited", "None"]),
                    TemplateField(label="ReadOnly Root Filesystem", type=FieldType.SELECT, options=["Enforced", "Partially Enforced", "Not Enforced"]),
                    TemplateField(label="Capabilities Analysis", type=FieldType.TEXTAREA, placeholder="Excessive capabilities, capability dropping implementation"),
                    TemplateField(label="Runtime Security Tool", type=FieldType.SELECT, options=["Falco", "Sysdig", "Aqua", "Twistlock", "Custom Solution", "None"]),
                    TemplateField(label="Container Breakout Attempts", type=FieldType.CHECKBOX),
                ],
                order=3
            ),
            TemplateStep(
                name="Orchestration Security & Access Control",
                description="Container orchestration platform security and access control evaluation",
                instructions="Assess Kubernetes/orchestration platform security including RBAC, admission controllers, and API security.",
                fields=[
                    TemplateField(label="RBAC Implementation", type=FieldType.SELECT, options=["Least Privilege", "Over-Privileged", "Basic RBAC", "Not Implemented"]),
                    TemplateField(label="Service Account Management", type=FieldType.SELECT, options=["Proper Management", "Some Issues", "Poor Management", "Default Only"]),
                    TemplateField(label="API Server Security", type=FieldType.SELECT, options=["Hardened", "Partially Hardened", "Default Configuration", "Insecure"]),
                    TemplateField(label="Admission Controllers", type=FieldType.TEXTAREA, placeholder="Enabled admission controllers and security policies"),
                    TemplateField(label="Pod Security Admission", type=FieldType.SELECT, options=["Configured", "Partially Configured", "Not Configured"]),
                    TemplateField(label="Network Segmentation", type=FieldType.SELECT, options=["Micro-segmentation", "Basic Segmentation", "Limited", "None"]),
                    TemplateField(label="Secrets Management", type=FieldType.SELECT, options=["External Secrets Manager", "Kubernetes Secrets", "Hardcoded", "Mixed"]),
                    TemplateField(label="Certificate Management", type=FieldType.SELECT, options=["Automated Rotation", "Manual Management", "Default Certs", "Weak Configuration"]),
                    TemplateField(label="Audit Logging Enabled", type=FieldType.CHECKBOX),
                    TemplateField(label="Node Security Configuration", type=FieldType.SELECT, options=["CIS Benchmark Compliant", "Partially Compliant", "Default", "Insecure"]),
                    TemplateField(label="Control Plane Security", type=FieldType.SELECT, options=["Hardened", "Partially Hardened", "Default", "Exposed"]),
                ],
                order=4
            ),
            TemplateStep(
                name="Supply Chain & DevSecOps Integration",
                description="Container supply chain security and CI/CD pipeline integration assessment",
                instructions="Evaluate container supply chain security, CI/CD integration, and DevSecOps practices.",
                fields=[
                    TemplateField(label="CI/CD Pipeline Integration", type=FieldType.SELECT, options=["Full Integration", "Partial Integration", "Manual Process", "No Integration"]),
                    TemplateField(label="Automated Security Scanning", type=FieldType.SELECT, options=["Pre-deployment & Runtime", "Pre-deployment Only", "Manual Only", "None"]),
                    TemplateField(label="Policy as Code Implementation", type=FieldType.SELECT, options=["Comprehensive", "Partial", "Basic", "None"]),
                    TemplateField(label="Image Build Security", type=FieldType.SELECT, options=["Secure Build Process", "Basic Security", "Minimal Security", "Insecure"]),
                    TemplateField(label="Registry Access Controls", type=FieldType.SELECT, options=["Strict Access Control", "Basic Controls", "Limited Controls", "Open Access"]),
                    TemplateField(label="Vulnerability Response Process", type=FieldType.SELECT, options=["Automated Response", "Managed Process", "Manual Process", "No Process"]),
                    TemplateField(label="Compliance Scanning", type=FieldType.SELECT, options=["CIS Benchmarks", "NIST Guidelines", "Custom Standards", "None"]),
                    TemplateField(label="Third-Party Component Scanning", type=FieldType.CHECKBOX),
                    TemplateField(label="Software Bill of Materials (SBOM)", type=FieldType.SELECT, options=["Generated & Tracked", "Generated Only", "Manual Tracking", "Not Implemented"]),
                    TemplateField(label="Supply Chain Risk Assessment", type=FieldType.TEXTAREA, placeholder="Third-party dependencies, base image risks, external registry usage"),
                ],
                order=5
            )
        ],
        report_structure=[
            ReportSection(
                title="Container Security Assessment Summary",
                content_template="Executive summary of container infrastructure security posture, critical findings, and business risk assessment.",
                order=1
            ),
            ReportSection(
                title="Infrastructure & Architecture Security Analysis",
                content_template="Comprehensive analysis of container orchestration platform security, architecture, and configuration.",
                order=2
            ),
            ReportSection(
                title="Container Image Security Evaluation",
                content_template="Detailed assessment of container image vulnerabilities, compliance, and supply chain security.",
                order=3
            ),
            ReportSection(
                title="Runtime Security & Policy Assessment",
                content_template="Analysis of runtime security controls, policies, and container execution environment security.",
                order=4
            ),
            ReportSection(
                title="Access Control & Orchestration Security",
                content_template="Evaluation of RBAC, API security, network policies, and orchestration platform security controls.",
                order=5
            ),
            ReportSection(
                title="Container Security Hardening Roadmap",
                content_template="Prioritized recommendations for container security improvements, policy implementation, and DevSecOps integration.",
                order=6
            )
        ]
    )
    
    devsecops_template = Template(
        name="DevSecOps Security Assessment",
        description="Comprehensive DevSecOps maturity assessment and secure development lifecycle evaluation",
        category="DevSecOps",
        steps=[
            TemplateStep(
                name="DevSecOps Maturity & Culture Assessment",
                description="Organizational DevSecOps maturity and security culture evaluation",
                instructions="Assess the organization's DevSecOps maturity level, security culture, and integration of security practices into development workflows.",
                fields=[
                    TemplateField(label="DevSecOps Maturity Level", type=FieldType.SELECT, options=["Initial/Ad Hoc", "Developing", "Defined", "Managed", "Optimizing"], required=True),
                    TemplateField(label="Security Culture Integration", type=FieldType.SELECT, options=["Fully Integrated", "Moderately Integrated", "Basic Integration", "Siloed"]),
                    TemplateField(label="Development Team Size", type=FieldType.NUMBER, placeholder="Total number of developers"),
                    TemplateField(label="Security Champions Program", type=FieldType.SELECT, options=["Established Program", "Informal Champions", "None"]),
                    TemplateField(label="Security Training Frequency", type=FieldType.SELECT, options=["Continuous", "Quarterly", "Annual", "Ad Hoc", "None"]),
                    TemplateField(label="Secure Coding Standards", type=FieldType.SELECT, options=["Enforced Standards", "Defined Standards", "Informal Guidelines", "None"]),
                    TemplateField(label="Security Metrics Tracking", type=FieldType.SELECT, options=["Comprehensive Metrics", "Basic Metrics", "Limited Tracking", "None"]),
                    TemplateField(label="Cross-Team Collaboration", type=FieldType.SELECT, options=["Excellent", "Good", "Limited", "Minimal"]),
                    TemplateField(label="Security Feedback Loops", type=FieldType.SELECT, options=["Real-time", "Regular", "Periodic", "None"]),
                    TemplateField(label="Risk-Based Security Approach", type=FieldType.SELECT, options=["Risk-Driven", "Partially Risk-Based", "Compliance-Driven", "Ad Hoc"]),
                ],
                order=1
            ),
            TemplateStep(
                name="CI/CD Pipeline Security Assessment",
                description="Comprehensive CI/CD pipeline security controls and integration evaluation",
                instructions="Evaluate security integration throughout the CI/CD pipeline including build security, testing integration, and deployment controls.",
                fields=[
                    TemplateField(label="Primary CI/CD Platform", type=FieldType.SELECT, options=["Jenkins", "GitLab CI/CD", "GitHub Actions", "Azure DevOps", "CircleCI", "Travis CI", "TeamCity", "Bamboo", "Custom Solution"]),
                    TemplateField(label="Pipeline Security Gates", type=FieldType.SELECT, options=["Multi-Stage Gates", "Basic Gates", "Manual Gates", "None"]),
                    TemplateField(label="Build Environment Security", type=FieldType.SELECT, options=["Hardened & Isolated", "Partially Secured", "Basic Security", "Insecure"]),
                    TemplateField(label="Source Code Security", type=FieldType.SELECT, options=["Repository Secured", "Basic Security", "Limited Security", "Insecure"]),
                    TemplateField(label="Secrets Management", type=FieldType.SELECT, options=["Vault Integration", "Platform Secrets", "Environment Variables", "Hardcoded"]),
                    TemplateField(label="Pipeline as Code", type=FieldType.SELECT, options=["Fully Implemented", "Partially Implemented", "Manual Configuration"]),
                    TemplateField(label="Branch Protection Rules", type=FieldType.SELECT, options=["Comprehensive Rules", "Basic Protection", "Limited Rules", "None"]),
                    TemplateField(label="Code Review Requirements", type=FieldType.SELECT, options=["Security-Focused Reviews", "Standard Reviews", "Optional Reviews", "None"]),
                    TemplateField(label="Deployment Automation Security", type=FieldType.SELECT, options=["Zero-Touch Secure", "Automated with Approvals", "Manual Deployment", "Insecure Automation"]),
                    TemplateField(label="Pipeline Monitoring & Logging", type=FieldType.SELECT, options=["Comprehensive", "Basic", "Limited", "None"]),
                ],
                order=2
            ),
            TemplateStep(
                name="Security Testing Integration Assessment",
                description="Security testing tools and automation integration throughout development lifecycle",
                instructions="Evaluate integration and effectiveness of security testing tools including SAST, DAST, IAST, and SCA across development phases.",
                fields=[
                    TemplateField(label="Static Application Security Testing (SAST)", type=FieldType.SELECT, options=["Integrated & Comprehensive", "Basic Integration", "Manual Only", "Not Implemented"]),
                    TemplateField(label="SAST Tools Used", type=FieldType.TEXTAREA, placeholder="SonarQube, Checkmarx, Veracode, Semgrep, CodeQL, etc."),
                    TemplateField(label="Dynamic Application Security Testing (DAST)", type=FieldType.SELECT, options=["Automated in Pipeline", "Manual Testing", "Periodic Testing", "Not Implemented"]),
                    TemplateField(label="DAST Tools Used", type=FieldType.TEXTAREA, placeholder="OWASP ZAP, Burp Suite, Nessus, WebInspect, etc."),
                    TemplateField(label="Interactive Application Security Testing (IAST)", type=FieldType.SELECT, options=["Implemented", "Pilot Program", "Not Implemented"]),
                    TemplateField(label="Software Composition Analysis (SCA)", type=FieldType.SELECT, options=["Comprehensive SCA", "Basic Dependency Check", "Manual Review", "Not Implemented"]),
                    TemplateField(label="SCA Tools Used", type=FieldType.TEXTAREA, placeholder="Snyk, OWASP Dependency-Check, Black Duck, WhiteSource, etc."),
                    TemplateField(label="Container Security Scanning", type=FieldType.SELECT, options=["Integrated Scanning", "Manual Scanning", "Basic Checks", "Not Implemented"]),
                    TemplateField(label="Infrastructure as Code (IaC) Security", type=FieldType.SELECT, options=["Automated Scanning", "Manual Review", "Not Implemented"]),
                    TemplateField(label="Security Test Coverage", type=FieldType.SELECT, options=["Comprehensive (>80%)", "Good (60-80%)", "Moderate (40-60%)", "Low (<40%)"]),
                    TemplateField(label="False Positive Management", type=FieldType.SELECT, options=["Effective Management", "Basic Management", "High False Positives", "No Management"]),
                ],
                order=3
            ),
            TemplateStep(
                name="Vulnerability Management & Response",
                description="Vulnerability management integration and incident response within DevSecOps workflow",
                instructions="Assess vulnerability management processes, remediation workflows, and security incident response integration with development practices.",
                fields=[
                    TemplateField(label="Vulnerability Remediation SLA", type=FieldType.SELECT, options=["Critical: <24h, High: <7d", "Critical: <72h, High: <30d", "Informal Timeline", "No SLA"]),
                    TemplateField(label="Automated Vulnerability Tracking", type=FieldType.SELECT, options=["Full Automation", "Partial Automation", "Manual Tracking", "No Tracking"]),
                    TemplateField(label="Risk-Based Prioritization", type=FieldType.SELECT, options=["CVSS + Business Context", "CVSS Only", "Manual Prioritization", "No Prioritization"]),
                    TemplateField(label="Developer Notification System", type=FieldType.SELECT, options=["Real-time Integration", "Regular Reports", "Manual Communication", "No Notification"]),
                    TemplateField(label="Security Debt Management", type=FieldType.SELECT, options=["Tracked & Managed", "Basic Tracking", "Informal Process", "Not Managed"]),
                    TemplateField(label="Hotfix Process Security", type=FieldType.SELECT, options=["Secure Expedited Process", "Basic Security", "Minimal Security", "No Security"]),
                    TemplateField(label="Third-Party Dependency Updates", type=FieldType.SELECT, options=["Automated with Security", "Manual Updates", "Reactive Updates", "Rarely Updated"]),
                    TemplateField(label="Security Incident Integration", type=FieldType.SELECT, options=["Integrated Response", "Separate Process", "Ad Hoc", "Not Integrated"]),
                    TemplateField(label="Rollback Procedures", type=FieldType.SELECT, options=["Automated & Tested", "Manual Process", "Basic Capability", "None"]),
                    TemplateField(label="Patch Management Automation", type=FieldType.SELECT, options=["Fully Automated", "Partially Automated", "Manual Process", "Ad Hoc"]),
                ],
                order=4
            ),
            TemplateStep(
                name="Compliance & Governance Integration",
                description="Security compliance, governance, and policy enforcement within DevSecOps practices",
                instructions="Evaluate integration of compliance requirements, governance processes, and policy enforcement in development workflows.",
                fields=[
                    TemplateField(label="Compliance Framework Integration", type=FieldType.TEXTAREA, placeholder="SOC2, PCI DSS, HIPAA, ISO 27001, etc."),
                    TemplateField(label="Policy as Code Implementation", type=FieldType.SELECT, options=["Comprehensive", "Partial", "Basic", "Not Implemented"]),
                    TemplateField(label="Automated Compliance Checking", type=FieldType.SELECT, options=["Continuous Monitoring", "Pipeline Gates", "Periodic Checks", "Manual Only"]),
                    TemplateField(label="Audit Trail & Documentation", type=FieldType.SELECT, options=["Automated & Comprehensive", "Partially Automated", "Manual Process", "Minimal"]),
                    TemplateField(label="Change Management Integration", type=FieldType.SELECT, options=["Fully Integrated", "Partially Integrated", "Separate Process", "Ad Hoc"]),
                    TemplateField(label="Risk Assessment Integration", type=FieldType.SELECT, options=["Continuous Risk Assessment", "Feature-based Assessment", "Periodic Assessment", "None"]),
                    TemplateField(label="Data Protection Controls", type=FieldType.SELECT, options=["Automated Controls", "Policy-based", "Manual Process", "Limited"]),
                    TemplateField(label="Regulatory Reporting", type=FieldType.SELECT, options=["Automated Generation", "Semi-automated", "Manual Process", "Ad Hoc"]),
                    TemplateField(label="Security Architecture Review", type=FieldType.SELECT, options=["Integrated in Design", "Separate Review", "Periodic Review", "Not Performed"]),
                    TemplateField(label="Business Continuity Integration", type=FieldType.SELECT, options=["Integrated Planning", "Separate Planning", "Basic Planning", "Not Considered"]),
                ],
                order=5
            )
        ],
        report_structure=[
            ReportSection(
                title="DevSecOps Maturity Assessment Summary",
                content_template="Executive summary of DevSecOps maturity level, security culture integration, and organizational readiness.",
                order=1
            ),
            ReportSection(
                title="CI/CD Pipeline Security Analysis",
                content_template="Comprehensive analysis of CI/CD pipeline security controls, integration points, and automation effectiveness.",
                order=2
            ),
            ReportSection(
                title="Security Testing Integration Evaluation",
                content_template="Assessment of security testing tools integration, coverage, and effectiveness throughout the development lifecycle.",
                order=3
            ),
            ReportSection(
                title="Vulnerability Management & Response Analysis",
                content_template="Evaluation of vulnerability management processes, remediation workflows, and incident response integration.",
                order=4
            ),
            ReportSection(
                title="Compliance & Governance Integration",
                content_template="Analysis of compliance framework integration, policy enforcement, and governance processes within DevSecOps.",
                order=5
            ),
            ReportSection(
                title="DevSecOps Improvement Roadmap",
                content_template="Strategic roadmap for DevSecOps maturity advancement including tool integration, process improvements, and cultural transformation.",
                order=6
            )
        ]
    )
    
    blockchain_template = Template(
        name="Blockchain & Smart Contract Security",
        description="Comprehensive blockchain infrastructure and smart contract security assessment following industry best practices and OWASP guidelines",
        category="Blockchain Security",
        steps=[
            TemplateStep(
                name="Blockchain Infrastructure & Environment Assessment",
                description="Comprehensive evaluation of blockchain infrastructure, nodes, and deployment environment security",
                instructions="Assess the security of blockchain infrastructure including nodes, network configuration, consensus mechanisms, and deployment environment.",
                fields=[
                    TemplateField(label="Blockchain Platform", type=FieldType.SELECT, options=["Ethereum", "Binance Smart Chain", "Polygon", "Solana", "Avalanche", "Cardano", "Polkadot", "Hyperledger Fabric", "Other"], required=True),
                    TemplateField(label="Network Type", type=FieldType.SELECT, options=["Mainnet", "Testnet", "Private Network", "Consortium"], required=True),
                    TemplateField(label="Node Configuration", type=FieldType.SELECT, options=["Full Node", "Light Node", "Archive Node", "Validator Node", "Multiple Types"]),
                    TemplateField(label="Consensus Mechanism", type=FieldType.SELECT, options=["Proof of Work", "Proof of Stake", "Delegated Proof of Stake", "Proof of Authority", "Byzantine Fault Tolerance", "Other"]),
                    TemplateField(label="Node Count Assessment", type=FieldType.NUMBER, placeholder="Number of nodes in assessment scope"),
                    TemplateField(label="Network Security Controls", type=FieldType.TEXTAREA, placeholder="Firewalls, VPNs, network segmentation, access controls"),
                    TemplateField(label="Infrastructure Hosting", type=FieldType.SELECT, options=["Cloud Provider", "On-Premises", "Hybrid", "Third-Party Service"]),
                    TemplateField(label="Key Management System", type=FieldType.SELECT, options=["Hardware Security Module", "Software-based", "Multi-Signature", "Threshold Signature", "Manual Management"]),
                    TemplateField(label="Backup & Recovery Procedures", type=FieldType.SELECT, options=["Automated & Tested", "Manual Process", "Basic Backup", "None"]),
                    TemplateField(label="Monitoring & Alerting", type=FieldType.SELECT, options=["Comprehensive Monitoring", "Basic Monitoring", "Manual Checks", "None"]),
                ],
                order=1
            ),
            TemplateStep(
                name="Smart Contract Architecture & Code Analysis",
                description="Comprehensive smart contract security code review and architectural assessment",
                instructions="Conduct thorough security analysis of smart contract code, architecture, design patterns, and implementation following OWASP Smart Contract Security guidelines.",
                fields=[
                    TemplateField(label="Contract Language", type=FieldType.SELECT, options=["Solidity", "Vyper", "Rust (Solana)", "Move (Aptos/Sui)", "Plutus (Cardano)", "Ink! (Polkadot)", "Other"], required=True),
                    TemplateField(label="Contract Complexity", type=FieldType.SELECT, options=["Simple (Single Contract)", "Moderate (2-5 Contracts)", "Complex (6-20 Contracts)", "Enterprise (20+ Contracts)"]),
                    TemplateField(label="Total Lines of Code", type=FieldType.NUMBER, placeholder="Approximate total lines of smart contract code"),
                    TemplateField(label="Reentrancy Vulnerabilities", type=FieldType.CHECKBOX),
                    TemplateField(label="Integer Overflow/Underflow", type=FieldType.CHECKBOX),
                    TemplateField(label="Access Control Issues", type=FieldType.CHECKBOX),
                    TemplateField(label="Front-Running Vulnerabilities", type=FieldType.CHECKBOX),
                    TemplateField(label="Timestamp Dependence", type=FieldType.CHECKBOX),
                    TemplateField(label="Gas Limit & Loops", type=FieldType.CHECKBOX),
                    TemplateField(label="Unchecked External Calls", type=FieldType.CHECKBOX),
                    TemplateField(label="Denial of Service Vulnerabilities", type=FieldType.CHECKBOX),
                    TemplateField(label="Logic & Business Flow Issues", type=FieldType.CHECKBOX),
                    TemplateField(label="Randomness & Entropy Issues", type=FieldType.CHECKBOX),
                    TemplateField(label="Flash Loan Attack Vectors", type=FieldType.CHECKBOX),
                    TemplateField(label="Oracle Manipulation Risks", type=FieldType.CHECKBOX),
                    TemplateField(label="Critical Vulnerabilities Found", type=FieldType.NUMBER, placeholder="Number of critical security issues"),
                    TemplateField(label="High Severity Issues", type=FieldType.NUMBER, placeholder="Number of high severity vulnerabilities"),
                    TemplateField(label="Code Quality Assessment", type=FieldType.SELECT, options=["Excellent", "Good", "Fair", "Poor"]),
                ],
                order=2
            ),
            TemplateStep(
                name="DeFi Protocol Security Assessment",
                description="Specialized security assessment for DeFi protocols including liquidity, governance, and economic attack vectors",
                instructions="Evaluate DeFi-specific security risks including liquidity risks, governance attacks, economic manipulation, and protocol-level vulnerabilities.",
                fields=[
                    TemplateField(label="Protocol Type", type=FieldType.SELECT, options=["DEX/AMM", "Lending/Borrowing", "Yield Farming", "Staking Protocol", "Insurance Protocol", "Derivatives", "Cross-Chain Bridge", "Other DeFi", "Not Applicable"]),
                    TemplateField(label="Total Value Locked (TVL)", type=FieldType.TEXT, placeholder="Current TVL in USD"),
                    TemplateField(label="Governance Token Implementation", type=FieldType.SELECT, options=["Decentralized Governance", "Multi-Sig Governance", "Admin Controls", "No Governance"]),
                    TemplateField(label="Oracle Dependencies", type=FieldType.TEXTAREA, placeholder="Price oracles, data feeds, external dependencies"),
                    TemplateField(label="Oracle Manipulation Risk", type=FieldType.SELECT, options=["High Risk", "Medium Risk", "Low Risk", "Mitigated"]),
                    TemplateField(label="Flash Loan Integration", type=FieldType.SELECT, options=["Integrated", "Vulnerable", "Protected", "Not Applicable"]),
                    TemplateField(label="Liquidity Risk Assessment", type=FieldType.SELECT, options=["High Risk", "Medium Risk", "Low Risk", "Well-Managed"]),
                    TemplateField(label="Economic Attack Vectors", type=FieldType.TEXTAREA, placeholder="MEV, arbitrage, governance attacks, tokenomics issues"),
                    TemplateField(label="Cross-Chain Security", type=FieldType.SELECT, options=["Secure Implementation", "Some Risks", "High Risk", "Not Applicable"]),
                    TemplateField(label="Emergency Procedures", type=FieldType.SELECT, options=["Comprehensive", "Basic", "Limited", "None"]),
                    TemplateField(label="Slippage Protection", type=FieldType.SELECT, options=["Implemented", "Partial", "None", "Not Applicable"]),
                    TemplateField(label="Governance Attack Resistance", type=FieldType.SELECT, options=["Robust", "Moderate", "Vulnerable", "Not Applicable"]),
                ],
                order=3
            ),
            TemplateStep(
                name="Cryptographic Implementation & Key Security",
                description="Assessment of cryptographic implementations, key management, and signature schemes",
                instructions="Evaluate cryptographic security including signature schemes, key generation, storage, rotation, and multi-signature implementations.",
                fields=[
                    TemplateField(label="Signature Scheme", type=FieldType.SELECT, options=["ECDSA", "EdDSA", "BLS Signatures", "Schnorr Signatures", "Multi-Signature", "Threshold Signatures"]),
                    TemplateField(label="Key Generation Security", type=FieldType.SELECT, options=["Hardware Generation", "Secure Software", "Standard Software", "Unknown"]),
                    TemplateField(label="Private Key Storage", type=FieldType.SELECT, options=["Hardware Wallet", "Cold Storage", "Hot Wallet", "Multi-Signature Wallet", "Custodial Service"]),
                    TemplateField(label="Key Rotation Procedures", type=FieldType.SELECT, options=["Regular Rotation", "Emergency Only", "Manual Process", "Not Implemented"]),
                    TemplateField(label="Multi-Signature Configuration", type=FieldType.TEXT, placeholder="M-of-N signature requirements if applicable"),
                    TemplateField(label="Entropy & Randomness", type=FieldType.SELECT, options=["Cryptographically Secure", "Good Quality", "Questionable", "Poor"]),
                    TemplateField(label="Hash Function Usage", type=FieldType.TEXTAREA, placeholder="SHA-256, Keccak-256, Blake2, etc. and their security"),
                    TemplateField(label="Merkle Tree Implementation", type=FieldType.SELECT, options=["Secure Implementation", "Standard Implementation", "Custom Implementation", "Not Used"]),
                    TemplateField(label="Zero-Knowledge Proof Usage", type=FieldType.SELECT, options=["zk-SNARKs", "zk-STARKs", "Other ZKP", "Not Used"]),
                    TemplateField(label="Cryptographic Vulnerabilities", type=FieldType.TEXTAREA, placeholder="Weak randomness, signature malleability, hash collisions"),
                ],
                order=4
            ),
            TemplateStep(
                name="Tokenomics & Economic Security Analysis",
                description="Economic security assessment including tokenomics, incentives, and economic attack resistance",
                instructions="Analyze token economics, incentive mechanisms, distribution models, and resistance to economic attacks.",
                fields=[
                    TemplateField(label="Token Standard", type=FieldType.SELECT, options=["ERC-20", "ERC-721 (NFT)", "ERC-1155", "BEP-20", "SPL Token", "Custom Standard"]),
                    TemplateField(label="Token Supply Model", type=FieldType.SELECT, options=["Fixed Supply", "Inflationary", "Deflationary", "Elastic Supply", "Hybrid Model"]),
                    TemplateField(label="Token Distribution", type=FieldType.TEXTAREA, placeholder="ICO, IDO, fair launch, team allocation, vesting schedules"),
                    TemplateField(label="Inflation/Deflation Mechanisms", type=FieldType.TEXTAREA, placeholder="Burning, minting, staking rewards, fee structures"),
                    TemplateField(label="Economic Incentive Alignment", type=FieldType.SELECT, options=["Well Aligned", "Mostly Aligned", "Some Misalignment", "Poor Alignment"]),
                    TemplateField(label="Whale Attack Resistance", type=FieldType.SELECT, options=["Robust Protection", "Some Protection", "Limited Protection", "Vulnerable"]),
                    TemplateField(label="Market Manipulation Risk", type=FieldType.SELECT, options=["Low Risk", "Medium Risk", "High Risk", "Critical Risk"]),
                    TemplateField(label="Liquidity Concentration", type=FieldType.SELECT, options=["Well Distributed", "Moderately Concentrated", "Highly Concentrated", "Extreme Concentration"]),
                    TemplateField(label="Governance Token Security", type=FieldType.SELECT, options=["Secure Design", "Some Risks", "High Risk", "Not Applicable"]),
                    TemplateField(label="Staking/Delegation Risks", type=FieldType.TEXTAREA, placeholder="Slashing conditions, centralization risks, validator security"),
                    TemplateField(label="Economic Attack Scenarios", type=FieldType.TEXTAREA, placeholder="51% attacks, long-range attacks, nothing-at-stake problems"),
                ],
                order=5
            ),
            TemplateStep(
                name="Security Testing & Validation",
                description="Comprehensive security testing including automated analysis, formal verification, and penetration testing",
                instructions="Execute comprehensive security testing using automated tools, formal verification methods, and manual penetration testing techniques.",
                fields=[
                    TemplateField(label="Automated Analysis Tools Used", type=FieldType.TEXTAREA, placeholder="MythX, Slither, Oyente, Securify, Manticore, etc."),
                    TemplateField(label="Static Analysis Results", type=FieldType.SELECT, options=["Clean", "Minor Issues", "Major Issues", "Critical Issues"]),
                    TemplateField(label="Dynamic Testing Performed", type=FieldType.CHECKBOX),
                    TemplateField(label="Formal Verification Applied", type=FieldType.SELECT, options=["Comprehensive", "Partial", "Basic", "None"]),
                    TemplateField(label="Fuzz Testing Results", type=FieldType.SELECT, options=["No Issues Found", "Minor Issues", "Major Issues", "Not Performed"]),
                    TemplateField(label="Integration Testing", type=FieldType.SELECT, options=["Comprehensive", "Basic", "Limited", "None"]),
                    TemplateField(label="Testnet Deployment Testing", type=FieldType.CHECKBOX),
                    TemplateField(label="Mainnet Fork Testing", type=FieldType.CHECKBOX),
                    TemplateField(label="Gas Optimization Analysis", type=FieldType.SELECT, options=["Optimized", "Moderate", "Inefficient", "Not Analyzed"]),
                    TemplateField(label="Upgrade Path Testing", type=FieldType.SELECT, options=["Tested & Secure", "Partially Tested", "Not Tested", "Not Upgradeable"]),
                    TemplateField(label="Performance Under Load", type=FieldType.SELECT, options=["Excellent", "Good", "Fair", "Poor", "Not Tested"]),
                    TemplateField(label="External Audit Reports", type=FieldType.TEXTAREA, placeholder="Previous audit findings, responses, and current status"),
                ],
                order=6
            )
        ],
        report_structure=[
            ReportSection(
                title="Blockchain Security Assessment Executive Summary", 
                content_template="Comprehensive overview of blockchain infrastructure and smart contract security posture, highlighting critical risks and business impact.",
                order=1
            ),
            ReportSection(
                title="Infrastructure & Network Security Analysis",
                content_template="Detailed assessment of blockchain infrastructure security including nodes, network configuration, and operational security controls.",
                order=2
            ),
            ReportSection(
                title="Smart Contract Security Evaluation",
                content_template="Comprehensive analysis of smart contract vulnerabilities, code quality, and implementation security across all identified contracts.",
                order=3
            ),
            ReportSection(
                title="DeFi Protocol Security Assessment",
                content_template="Specialized evaluation of DeFi protocol risks including liquidity, governance, oracle dependencies, and economic attack vectors.",
                order=4
            ),
            ReportSection(
                title="Cryptographic & Economic Security Analysis",
                content_template="Assessment of cryptographic implementations, key management security, tokenomics, and economic attack resistance mechanisms.",
                order=5
            ),
            ReportSection(
                title="Security Testing & Validation Results",
                content_template="Results from automated analysis, formal verification, penetration testing, and comprehensive security validation procedures.",
                order=6
            ),
            ReportSection(
                title="Blockchain Security Remediation Roadmap",
                content_template="Prioritized security recommendations including immediate fixes, architectural improvements, and long-term security enhancement strategies.",
                order=7
            )
        ]
    )
    
    supply_chain_template = Template(
        name="Supply Chain Security Assessment",
        description="Comprehensive supply chain security evaluation covering third-party risk management, vendor security, software supply chain, and hardware security following NIST SP 800-161 guidelines",
        category="Supply Chain Security",
        steps=[
            TemplateStep(
                name="Supply Chain Architecture & Dependency Mapping",
                description="Comprehensive mapping and assessment of supply chain architecture, dependencies, and critical pathways",
                instructions="Map the complete supply chain architecture including all vendors, suppliers, software dependencies, hardware components, and critical pathways for business operations.",
                fields=[
                    TemplateField(label="Total Vendor Count", type=FieldType.NUMBER, placeholder="Total number of vendors/suppliers", required=True),
                    TemplateField(label="Critical Vendors Count", type=FieldType.NUMBER, placeholder="Number of business-critical vendors"),
                    TemplateField(label="Tier 1 Suppliers", type=FieldType.NUMBER, placeholder="Direct suppliers count"),
                    TemplateField(label="Tier 2+ Suppliers Visibility", type=FieldType.SELECT, options=["Full Visibility", "Partial Visibility", "Limited Visibility", "No Visibility"]),
                    TemplateField(label="Geographic Distribution", type=FieldType.TEXTAREA, placeholder="Vendor locations, geopolitical risks, regulatory jurisdictions"),
                    TemplateField(label="Supply Chain Complexity", type=FieldType.SELECT, options=["Simple (<10 vendors)", "Moderate (10-50 vendors)", "Complex (50-200 vendors)", "Highly Complex (200+ vendors)"]),
                    TemplateField(label="Single Points of Failure", type=FieldType.NUMBER, placeholder="Critical vendors with no alternatives"),
                    TemplateField(label="Vendor Categorization", type=FieldType.TEXTAREA, placeholder="Software vendors, hardware suppliers, service providers, cloud services"),
                    TemplateField(label="Business Impact Assessment", type=FieldType.SELECT, options=["Comprehensive", "Partially Complete", "Basic", "Not Performed"]),
                    TemplateField(label="Supply Chain Visibility Tools", type=FieldType.SELECT, options=["Comprehensive Platform", "Basic Tools", "Manual Process", "None"]),
                ],
                order=1
            ),
            TemplateStep(
                name="Vendor Security Assessment & Due Diligence",
                description="Comprehensive vendor security posture evaluation and due diligence processes",
                instructions="Assess vendor security capabilities, compliance status, and security controls through questionnaires, audits, and continuous monitoring.",
                fields=[
                    TemplateField(label="Vendor Security Questionnaire Process", type=FieldType.SELECT, options=["Standardized & Comprehensive", "Basic Questionnaire", "Informal Process", "None"], required=True),
                    TemplateField(label="Security Certification Requirements", type=FieldType.TEXTAREA, placeholder="SOC2, ISO 27001, PCI DSS, FedRAMP, etc."),
                    TemplateField(label="Vendors with SOC2 Reports", type=FieldType.NUMBER, placeholder="Number of vendors providing SOC2 Type II"),
                    TemplateField(label="Vendors with ISO 27001", type=FieldType.NUMBER, placeholder="Number of ISO 27001 certified vendors"),
                    TemplateField(label="Security Assessment Frequency", type=FieldType.SELECT, options=["Continuous Monitoring", "Annual", "Bi-Annual", "Ad Hoc", "None"]),
                    TemplateField(label="On-site Security Audits", type=FieldType.SELECT, options=["Regular Audits", "Risk-Based", "Rarely Performed", "Never"]),
                    TemplateField(label="Vendor Risk Scoring", type=FieldType.SELECT, options=["Automated Risk Scoring", "Manual Assessment", "Basic Classification", "No Scoring"]),
                    TemplateField(label="Third-Party Risk Management Platform", type=FieldType.SELECT, options=["Comprehensive Platform", "Basic Tool", "Spreadsheet", "None"]),
                    TemplateField(label="Vendor Security Incidents Tracking", type=FieldType.SELECT, options=["Real-time Monitoring", "Periodic Reports", "Manual Tracking", "Not Tracked"]),
                    TemplateField(label="Contract Security Requirements", type=FieldType.SELECT, options=["Comprehensive Security Terms", "Basic Requirements", "Minimal Terms", "None"]),
                    TemplateField(label="Right to Audit Clauses", type=FieldType.SELECT, options=["All Critical Vendors", "Some Vendors", "Rarely Included", "Never"]),
                ],
                order=2
            ),
            TemplateStep(
                name="Software Supply Chain Security Assessment",
                description="Software supply chain security evaluation including open source, third-party components, and development pipeline security",
                instructions="Evaluate software supply chain security including dependency management, software bill of materials, vulnerability management, and secure development practices.",
                fields=[
                    TemplateField(label="Software Bill of Materials (SBOM)", type=FieldType.SELECT, options=["Comprehensive & Current", "Partially Complete", "Basic SBOM", "Not Maintained"], required=True),
                    TemplateField(label="Open Source Component Tracking", type=FieldType.SELECT, options=["Automated Tracking", "Manual Inventory", "Basic Awareness", "No Tracking"]),
                    TemplateField(label="Third-Party Software Licenses", type=FieldType.SELECT, options=["Fully Managed", "Partially Tracked", "Basic Tracking", "Not Managed"]),
                    TemplateField(label="Vulnerability Scanning for Dependencies", type=FieldType.SELECT, options=["Continuous Scanning", "Regular Scans", "Manual Checks", "None"]),
                    TemplateField(label="Software Composition Analysis (SCA)", type=FieldType.SELECT, options=["Advanced SCA Tools", "Basic SCA", "Manual Process", "None"]),
                    TemplateField(label="Code Signing Verification", type=FieldType.SELECT, options=["All Software Verified", "Critical Software", "Some Verification", "None"]),
                    TemplateField(label="Software Update Management", type=FieldType.SELECT, options=["Automated & Tested", "Managed Process", "Manual Updates", "Ad Hoc"]),
                    TemplateField(label="Package Repository Security", type=FieldType.SELECT, options=["Private Repositories", "Curated Sources", "Public Repositories", "Uncontrolled"]),
                    TemplateField(label="Build Pipeline Security", type=FieldType.SELECT, options=["Secure Pipeline", "Basic Security", "Limited Security", "Insecure"]),
                    TemplateField(label="Software Integrity Verification", type=FieldType.SELECT, options=["Hash Verification", "Digital Signatures", "Basic Checks", "None"]),
                    TemplateField(label="Legacy Software Risk", type=FieldType.SELECT, options=["Well Managed", "Some Risk", "High Risk", "Critical Risk"]),
                ],
                order=3
            ),
            TemplateStep(
                name="Hardware & Infrastructure Supply Chain Security",
                description="Hardware supply chain security assessment including procurement, lifecycle management, and tampering protection",
                instructions="Assess hardware supply chain security including procurement processes, authenticity verification, tampering protection, and lifecycle security management.",
                fields=[
                    TemplateField(label="Hardware Procurement Security", type=FieldType.SELECT, options=["Secure Procurement Process", "Basic Controls", "Limited Controls", "No Controls"]),
                    TemplateField(label="Authorized Vendor Networks", type=FieldType.SELECT, options=["Verified Authorized Dealers", "Mostly Authorized", "Some Direct", "Unknown Sources"]),
                    TemplateField(label="Hardware Authenticity Verification", type=FieldType.SELECT, options=["Comprehensive Verification", "Basic Verification", "Limited Checks", "None"]),
                    TemplateField(label="Counterfeit Hardware Protection", type=FieldType.SELECT, options=["Strong Protection", "Basic Protection", "Limited Protection", "No Protection"]),
                    TemplateField(label="Hardware Tampering Detection", type=FieldType.SELECT, options=["Tamper-Evident Controls", "Basic Detection", "Visual Inspection", "None"]),
                    TemplateField(label="Secure Boot Implementation", type=FieldType.SELECT, options=["Comprehensive", "Partial", "Basic", "Not Implemented"]),
                    TemplateField(label="Hardware Security Modules (HSM)", type=FieldType.SELECT, options=["Certified HSMs", "Commercial HSMs", "Software-based", "None"]),
                    TemplateField(label="Firmware Integrity Verification", type=FieldType.SELECT, options=["Signed Firmware", "Checksum Verification", "Basic Checks", "None"]),
                    TemplateField(label="Hardware Lifecycle Management", type=FieldType.SELECT, options=["Comprehensive Lifecycle", "Basic Management", "Limited Tracking", "Ad Hoc"]),
                    TemplateField(label="End-of-Life Hardware Security", type=FieldType.SELECT, options=["Secure Disposal", "Basic Sanitization", "Physical Destruction", "Unclear Process"]),
                    TemplateField(label="Critical Hardware Dependencies", type=FieldType.TEXTAREA, placeholder="Single source components, critical hardware with no alternatives"),
                ],
                order=4
            ),
            TemplateStep(
                name="Supply Chain Risk Management & Governance",
                description="Supply chain risk governance, incident response, and business continuity assessment",
                instructions="Evaluate supply chain risk management governance, incident response procedures, business continuity planning, and regulatory compliance.",
                fields=[
                    TemplateField(label="Supply Chain Risk Governance", type=FieldType.SELECT, options=["Comprehensive Framework", "Basic Governance", "Informal Process", "None"]),
                    TemplateField(label="Risk Assessment Methodology", type=FieldType.SELECT, options=["Quantitative Risk Model", "Qualitative Assessment", "Basic Scoring", "None"]),
                    TemplateField(label="Supply Chain Incident Response", type=FieldType.SELECT, options=["Dedicated IR Plan", "General IR Plan", "Basic Procedures", "None"]),
                    TemplateField(label="Vendor Incident Notification", type=FieldType.SELECT, options=["Real-time Notification", "SLA-based", "Manual Process", "None"]),
                    TemplateField(label="Business Continuity Planning", type=FieldType.SELECT, options=["Comprehensive BCP", "Basic Planning", "Limited Planning", "None"]),
                    TemplateField(label="Alternative Vendor Strategy", type=FieldType.SELECT, options=["Multi-vendor Strategy", "Some Alternatives", "Limited Options", "Single Source"]),
                    TemplateField(label="Supply Chain Insurance", type=FieldType.SELECT, options=["Comprehensive Coverage", "Basic Coverage", "Limited Coverage", "None"]),
                    TemplateField(label="Regulatory Compliance", type=FieldType.TEXTAREA, placeholder="GDPR, SOX, HIPAA, export controls, industry-specific regulations"),
                    TemplateField(label="Geopolitical Risk Assessment", type=FieldType.SELECT, options=["Regular Assessment", "Periodic Review", "Basic Awareness", "Not Considered"]),
                    TemplateField(label="Supply Chain Transparency", type=FieldType.SELECT, options=["Full Transparency", "Good Visibility", "Limited Visibility", "Poor Visibility"]),
                    TemplateField(label="Vendor Performance Monitoring", type=FieldType.SELECT, options=["Continuous Monitoring", "Regular Reviews", "Annual Reviews", "None"]),
                    TemplateField(label="Contract Management", type=FieldType.SELECT, options=["Centralized & Automated", "Managed Process", "Decentralized", "Ad Hoc"]),
                ],
                order=5
            )
        ],
        report_structure=[
            ReportSection(
                title="Supply Chain Security Assessment Executive Summary",
                content_template="Comprehensive overview of supply chain security posture, critical risks, and business impact assessment across all vendor relationships and dependencies.",
                order=1
            ),
            ReportSection(
                title="Supply Chain Architecture & Risk Landscape",
                content_template="Detailed analysis of supply chain architecture, dependency mapping, critical pathways, and single points of failure assessment.",
                order=2
            ),
            ReportSection(
                title="Vendor Security & Due Diligence Analysis",
                content_template="Comprehensive evaluation of vendor security postures, certification status, assessment processes, and security compliance across all vendor relationships.",
                order=3
            ),
            ReportSection(
                title="Software Supply Chain Security Evaluation",
                content_template="Assessment of software supply chain security including SBOM management, dependency tracking, vulnerability management, and secure development practices.",
                order=4
            ),
            ReportSection(
                title="Hardware & Infrastructure Supply Chain Security",
                content_template="Analysis of hardware procurement security, authenticity verification, tampering protection, and infrastructure supply chain risk management.",
                order=5
            ),
            ReportSection(
                title="Supply Chain Risk Management & Governance",
                content_template="Evaluation of supply chain risk governance frameworks, incident response capabilities, business continuity planning, and regulatory compliance.",
                order=6
            ),
            ReportSection(
                title="Supply Chain Security Enhancement Roadmap",
                content_template="Strategic recommendations for supply chain security improvements including vendor management enhancements, risk mitigation strategies, and governance improvements.",
                order=7
            )
        ]
    )
    
    # Additional templates to reach 25+
    email_security_template = Template(
        name="Email Security Assessment",
        description="Comprehensive email infrastructure security assessment including authentication protocols, anti-phishing controls, encryption, and compliance evaluation",
        category="Email Security",
        steps=[
            TemplateStep(
                name="Email Infrastructure & Architecture Assessment",
                description="Comprehensive evaluation of email infrastructure, architecture, and deployment security",
                instructions="Assess email infrastructure security including mail servers, routing, DNS configuration, and overall architecture security posture.",
                fields=[
                    TemplateField(label="Email Platform Type", type=FieldType.SELECT, options=["Microsoft Exchange", "Office 365", "Google Workspace", "On-Premises SMTP", "Hybrid Setup", "Third-Party Service", "Other"], required=True),
                    TemplateField(label="Email Server Count", type=FieldType.NUMBER, placeholder="Number of email servers in scope"),
                    TemplateField(label="User Mailbox Count", type=FieldType.NUMBER, placeholder="Total number of user mailboxes"),
                    TemplateField(label="Email Traffic Volume", type=FieldType.SELECT, options=["High (10k+ daily)", "Medium (1k-10k daily)", "Low (<1k daily)", "Unknown"]),
                    TemplateField(label="Infrastructure Hosting", type=FieldType.SELECT, options=["Cloud-Only", "On-Premises", "Hybrid Cloud", "Multi-Cloud"]),
                    TemplateField(label="Email Routing Security", type=FieldType.SELECT, options=["Secure Routing", "Basic Security", "Limited Security", "Insecure"]),
                    TemplateField(label="Load Balancer Configuration", type=FieldType.SELECT, options=["Properly Configured", "Basic Setup", "Misconfigured", "Not Used"]),
                    TemplateField(label="High Availability Setup", type=FieldType.SELECT, options=["Redundant & Tested", "Basic Redundancy", "Limited Failover", "Single Point of Failure"]),
                    TemplateField(label="Backup & Recovery", type=FieldType.SELECT, options=["Automated & Tested", "Basic Backup", "Manual Process", "Inadequate"]),
                    TemplateField(label="Monitoring & Alerting", type=FieldType.SELECT, options=["Comprehensive", "Basic Monitoring", "Limited", "None"]),
                ],
                order=1
            ),
            TemplateStep(
                name="Email Authentication & Anti-Spoofing Assessment",
                description="Comprehensive evaluation of email authentication protocols and anti-spoofing mechanisms",
                instructions="Assess implementation and effectiveness of SPF, DKIM, DMARC, and other email authentication protocols to prevent spoofing and improve deliverability.",
                fields=[
                    TemplateField(label="SPF Record Configuration", type=FieldType.SELECT, options=["Properly Configured", "Misconfigured", "Overly Permissive", "Not Implemented"], required=True),
                    TemplateField(label="SPF Record Complexity", type=FieldType.SELECT, options=["Optimized", "Complex but Valid", "Near DNS Limit", "Exceeds Limits"]),
                    TemplateField(label="DKIM Implementation", type=FieldType.SELECT, options=["Properly Configured", "Partially Configured", "Misconfigured", "Not Implemented"], required=True),
                    TemplateField(label="DKIM Key Management", type=FieldType.SELECT, options=["Automated Rotation", "Manual Management", "Static Keys", "Not Managed"]),
                    TemplateField(label="DMARC Policy Status", type=FieldType.SELECT, options=["Reject Policy", "Quarantine Policy", "None Policy", "Not Implemented"], required=True),
                    TemplateField(label="DMARC Alignment", type=FieldType.SELECT, options=["Strict Alignment", "Relaxed Alignment", "Mixed", "Not Aligned"]),
                    TemplateField(label="DMARC Reporting Analysis", type=FieldType.SELECT, options=["Regular Analysis", "Periodic Review", "Basic Monitoring", "Not Monitored"]),
                    TemplateField(label="BIMI Implementation", type=FieldType.SELECT, options=["Implemented", "Pilot", "Planned", "Not Implemented"]),
                    TemplateField(label="ARC (Authenticated Received Chain)", type=FieldType.SELECT, options=["Implemented", "Partial", "Not Implemented"]),
                    TemplateField(label="Domain Spoofing Tests", type=FieldType.CHECKBOX),
                    TemplateField(label="Subdomain Protection", type=FieldType.SELECT, options=["Comprehensive", "Partial", "Limited", "None"]),
                ],
                order=2
            ),
            TemplateStep(
                name="Anti-Phishing & Threat Protection Assessment",
                description="Comprehensive evaluation of anti-phishing controls, threat detection, and email security gateways",
                instructions="Assess anti-phishing technologies, threat detection capabilities, email security gateways, and advanced threat protection mechanisms.",
                fields=[
                    TemplateField(label="Email Security Gateway", type=FieldType.SELECT, options=["Advanced Gateway", "Basic Gateway", "Cloud-based", "Built-in Only", "None"]),
                    TemplateField(label="Anti-Phishing Technology", type=FieldType.SELECT, options=["AI/ML-based", "Signature-based", "Heuristic Analysis", "Basic Filtering", "None"]),
                    TemplateField(label="URL Rewriting/Sandboxing", type=FieldType.SELECT, options=["Comprehensive", "Basic", "Limited", "Not Implemented"]),
                    TemplateField(label="Attachment Sandboxing", type=FieldType.SELECT, options=["Advanced Sandboxing", "Basic Analysis", "Static Analysis", "None"]),
                    TemplateField(label="Safe Links/Attachments", type=FieldType.SELECT, options=["Comprehensive Protection", "Basic Protection", "Limited", "Not Implemented"]),
                    TemplateField(label="Impersonation Protection", type=FieldType.SELECT, options=["Advanced Protection", "Basic Detection", "Limited", "None"]),
                    TemplateField(label="Business Email Compromise (BEC) Protection", type=FieldType.SELECT, options=["Specialized BEC Protection", "General Protection", "Basic", "None"]),
                    TemplateField(label="Zero-Day Threat Protection", type=FieldType.SELECT, options=["Advanced Zero-Day", "Heuristic Analysis", "Basic", "None"]),
                    TemplateField(label="Threat Intelligence Integration", type=FieldType.SELECT, options=["Multiple Sources", "Single Source", "Basic", "None"]),
                    TemplateField(label="User Reporting Mechanism", type=FieldType.SELECT, options=["Easy Reporting Button", "Email Forwarding", "Manual Process", "None"]),
                    TemplateField(label="Incident Response Integration", type=FieldType.SELECT, options=["Automated Response", "Manual Process", "Limited Integration", "None"]),
                ],
                order=3
            ),
            TemplateStep(
                name="Email Encryption & Data Protection Assessment",
                description="Email encryption implementation, data loss prevention, and privacy protection evaluation",
                instructions="Assess email encryption capabilities, data loss prevention controls, and compliance with data protection regulations.",
                fields=[
                    TemplateField(label="Transport Encryption (TLS)", type=FieldType.SELECT, options=["Enforced TLS 1.3", "TLS 1.2 Required", "Opportunistic TLS", "Not Enforced"]),
                    TemplateField(label="End-to-End Encryption", type=FieldType.SELECT, options=["Standard Practice", "Available Option", "Manual Process", "Not Available"]),
                    TemplateField(label="S/MIME Implementation", type=FieldType.SELECT, options=["Organization-wide", "Department-level", "Individual Use", "Not Used"]),
                    TemplateField(label="PGP/GPG Usage", type=FieldType.SELECT, options=["Widely Used", "Limited Use", "Individual Basis", "Not Used"]),
                    TemplateField(label="Data Loss Prevention (DLP)", type=FieldType.SELECT, options=["Comprehensive DLP", "Basic DLP", "Limited Rules", "Not Implemented"]),
                    TemplateField(label="Sensitive Data Detection", type=FieldType.SELECT, options=["Advanced Detection", "Basic Patterns", "Limited", "None"]),
                    TemplateField(label="Email Archiving Security", type=FieldType.SELECT, options=["Secure Archiving", "Basic Archiving", "Limited Security", "Not Implemented"]),
                    TemplateField(label="Email Retention Policies", type=FieldType.SELECT, options=["Automated Policies", "Manual Management", "Basic Retention", "No Policies"]),
                    TemplateField(label="Rights Management (IRM)", type=FieldType.SELECT, options=["Comprehensive IRM", "Basic Rights", "Limited", "Not Used"]),
                    TemplateField(label="Cross-Border Data Transfer", type=FieldType.SELECT, options=["Compliant Transfer", "Some Controls", "Limited Controls", "Uncontrolled"]),
                    TemplateField(label="Compliance Integration", type=FieldType.TEXTAREA, placeholder="GDPR, HIPAA, SOX, PCI DSS compliance features"),
                ],
                order=4
            ),
            TemplateStep(
                name="User Security & Awareness Assessment",
                description="Email security awareness, training effectiveness, and user behavior analysis",
                instructions="Evaluate user security awareness programs, training effectiveness, simulated phishing results, and user behavior patterns.",
                fields=[
                    TemplateField(label="Security Awareness Training", type=FieldType.SELECT, options=["Regular Comprehensive", "Annual Training", "Basic Training", "None"]),
                    TemplateField(label="Phishing Simulation Program", type=FieldType.SELECT, options=["Regular Simulations", "Periodic Tests", "One-time", "None"]),
                    TemplateField(label="Phishing Simulation Click Rate", type=FieldType.SELECT, options=["<5%", "5-15%", "15-25%", ">25%", "Not Measured"]),
                    TemplateField(label="User Reporting Rate", type=FieldType.SELECT, options=[">50%", "25-50%", "10-25%", "<10%", "Not Tracked"]),
                    TemplateField(label="Training Effectiveness Metrics", type=FieldType.SELECT, options=["Comprehensive Metrics", "Basic Tracking", "Limited Data", "Not Measured"]),
                    TemplateField(label="Targeted Training Programs", type=FieldType.SELECT, options=["Risk-based Training", "Role-based Training", "General Training", "None"]),
                    TemplateField(label="Email Security Policies", type=FieldType.SELECT, options=["Comprehensive & Updated", "Basic Policies", "Outdated", "None"]),
                    TemplateField(label="Policy Compliance Monitoring", type=FieldType.SELECT, options=["Automated Monitoring", "Periodic Audits", "Manual Checks", "None"]),
                    TemplateField(label="User Behavior Analytics", type=FieldType.SELECT, options=["Advanced Analytics", "Basic Monitoring", "Limited Tracking", "None"]),
                    TemplateField(label="Privileged User Controls", type=FieldType.SELECT, options=["Enhanced Controls", "Standard Controls", "Basic", "None"]),
                    TemplateField(label="Mobile Email Security", type=FieldType.SELECT, options=["Comprehensive Protection", "Basic Security", "Limited", "Unmanaged"]),
                ],
                order=5
            ),
            TemplateStep(
                name="Email Security Monitoring & Incident Response",
                description="Email security monitoring capabilities, incident detection, and response procedures assessment",
                instructions="Assess email security monitoring tools, incident detection capabilities, response procedures, and forensic analysis capabilities.",
                fields=[
                    TemplateField(label="Email Security Monitoring", type=FieldType.SELECT, options=["Real-time Monitoring", "Regular Reviews", "Basic Logs", "Limited Monitoring"]),
                    TemplateField(label="Security Information Integration", type=FieldType.SELECT, options=["SIEM Integration", "Log Aggregation", "Manual Correlation", "Isolated"]),
                    TemplateField(label="Threat Hunting Capabilities", type=FieldType.SELECT, options=["Proactive Hunting", "Reactive Analysis", "Basic Investigation", "None"]),
                    TemplateField(label="Email Forensics Tools", type=FieldType.SELECT, options=["Advanced Tools", "Basic Capabilities", "Manual Process", "Limited"]),
                    TemplateField(label="Incident Detection Time", type=FieldType.SELECT, options=["<1 Hour", "1-24 Hours", "1-7 Days", ">7 Days", "Unknown"]),
                    TemplateField(label="Incident Response Procedures", type=FieldType.SELECT, options=["Comprehensive Plan", "Basic Procedures", "Informal Process", "None"]),
                    TemplateField(label="Automated Response Actions", type=FieldType.SELECT, options=["Advanced Automation", "Basic Automation", "Manual Only", "None"]),
                    TemplateField(label="Breach Notification Procedures", type=FieldType.SELECT, options=["Automated Process", "Defined Procedures", "Manual Process", "Ad Hoc"]),
                    TemplateField(label="Email Security Metrics", type=FieldType.SELECT, options=["Comprehensive Dashboard", "Basic Metrics", "Limited Reporting", "None"]),
                    TemplateField(label="Regular Security Reviews", type=FieldType.SELECT, options=["Monthly Reviews", "Quarterly Reviews", "Annual Reviews", "Ad Hoc"]),
                    TemplateField(label="External Threat Intelligence", type=FieldType.SELECT, options=["Multiple Sources", "Single Source", "Basic Feeds", "None"]),
                ],
                order=6
            )
        ],
        report_structure=[
            ReportSection(
                title="Email Security Assessment Executive Summary",
                content_template="Comprehensive overview of email security posture including infrastructure security, threat protection effectiveness, and compliance status.",
                order=1
            ),
            ReportSection(
                title="Email Infrastructure & Architecture Security",
                content_template="Detailed assessment of email infrastructure security, architecture design, and operational security controls.",
                order=2
            ),
            ReportSection(
                title="Email Authentication & Anti-Spoofing Analysis",
                content_template="Comprehensive evaluation of SPF, DKIM, DMARC implementation and effectiveness in preventing email spoofing and improving deliverability.",
                order=3
            ),
            ReportSection(
                title="Anti-Phishing & Threat Protection Evaluation",
                content_template="Assessment of anti-phishing technologies, threat detection capabilities, and advanced threat protection mechanisms.",
                order=4
            ),
            ReportSection(
                title="Email Encryption & Data Protection Analysis",
                content_template="Evaluation of email encryption implementations, data loss prevention controls, and compliance with data protection regulations.",
                order=5
            ),
            ReportSection(
                title="User Security Awareness & Behavior Assessment",
                content_template="Analysis of security awareness programs, phishing simulation results, user behavior patterns, and training effectiveness.",
                order=6
            ),
            ReportSection(
                title="Email Security Monitoring & Response Capabilities",
                content_template="Assessment of monitoring capabilities, incident detection and response procedures, and forensic analysis capabilities.",
                order=7
            ),
            ReportSection(
                title="Email Security Enhancement Roadmap",
                content_template="Strategic recommendations for email security improvements including technology upgrades, process enhancements, and user awareness programs.",
                order=8
            )
        ]
    )
    
    dns_security_template = Template(
        name="DNS Security Assessment",
        description="Comprehensive DNS infrastructure security assessment including configuration analysis, threat protection, and resilience evaluation following DNS security best practices",
        category="DNS Security",
        steps=[
            TemplateStep(
                name="DNS Infrastructure & Architecture Assessment",
                description="Comprehensive evaluation of DNS infrastructure, architecture, and deployment security",
                instructions="Assess DNS infrastructure security including server deployment, network architecture, redundancy, and overall DNS ecosystem security.",
                fields=[
                    TemplateField(label="Primary DNS Server Type", type=FieldType.SELECT, options=["BIND", "Microsoft DNS", "PowerDNS", "Unbound", "Cloudflare", "Route 53", "Google Cloud DNS", "Azure DNS", "Other"], required=True),
                    TemplateField(label="DNS Server Count", type=FieldType.NUMBER, placeholder="Number of DNS servers in deployment"),
                    TemplateField(label="DNS Architecture", type=FieldType.SELECT, options=["Hierarchical", "Distributed", "Hybrid", "Single Server", "Cloud-managed"]),
                    TemplateField(label="Authoritative DNS Setup", type=FieldType.SELECT, options=["Multiple Providers", "Single Provider", "Self-Hosted", "Hybrid Setup"]),
                    TemplateField(label="Recursive DNS Setup", type=FieldType.SELECT, options=["Internal Recursive", "Forwarder Setup", "Cloud-based", "Mixed Configuration"]),
                    TemplateField(label="Geographic Distribution", type=FieldType.SELECT, options=["Global Distribution", "Regional", "Single Location", "Limited Distribution"]),
                    TemplateField(label="Load Balancing", type=FieldType.SELECT, options=["Advanced Load Balancing", "Basic Round Robin", "Single Server", "Manual Failover"]),
                    TemplateField(label="High Availability", type=FieldType.SELECT, options=["Redundant & Tested", "Basic Redundancy", "Limited Failover", "No Redundancy"]),
                    TemplateField(label="Network Segmentation", type=FieldType.SELECT, options=["Properly Segmented", "Basic Segmentation", "Limited", "No Segmentation"]),
                    TemplateField(label="Monitoring & Alerting", type=FieldType.SELECT, options=["Comprehensive", "Basic Monitoring", "Limited", "None"]),
                ],
                order=1
            ),
            TemplateStep(
                name="DNS Configuration Security Analysis",
                description="Detailed DNS server configuration and security controls assessment",
                instructions="Analyze DNS server configurations, security settings, access controls, and administrative security measures.",
                fields=[
                    TemplateField(label="DNS Server Version", type=FieldType.TEXT, placeholder="DNS server version and patch level"),
                    TemplateField(label="Configuration Security", type=FieldType.SELECT, options=["Hardened Configuration", "Partially Hardened", "Default Configuration", "Insecure"], required=True),
                    TemplateField(label="Zone Transfer Restrictions", type=FieldType.SELECT, options=["Restricted to Authorized", "Some Restrictions", "Minimal Restrictions", "Open Transfers"]),
                    TemplateField(label="Recursive Query Controls", type=FieldType.SELECT, options=["Restricted Access", "ACL-based", "Open Recursive", "Disabled"]),
                    TemplateField(label="Administrative Access Security", type=FieldType.SELECT, options=["Strong Authentication", "Basic Security", "Weak Controls", "No Controls"]),
                    TemplateField(label="Logging Configuration", type=FieldType.SELECT, options=["Comprehensive Logging", "Basic Logging", "Limited Logging", "Minimal Logging"]),
                    TemplateField(label="Cache Poisoning Protection", type=FieldType.SELECT, options=["Strong Protection", "Basic Protection", "Limited Protection", "Vulnerable"]),
                    TemplateField(label="Rate Limiting", type=FieldType.SELECT, options=["Comprehensive Limits", "Basic Limits", "Some Limits", "No Limits"]),
                    TemplateField(label="Response Rate Limiting (RRL)", type=FieldType.SELECT, options=["Implemented", "Partial", "Basic", "Not Implemented"]),
                    TemplateField(label="IPv6 Configuration", type=FieldType.SELECT, options=["Secure IPv6", "Basic IPv6", "Mixed", "IPv4 Only"]),
                    TemplateField(label="Access Control Lists (ACLs)", type=FieldType.SELECT, options=["Comprehensive ACLs", "Basic ACLs", "Limited", "None"]),
                ],
                order=2
            ),
            TemplateStep(
                name="DNSSEC Implementation & PKI Security Assessment",
                description="DNS Security Extensions (DNSSEC) implementation and cryptographic security evaluation",
                instructions="Assess DNSSEC implementation including key management, signing processes, chain of trust, and overall cryptographic security.",
                fields=[
                    TemplateField(label="DNSSEC Implementation Status", type=FieldType.SELECT, options=["Fully Implemented", "Partially Implemented", "Pilot Phase", "Not Implemented"], required=True),
                    TemplateField(label="DNSSEC Algorithm", type=FieldType.SELECT, options=["RSA/SHA-256 (8)", "ECDSA P-256/SHA-256 (13)", "ECDSA P-384/SHA-384 (14)", "Ed25519 (15)", "Legacy Algorithm", "Multiple"]),
                    TemplateField(label="Key Signing Key (KSK) Management", type=FieldType.SELECT, options=["HSM-based", "Secure Software", "Manual Process", "Not Implemented"]),
                    TemplateField(label="Zone Signing Key (ZSK) Management", type=FieldType.SELECT, options=["Automated Rotation", "Manual Rotation", "Static Keys", "Not Implemented"]),
                    TemplateField(label="Key Rollover Procedures", type=FieldType.SELECT, options=["Automated & Tested", "Manual Process", "Emergency Only", "No Procedures"]),
                    TemplateField(label="DS Record Management", type=FieldType.SELECT, options=["Automated Management", "Manual Process", "Inconsistent", "Not Managed"]),
                    TemplateField(label="Chain of Trust Validation", type=FieldType.SELECT, options=["Complete Chain", "Partial Chain", "Broken Links", "No Validation"]),
                    TemplateField(label="NSEC/NSEC3 Implementation", type=FieldType.SELECT, options=["NSEC3 with Salt", "NSEC3", "NSEC", "Not Configured"]),
                    TemplateField(label="DNSSEC Validation", type=FieldType.SELECT, options=["Strict Validation", "Permissive", "Optional", "Disabled"]),
                    TemplateField(label="Key Backup & Recovery", type=FieldType.SELECT, options=["Secure Backup Process", "Basic Backup", "Manual Process", "No Backup"]),
                    TemplateField(label="Emergency Key Procedures", type=FieldType.SELECT, options=["Documented Procedures", "Basic Process", "Informal", "None"]),
                ],
                order=3
            ),
            TemplateStep(
                name="DNS Threat Protection & Resilience Assessment",
                description="DNS threat protection mechanisms and infrastructure resilience evaluation",
                instructions="Assess DNS threat protection capabilities including DDoS protection, filtering, threat intelligence integration, and overall infrastructure resilience.",
                fields=[
                    TemplateField(label="DDoS Protection", type=FieldType.SELECT, options=["Advanced DDoS Protection", "Basic Protection", "Limited Protection", "No Protection"]),
                    TemplateField(label="DNS Amplification Mitigation", type=FieldType.SELECT, options=["Comprehensive Mitigation", "Basic Mitigation", "Some Controls", "Vulnerable"]),
                    TemplateField(label="DNS Filtering/Blocking", type=FieldType.SELECT, options=["Advanced Filtering", "Basic Filtering", "Manual Lists", "None"]),
                    TemplateField(label="Malware Domain Blocking", type=FieldType.SELECT, options=["Real-time Blocking", "Regular Updates", "Static Lists", "None"]),
                    TemplateField(label="Threat Intelligence Integration", type=FieldType.SELECT, options=["Multiple Sources", "Single Source", "Basic Feeds", "None"]),
                    TemplateField(label="DNS Tunneling Detection", type=FieldType.SELECT, options=["Advanced Detection", "Basic Detection", "Manual Analysis", "None"]),
                    TemplateField(label="Anomaly Detection", type=FieldType.SELECT, options=["ML-based Detection", "Threshold-based", "Manual Review", "None"]),
                    TemplateField(label="DNS Firewall", type=FieldType.SELECT, options=["Advanced DNS Firewall", "Basic Filtering", "ACL-based", "None"]),
                    TemplateField(label="Botnet Detection", type=FieldType.SELECT, options=["Automated Detection", "Signature-based", "Manual Analysis", "None"]),
                    TemplateField(label="DNS Privacy Protection", type=FieldType.SELECT, options=["DNS over HTTPS/TLS", "Basic Encryption", "Some Privacy", "No Privacy"]),
                    TemplateField(label="Query Logging Analysis", type=FieldType.SELECT, options=["Automated Analysis", "Regular Review", "Basic Logging", "No Analysis"]),
                ],
                order=4
            ),
            TemplateStep(
                name="DNS Performance & Availability Assessment",
                description="DNS performance optimization and availability assurance evaluation",
                instructions="Assess DNS performance characteristics, response times, availability metrics, and optimization measures.",
                fields=[
                    TemplateField(label="DNS Response Time", type=FieldType.SELECT, options=["<10ms", "10-50ms", "50-100ms", ">100ms", "Not Measured"]),
                    TemplateField(label="Query Success Rate", type=FieldType.SELECT, options=["99.99%+", "99.9-99.99%", "99-99.9%", "<99%", "Unknown"]),
                    TemplateField(label="Cache Configuration", type=FieldType.SELECT, options=["Optimized Caching", "Standard Caching", "Limited Caching", "No Caching"]),
                    TemplateField(label="TTL Management", type=FieldType.SELECT, options=["Optimized TTLs", "Standard TTLs", "Mixed Settings", "Default Values"]),
                    TemplateField(label="Anycast Implementation", type=FieldType.SELECT, options=["Global Anycast", "Regional Anycast", "Limited", "Not Implemented"]),
                    TemplateField(label="DNS Load Testing", type=FieldType.SELECT, options=["Regular Testing", "Periodic Testing", "One-time", "Never"]),
                    TemplateField(label="Capacity Planning", type=FieldType.SELECT, options=["Proactive Planning", "Reactive Planning", "Basic Planning", "No Planning"]),
                    TemplateField(label="Service Level Agreements", type=FieldType.SELECT, options=["Defined SLAs", "Informal Goals", "Basic Targets", "None"]),
                    TemplateField(label="Disaster Recovery", type=FieldType.SELECT, options=["Tested DR Plan", "Basic DR Plan", "Informal Process", "No DR"]),
                    TemplateField(label="Performance Monitoring", type=FieldType.SELECT, options=["Real-time Monitoring", "Regular Monitoring", "Basic Checks", "No Monitoring"]),
                    TemplateField(label="Geographic Performance", type=FieldType.SELECT, options=["Global Optimization", "Regional", "Limited", "Single Location"]),
                ],
                order=5
            ),
            TemplateStep(
                name="DNS Security Monitoring & Incident Response",
                description="DNS security monitoring capabilities and incident response procedures assessment",
                instructions="Evaluate DNS security monitoring tools, incident detection capabilities, response procedures, and forensic analysis capabilities.",
                fields=[
                    TemplateField(label="DNS Security Monitoring", type=FieldType.SELECT, options=["Real-time Monitoring", "Regular Analysis", "Basic Logging", "Limited Monitoring"]),
                    TemplateField(label="SIEM Integration", type=FieldType.SELECT, options=["Full SIEM Integration", "Partial Integration", "Log Forwarding", "No Integration"]),
                    TemplateField(label="Automated Alerting", type=FieldType.SELECT, options=["Intelligent Alerting", "Threshold-based", "Basic Alerts", "No Alerting"]),
                    TemplateField(label="Incident Response Plan", type=FieldType.SELECT, options=["DNS-specific IR Plan", "General IR Plan", "Basic Procedures", "None"]),
                    TemplateField(label="Forensic Capabilities", type=FieldType.SELECT, options=["Advanced Forensics", "Basic Analysis", "Log Review", "Limited"]),
                    TemplateField(label="Threat Hunting", type=FieldType.SELECT, options=["Proactive Hunting", "Reactive Analysis", "Manual Review", "None"]),
                    TemplateField(label="Security Metrics", type=FieldType.SELECT, options=["Comprehensive Metrics", "Basic KPIs", "Limited Metrics", "No Metrics"]),
                    TemplateField(label="Regular Security Reviews", type=FieldType.SELECT, options=["Monthly Reviews", "Quarterly Reviews", "Annual Reviews", "Ad Hoc"]),
                    TemplateField(label="Vulnerability Management", type=FieldType.SELECT, options=["Proactive Management", "Reactive Patching", "Basic Updates", "Delayed"]),
                    TemplateField(label="Change Management", type=FieldType.SELECT, options=["Formal Change Process", "Basic Process", "Informal", "Ad Hoc"]),
                    TemplateField(label="Security Training", type=FieldType.SELECT, options=["Regular Training", "Annual Training", "Basic Training", "None"]),
                ],
                order=6
            )
        ],
        report_structure=[
            ReportSection(
                title="DNS Security Assessment Executive Summary",
                content_template="Comprehensive overview of DNS infrastructure security posture, critical vulnerabilities, and business risk assessment.",
                order=1
            ),
            ReportSection(
                title="DNS Infrastructure & Architecture Security",
                content_template="Detailed assessment of DNS infrastructure design, deployment security, and architectural resilience.",
                order=2
            ),
            ReportSection(
                title="DNS Configuration Security Analysis",
                content_template="Comprehensive evaluation of DNS server configurations, access controls, and security hardening measures.",
                order=3
            ),
            ReportSection(
                title="DNSSEC Implementation & Cryptographic Security",
                content_template="Assessment of DNSSEC deployment, key management practices, and cryptographic security implementation.",
                order=4
            ),
            ReportSection(
                title="DNS Threat Protection & Resilience Evaluation",
                content_template="Analysis of DNS threat protection mechanisms, DDoS mitigation, and infrastructure resilience capabilities.",
                order=5
            ),
            ReportSection(
                title="DNS Performance & Availability Assessment",
                content_template="Evaluation of DNS performance optimization, availability metrics, and capacity management practices.",
                order=6
            ),
            ReportSection(
                title="DNS Security Monitoring & Response Capabilities",
                content_template="Assessment of DNS security monitoring, incident response procedures, and forensic analysis capabilities.",
                order=7
            ),
            ReportSection(
                title="DNS Security Enhancement Roadmap",
                content_template="Strategic recommendations for DNS security improvements including infrastructure hardening, threat protection enhancements, and operational improvements.",
                order=8
            )
        ]
    )
    
    zero_trust_template = Template(
        name="Zero Trust Architecture Assessment",
        description="Comprehensive Zero Trust security model implementation and maturity assessment following NIST SP 800-207 and industry best practices",
        category="Zero Trust",
        steps=[
            TemplateStep(
                name="Zero Trust Strategy & Architecture Assessment",
                description="Comprehensive evaluation of Zero Trust strategy, architecture design, and organizational readiness",
                instructions="Assess the organization's Zero Trust strategy, architecture design principles, and overall readiness for Zero Trust implementation.",
                fields=[
                    TemplateField(label="Zero Trust Maturity Level", type=FieldType.SELECT, options=["Advanced (Optimized)", "Mature (Managed)", "Developing (Defined)", "Initial (Ad Hoc)", "Traditional Perimeter"], required=True),
                    TemplateField(label="Zero Trust Strategy Status", type=FieldType.SELECT, options=["Comprehensive Strategy", "Basic Strategy", "Planning Phase", "No Formal Strategy"]),
                    TemplateField(label="Executive Sponsorship", type=FieldType.SELECT, options=["Strong C-Level Support", "IT Leadership Support", "Department Level", "Limited Support"]),
                    TemplateField(label="Architecture Framework", type=FieldType.SELECT, options=["NIST Zero Trust", "Forrester ZTX", "Gartner SASE", "Vendor-specific", "Custom Framework", "None"]),
                    TemplateField(label="Implementation Approach", type=FieldType.SELECT, options=["Holistic Transformation", "Phased Implementation", "Pilot Programs", "Ad Hoc Projects", "None"]),
                    TemplateField(label="Risk Assessment Integration", type=FieldType.SELECT, options=["Risk-Driven Design", "Periodic Assessment", "Basic Risk Analysis", "Not Integrated"]),
                    TemplateField(label="Business Alignment", type=FieldType.SELECT, options=["Business-Led Initiative", "IT-Led with Business Support", "IT-Only Initiative", "Compliance-Driven"]),
                    TemplateField(label="Cultural Readiness", type=FieldType.SELECT, options=["Change-Ready Culture", "Moderate Readiness", "Resistance Expected", "High Resistance"]),
                    TemplateField(label="Budget & Resources", type=FieldType.SELECT, options=["Adequate Funding", "Limited Budget", "Insufficient Resources", "No Dedicated Budget"]),
                    TemplateField(label="Timeline & Milestones", type=FieldType.SELECT, options=["Detailed Roadmap", "High-Level Plan", "Informal Timeline", "No Timeline"]),
                ],
                order=1
            ),
            TemplateStep(
                name="Identity & Access Management (IAM) Assessment",
                description="Comprehensive evaluation of identity and access management capabilities in Zero Trust context",
                instructions="Assess identity verification, authentication, authorization, and identity governance capabilities as core Zero Trust components.",
                fields=[
                    TemplateField(label="Identity Provider Architecture", type=FieldType.SELECT, options=["Cloud-Native IdP", "Hybrid Identity", "On-Premises IAM", "Federated Identity", "Legacy Systems"], required=True),
                    TemplateField(label="Multi-Factor Authentication (MFA)", type=FieldType.SELECT, options=["Adaptive/Risk-based MFA", "Universal MFA", "Selective MFA", "Basic 2FA", "Not Implemented"]),
                    TemplateField(label="Passwordless Authentication", type=FieldType.SELECT, options=["Fully Passwordless", "Hybrid Approach", "Pilot Program", "Traditional Passwords"]),
                    TemplateField(label="Privileged Access Management", type=FieldType.SELECT, options=["Comprehensive PAM", "Basic PAM", "Manual Processes", "No PAM"]),
                    TemplateField(label="Just-in-Time Access", type=FieldType.SELECT, options=["Automated JIT", "Manual JIT", "Time-based Access", "Persistent Access"]),
                    TemplateField(label="Identity Governance & Administration", type=FieldType.SELECT, options=["Automated IGA", "Workflow-based", "Manual Processes", "Limited Governance"]),
                    TemplateField(label="Single Sign-On (SSO)", type=FieldType.SELECT, options=["Comprehensive SSO", "Partial SSO", "Basic Integration", "Manual Authentication"]),
                    TemplateField(label="Conditional Access Policies", type=FieldType.SELECT, options=["Comprehensive Policies", "Basic Policies", "Limited Rules", "No Conditional Access"]),
                    TemplateField(label="Identity Risk Assessment", type=FieldType.SELECT, options=["Real-time Risk Scoring", "Periodic Assessment", "Basic Risk Factors", "No Risk Assessment"]),
                    TemplateField(label="Service Account Management", type=FieldType.SELECT, options=["Automated Management", "Managed Identities", "Manual Process", "Unmanaged"]),
                    TemplateField(label="Identity Federation", type=FieldType.SELECT, options=["Advanced Federation", "Basic Federation", "Limited Integration", "Isolated Systems"]),
                ],
                order=2
            ),
            TemplateStep(
                name="Device Security & Endpoint Protection Assessment",
                description="Device trust, endpoint security, and device management evaluation in Zero Trust context",
                instructions="Assess device security posture, endpoint protection capabilities, device trust verification, and mobile device management in Zero Trust architecture.",
                fields=[
                    TemplateField(label="Device Management Strategy", type=FieldType.SELECT, options=["Unified Endpoint Management", "Multiple MDM Solutions", "Basic Device Management", "Unmanaged Devices"]),
                    TemplateField(label="Device Trust Verification", type=FieldType.SELECT, options=["Continuous Device Assessment", "Periodic Verification", "Basic Device Checks", "No Verification"]),
                    TemplateField(label="Endpoint Detection & Response (EDR)", type=FieldType.SELECT, options=["Advanced EDR/XDR", "Standard EDR", "Basic Endpoint Protection", "Antivirus Only"]),
                    TemplateField(label="Device Compliance Policies", type=FieldType.SELECT, options=["Comprehensive Policies", "Basic Compliance", "Limited Policies", "No Policies"]),
                    TemplateField(label="Certificate-Based Authentication", type=FieldType.SELECT, options=["PKI-based Authentication", "Basic Certificates", "Some Certificate Use", "No Certificates"]),
                    TemplateField(label="Mobile Device Security", type=FieldType.SELECT, options=["Advanced Mobile Security", "Basic MDM", "Limited Mobile Management", "BYOD Unmanaged"]),
                    TemplateField(label="Device Encryption", type=FieldType.SELECT, options=["Full Device Encryption", "Partial Encryption", "Basic Protection", "No Encryption"]),
                    TemplateField(label="Application Control", type=FieldType.SELECT, options=["Application Allowlisting", "Basic App Control", "Some Restrictions", "No Control"]),
                    TemplateField(label="Patch Management", type=FieldType.SELECT, options=["Automated Patching", "Managed Updates", "Manual Patching", "Inconsistent"]),
                    TemplateField(label="Device Isolation Capabilities", type=FieldType.SELECT, options=["Automated Isolation", "Manual Isolation", "Basic Quarantine", "No Isolation"]),
                    TemplateField(label="Hardware Security Features", type=FieldType.SELECT, options=["TPM/Secure Boot", "Basic Hardware Security", "Limited Features", "No Hardware Security"]),
                ],
                order=3
            ),
            TemplateStep(
                name="Network Security & Microsegmentation Assessment",
                description="Network architecture, microsegmentation, and network access control evaluation",
                instructions="Assess network security architecture, microsegmentation implementation, software-defined perimeters, and network access control mechanisms.",
                fields=[
                    TemplateField(label="Network Architecture Model", type=FieldType.SELECT, options=["Zero Trust Network Access", "Software-Defined Perimeter", "Network Segmentation", "Traditional Perimeter", "Hybrid Approach"]),
                    TemplateField(label="Microsegmentation Implementation", type=FieldType.SELECT, options=["Application-Level Microsegmentation", "Workload Segmentation", "VLAN Segmentation", "Basic Segmentation", "No Segmentation"]),
                    TemplateField(label="Software-Defined Perimeter (SDP)", type=FieldType.SELECT, options=["Full SDP Implementation", "Partial SDP", "VPN Replacement", "Traditional VPN", "No Remote Access Security"]),
                    TemplateField(label="Network Access Control (NAC)", type=FieldType.SELECT, options=["Dynamic NAC", "Policy-based NAC", "Basic NAC", "Port Security Only", "No NAC"]),
                    TemplateField(label="East-West Traffic Inspection", type=FieldType.SELECT, options=["Comprehensive Inspection", "Partial Inspection", "Basic Monitoring", "No Inspection"]),
                    TemplateField(label="API Security & Protection", type=FieldType.SELECT, options=["API Gateway with Security", "Basic API Protection", "Limited API Security", "No API Security"]),
                    TemplateField(label="Cloud Network Security", type=FieldType.SELECT, options=["Cloud-Native Security", "Hybrid Protection", "Basic Cloud Security", "Limited Cloud Security"]),
                    TemplateField(label="Network Policy Enforcement", type=FieldType.SELECT, options=["Automated Policy Enforcement", "Manual Policy Management", "Basic Rules", "No Policy Enforcement"]),
                    TemplateField(label="VPN & Remote Access Security", type=FieldType.SELECT, options=["Zero Trust Remote Access", "Secure VPN with MFA", "Basic VPN", "Insecure Remote Access"]),
                    TemplateField(label="Network Monitoring & Analytics", type=FieldType.SELECT, options=["AI-based Network Analytics", "Advanced Monitoring", "Basic Network Monitoring", "Limited Visibility"]),
                    TemplateField(label="DNS Security Integration", type=FieldType.SELECT, options=["Secure DNS with Filtering", "Basic DNS Security", "Standard DNS", "No DNS Security"]),
                ],
                order=4
            ),
            TemplateStep(
                name="Data Security & Protection Assessment",
                description="Data classification, protection, encryption, and governance evaluation in Zero Trust model",
                instructions="Assess data security measures including classification, encryption, access controls, data loss prevention, and data governance within Zero Trust principles.",
                fields=[
                    TemplateField(label="Data Classification Program", type=FieldType.SELECT, options=["Automated Classification", "Policy-based Classification", "Manual Classification", "No Classification"]),
                    TemplateField(label="Data Encryption Strategy", type=FieldType.SELECT, options=["End-to-End Encryption", "Encryption at Rest & Transit", "Basic Encryption", "Limited Encryption"]),
                    TemplateField(label="Data Loss Prevention (DLP)", type=FieldType.SELECT, options=["Advanced DLP with ML", "Policy-based DLP", "Basic DLP", "No DLP"]),
                    TemplateField(label="Cloud Data Protection", type=FieldType.SELECT, options=["Cloud Access Security Broker", "Native Cloud Protection", "Basic Cloud Security", "Limited Cloud Protection"]),
                    TemplateField(label="Data Access Controls", type=FieldType.SELECT, options=["Attribute-based Access Control", "Role-based Access Control", "Basic Permissions", "Open Access"]),
                    TemplateField(label="Data Governance & Compliance", type=FieldType.SELECT, options=["Comprehensive Data Governance", "Basic Governance", "Compliance-focused", "Limited Governance"]),
                    TemplateField(label="Database Security", type=FieldType.SELECT, options=["Database Activity Monitoring", "Basic Database Security", "Default Security", "Minimal Protection"]),
                    TemplateField(label="File Integrity Monitoring", type=FieldType.SELECT, options=["Real-time FIM", "Scheduled FIM", "Basic File Monitoring", "No FIM"]),
                    TemplateField(label="Backup & Recovery Security", type=FieldType.SELECT, options=["Secure Immutable Backups", "Encrypted Backups", "Basic Backup Security", "Insecure Backups"]),
                    TemplateField(label="Data Masking & Tokenization", type=FieldType.SELECT, options=["Dynamic Data Masking", "Static Data Masking", "Basic Tokenization", "No Data Masking"]),
                    TemplateField(label="Privacy Engineering", type=FieldType.SELECT, options=["Privacy by Design", "Privacy Controls", "Basic Privacy", "Limited Privacy"]),
                ],
                order=5
            ),
            TemplateStep(
                name="Application Security & Workload Protection Assessment",
                description="Application security, workload protection, and cloud security posture evaluation",
                instructions="Assess application security measures, workload protection, container security, and cloud security posture within Zero Trust architecture.",
                fields=[
                    TemplateField(label="Application Security Architecture", type=FieldType.SELECT, options=["Zero Trust Application Security", "Defense in Depth", "Basic App Security", "Minimal Security"]),
                    TemplateField(label="Runtime Application Security", type=FieldType.SELECT, options=["RASP Implementation", "WAF Protection", "Basic Runtime Security", "No Runtime Protection"]),
                    TemplateField(label="Container & Kubernetes Security", type=FieldType.SELECT, options=["Comprehensive Container Security", "Basic Container Protection", "Limited Security", "Default Security"]),
                    TemplateField(label="Cloud Workload Protection", type=FieldType.SELECT, options=["CWPP Implementation", "Basic Workload Security", "Limited Protection", "No Workload Security"]),
                    TemplateField(label="Serverless Security", type=FieldType.SELECT, options=["Comprehensive Serverless Security", "Basic Function Security", "Limited Security", "No Serverless Security"]),
                    TemplateField(label="API Security Gateway", type=FieldType.SELECT, options=["Advanced API Security", "Basic API Gateway", "Limited API Protection", "No API Security"]),
                    TemplateField(label="Software Supply Chain Security", type=FieldType.SELECT, options=["SBOM & Dependency Scanning", "Basic SCA", "Limited Supply Chain Security", "No Supply Chain Security"]),
                    TemplateField(label="Cloud Security Posture Management", type=FieldType.SELECT, options=["CSPM Implementation", "Basic Cloud Security", "Manual Security Checks", "No CSPM"]),
                    TemplateField(label="Infrastructure as Code Security", type=FieldType.SELECT, options=["IaC Security Scanning", "Policy as Code", "Basic IaC Security", "No IaC Security"]),
                    TemplateField(label="Secrets Management", type=FieldType.SELECT, options=["Centralized Secrets Management", "Basic Secrets Storage", "Distributed Secrets", "Hardcoded Secrets"]),
                    TemplateField(label="Application Performance Monitoring", type=FieldType.SELECT, options=["Security-integrated APM", "Standard APM", "Basic Monitoring", "No APM"]),
                ],
                order=6
            ),
            TemplateStep(
                name="Continuous Monitoring & Analytics Assessment",
                description="Security monitoring, analytics, threat detection, and incident response evaluation",
                instructions="Assess continuous monitoring capabilities, security analytics, threat detection, incident response, and overall security operations within Zero Trust framework.",
                fields=[
                    TemplateField(label="Security Information & Event Management", type=FieldType.SELECT, options=["Next-Gen SIEM/SOAR", "Traditional SIEM", "Log Aggregation", "Basic Logging"]),
                    TemplateField(label="User & Entity Behavior Analytics", type=FieldType.SELECT, options=["Advanced UEBA with ML", "Basic UEBA", "Rule-based Analytics", "No Behavioral Analytics"]),
                    TemplateField(label="Extended Detection & Response (XDR)", type=FieldType.SELECT, options=["Full XDR Platform", "EDR + NDR", "Basic EDR", "Traditional Antivirus"]),
                    TemplateField(label="Threat Intelligence Integration", type=FieldType.SELECT, options=["Automated Threat Intel", "Manual Integration", "Basic Feeds", "No Threat Intelligence"]),
                    TemplateField(label="Security Orchestration & Automation", type=FieldType.SELECT, options=["SOAR with Playbooks", "Basic Automation", "Manual Processes", "No Automation"]),
                    TemplateField(label="Risk-based Security Monitoring", type=FieldType.SELECT, options=["Dynamic Risk Scoring", "Static Risk Assessment", "Basic Risk Monitoring", "No Risk-based Monitoring"]),
                    TemplateField(label="Incident Response Capabilities", type=FieldType.SELECT, options=["Automated IR with SOAR", "Structured IR Process", "Basic IR Procedures", "Ad Hoc Response"]),
                    TemplateField(label="Threat Hunting Program", type=FieldType.SELECT, options=["Proactive Threat Hunting", "Reactive Hunting", "Basic Investigation", "No Threat Hunting"]),
                    TemplateField(label="Security Metrics & KPIs", type=FieldType.SELECT, options=["Comprehensive Dashboards", "Basic Security Metrics", "Limited Reporting", "No Security Metrics"]),
                    TemplateField(label="Compliance Monitoring", type=FieldType.SELECT, options=["Automated Compliance", "Regular Audits", "Manual Compliance", "Limited Compliance"]),
                    TemplateField(label="Security Operations Center (SOC)", type=FieldType.SELECT, options=["24/7 SOC with Analysts", "Business Hours SOC", "Virtual SOC", "No Dedicated SOC"]),
                ],
                order=7
            )
        ],
        report_structure=[
            ReportSection(
                title="Zero Trust Assessment Executive Summary",
                content_template="Comprehensive overview of Zero Trust architecture maturity, implementation status, and strategic recommendations for security transformation.",
                order=1
            ),
            ReportSection(
                title="Zero Trust Strategy & Architecture Evaluation",
                content_template="Assessment of Zero Trust strategy, architecture design, organizational readiness, and implementation approach.",
                order=2
            ),
            ReportSection(
                title="Identity & Access Management Analysis",
                content_template="Comprehensive evaluation of identity verification, authentication, authorization, and identity governance capabilities.",
                order=3
            ),
            ReportSection(
                title="Device Security & Endpoint Protection Assessment",
                content_template="Analysis of device trust verification, endpoint security, device management, and mobile security capabilities.",
                order=4
            ),
            ReportSection(
                title="Network Security & Microsegmentation Evaluation",
                content_template="Assessment of network architecture, microsegmentation, software-defined perimeters, and network access control mechanisms.",
                order=5
            ),
            ReportSection(
                title="Data Security & Protection Analysis",
                content_template="Evaluation of data classification, encryption, access controls, data loss prevention, and data governance measures.",
                order=6
            ),
            ReportSection(
                title="Application Security & Workload Protection Assessment",
                content_template="Analysis of application security, workload protection, container security, and cloud security posture management.",
                order=7
            ),
            ReportSection(
                title="Continuous Monitoring & Analytics Evaluation",
                content_template="Assessment of security monitoring, analytics, threat detection, incident response, and security operations capabilities.",
                order=8
            ),
            ReportSection(
                title="Zero Trust Implementation Roadmap",
                content_template="Strategic roadmap for Zero Trust maturity advancement including prioritized recommendations, implementation phases, and success metrics.",
                order=9
            )
        ]
    )
    
    # Insert all 25+ comprehensive templates with unique IDs
    templates = [
        web_app_template, api_template, mobile_template, network_template, 
        cloud_template, social_engineering_template, wireless_template,
        physical_security_template, iot_security_template, malware_analysis_template,
        osint_template, forensics_template, compliance_template, red_team_template,
        code_review_template, database_security_template, threat_intel_template,
        incident_response_template, container_security_template, devsecops_template,
        blockchain_template, supply_chain_template, email_security_template,
        dns_security_template, zero_trust_template
    ]
    for template in templates:
        doc = prepare_for_mongo(template.model_dump())
        await db.templates.replace_one(
            {"name": template.name, "category": template.category}, 
            doc, 
            upsert=True
        )
    
    # Create a sample assessment
    sample_assessment = Assessment(
        template_id=web_app_template.id,
        template_name=web_app_template.name,
        name="Example Corp Web App Assessment",
        status=AssessmentStatus.IN_PROGRESS,
        current_step=1,
        data={
            "step_1": {
                "Target URL": "https://example.com",
                "Technologies Identified": "React, Node.js, MongoDB",
                "Subdomain Enumeration": "api.example.com, admin.example.com"
            }
        }
    )
    
    doc = prepare_for_mongo(sample_assessment.model_dump())
    await db.assessments.insert_one(doc)
    
    return {"message": "Sample data initialized successfully"}


# Include the router in the main app
app.include_router(api_router)

app.add_middleware(
    CORSMiddleware,
    allow_credentials=True,
    allow_origins=os.environ.get('CORS_ORIGINS', '*').split(','),
    allow_methods=["*"],
    allow_headers=["*"],
)

# Configure logging
logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s'
)
logger = logging.getLogger(__name__)

@app.on_event("shutdown")
async def shutdown_db_client():
    client.close()